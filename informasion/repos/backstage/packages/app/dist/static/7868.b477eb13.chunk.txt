"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7868],{23164:(hn,ni,Qe)=>{var z,Be=Qe(4293),ae=Qe(78920);z={value:!0},ni.A=void 0;var R=ae(Qe(14041)),J=Be(Qe(74044)),Ae=(0,J.default)(R.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");ni.A=Ae},29587:(hn,ni,Qe)=>{Qe.d(ni,{EI:()=>Me,KB:()=>oe,Lv:()=>Ut,SG:()=>Vi,Tg:()=>D,WD:()=>X,Xt:()=>Yt,Zt:()=>wi,_v:()=>Pt,cr:()=>si,f7:()=>ue,jU:()=>Ii,mv:()=>Ee,tp:()=>qt,y9:()=>Ze});var z=Qe(79066),Be=Qe(57195),ae=Qe(83173),R=Qe(49913),J=Qe(98104),Ae;const ze=new z.uY;function Qt(A){return Be.sj.define({combine:A?g=>g.concat(A):void 0})}const it=new z.uY;class $e{constructor(g,w,P=[],F=""){this.data=g,this.name=F,Be.$t.prototype.hasOwnProperty("tree")||Object.defineProperty(Be.$t.prototype,"tree",{get(){return Ee(this)}}),this.parser=w,this.extension=[Ct.of(this),Be.$t.languageData.of((V,j,ne)=>{let ie=we(V,j,ne),ge=ie.type.prop(ze);if(!ge)return[];let Te=V.facet(ge),St=ie.type.prop(it);if(St){let Si=ie.resolve(j-ie.from,ne);for(let vi of St)if(vi.test(Si,V)){let Ci=V.facet(vi.facet);return vi.type=="replace"?Ci:Ci.concat(Te)}}return Te})].concat(P)}isActiveAt(g,w,P=-1){return we(g,w,P).type.prop(ze)==this.data}findRegions(g){let w=g.facet(Ct);if(w?.data==this.data)return[{from:0,to:g.doc.length}];if(!w||!w.allowsNesting)return[];let P=[],F=(V,j)=>{if(V.prop(ze)==this.data){P.push({from:j,to:j+V.length});return}let ne=V.prop(z.uY.mounted);if(ne){if(ne.tree.prop(ze)==this.data){if(ne.overlay)for(let ie of ne.overlay)P.push({from:ie.from+j,to:ie.to+j});else P.push({from:j,to:j+V.length});return}else if(ne.overlay){let ie=P.length;if(F(ne.tree,ne.overlay[0].from+j),P.length>ie)return}}for(let ie=0;ie<V.children.length;ie++){let ge=V.children[ie];ge instanceof z.PH&&F(ge,V.positions[ie]+j)}};return F(Ee(g),0),P}get allowsNesting(){return!0}}$e.setState=Be.Pe.define();function we(A,g,w){let P=A.facet(Ct),F=Ee(A).topNode;if(!P||P.allowsNesting)for(let V=F;V;V=V.enter(g,w,z.Qj.ExcludeBuffers))V.type.isTop&&(F=V);return F}class Pe extends $e{constructor(g,w,P){super(g,w,[],P),this.parser=w}static define(g){let w=Qt(g.languageData);return new Pe(w,g.parser.configure({props:[ze.add(P=>P.isTop?w:void 0)]}),g.name)}configure(g,w){return new Pe(this.data,this.parser.configure(g),w||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ee(A){let g=A.field($e.state,!1);return g?g.tree:z.PH.empty}function Se(A,g,w=50){var P;let F=(P=A.field($e.state,!1))===null||P===void 0?void 0:P.context;if(!F)return null;let V=F.viewport;F.updateViewport({from:0,to:g});let j=F.isDone(g)||F.work(w,g)?F.tree:null;return F.updateViewport(V),j}function Ne(A,g=A.doc.length){var w;return((w=A.field($e.state,!1))===null||w===void 0?void 0:w.context.isDone(g))||!1}function qe(A,g=A.viewport.to,w=100){let P=Se(A.state,g,w);return P!=Ee(A.state)&&A.dispatch({}),!!P}function he(A){var g;return((g=A.plugin(wt))===null||g===void 0?void 0:g.isWorking())||!1}class je{constructor(g){this.doc=g,this.cursorPos=0,this.string="",this.cursor=g.iter()}get length(){return this.doc.length}syncTo(g){return this.string=this.cursor.next(g-this.cursorPos).value,this.cursorPos=g+this.string.length,this.cursorPos-this.string.length}chunk(g){return this.syncTo(g),this.string}get lineChunks(){return!0}read(g,w){let P=this.cursorPos-this.string.length;return g<P||w>=this.cursorPos?this.doc.sliceString(g,w):this.string.slice(g-P,w-P)}}let ut=null;class Ot{constructor(g,w,P=[],F,V,j,ne,ie){this.parser=g,this.state=w,this.fragments=P,this.tree=F,this.treeLen=V,this.viewport=j,this.skipped=ne,this.scheduleOn=ie,this.parse=null,this.tempSkipped=[]}static create(g,w,P){return new Ot(g,w,[],z.PH.empty,0,P,[],null)}startParse(){return this.parser.startParse(new je(this.state.doc),this.fragments)}work(g,w){return w!=null&&w>=this.state.doc.length&&(w=void 0),this.tree!=z.PH.empty&&this.isDone(w??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var P;if(typeof g=="number"){let F=Date.now()+g;g=()=>Date.now()>F}for(this.parse||(this.parse=this.startParse()),w!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>w)&&w<this.state.doc.length&&this.parse.stopAt(w);;){let F=this.parse.advance();if(F)if(this.fragments=this.withoutTempSkipped(z.rr.addTree(F,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(P=this.parse.stoppedAt)!==null&&P!==void 0?P:this.state.doc.length,this.tree=F,this.parse=null,this.treeLen<(w??this.state.doc.length))this.parse=this.startParse();else return!0;if(g())return!1}})}takeTree(){let g,w;this.parse&&(g=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>g)&&this.parse.stopAt(g),this.withContext(()=>{for(;!(w=this.parse.advance()););}),this.treeLen=g,this.tree=w,this.fragments=this.withoutTempSkipped(z.rr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(g){let w=ut;ut=this;try{return g()}finally{ut=w}}withoutTempSkipped(g){for(let w;w=this.tempSkipped.pop();)g=Rt(g,w.from,w.to);return g}changes(g,w){let{fragments:P,tree:F,treeLen:V,viewport:j,skipped:ne}=this;if(this.takeTree(),!g.empty){let ie=[];if(g.iterChangedRanges((ge,Te,St,Si)=>ie.push({fromA:ge,toA:Te,fromB:St,toB:Si})),P=z.rr.applyChanges(P,ie),F=z.PH.empty,V=0,j={from:g.mapPos(j.from,-1),to:g.mapPos(j.to,1)},this.skipped.length){ne=[];for(let ge of this.skipped){let Te=g.mapPos(ge.from,1),St=g.mapPos(ge.to,-1);Te<St&&ne.push({from:Te,to:St})}}}return new Ot(this.parser,w,P,F,V,j,ne,this.scheduleOn)}updateViewport(g){if(this.viewport.from==g.from&&this.viewport.to==g.to)return!1;this.viewport=g;let w=this.skipped.length;for(let P=0;P<this.skipped.length;P++){let{from:F,to:V}=this.skipped[P];F<g.to&&V>g.from&&(this.fragments=Rt(this.fragments,F,V),this.skipped.splice(P--,1))}return this.skipped.length>=w?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(g,w){this.skipped.push({from:g,to:w})}static getSkippingParser(g){return new class extends z.iX{createParse(w,P,F){let V=F[0].from,j=F[F.length-1].to;return{parsedPos:V,advance(){let ie=ut;if(ie){for(let ge of F)ie.tempSkipped.push(ge);g&&(ie.scheduleOn=ie.scheduleOn?Promise.all([ie.scheduleOn,g]):g)}return this.parsedPos=j,new z.PH(z.Z6.none,[],[],j-V)},stoppedAt:null,stopAt(){}}}}}isDone(g){g=Math.min(g,this.state.doc.length);let w=this.fragments;return this.treeLen>=g&&w.length&&w[0].from==0&&w[0].to>=g}static get(){return ut}}function Rt(A,g,w){return z.rr.applyChanges(A,[{fromA:g,toA:w,fromB:g,toB:w}])}class at{constructor(g){this.context=g,this.tree=g.tree}apply(g){if(!g.docChanged&&this.tree==this.context.tree)return this;let w=this.context.changes(g.changes,g.state),P=this.context.treeLen==g.startState.doc.length?void 0:Math.max(g.changes.mapPos(this.context.treeLen),w.viewport.to);return w.work(20,P)||w.takeTree(),new at(w)}static init(g){let w=Math.min(3e3,g.doc.length),P=Ot.create(g.facet(Ct).parser,g,{from:0,to:w});return P.work(20,w)||P.takeTree(),new at(P)}}$e.state=Be.sU.define({create:at.init,update(A,g){for(let w of g.effects)if(w.is($e.setState))return w.value;return g.startState.facet(Ct)!=g.state.facet(Ct)?at.init(g.state):A.apply(g)}});let jt=A=>{let g=setTimeout(()=>A(),500);return()=>clearTimeout(g)};typeof requestIdleCallback<"u"&&(jt=A=>{let g=-1,w=setTimeout(()=>{g=requestIdleCallback(A,{timeout:400})},100);return()=>g<0?clearTimeout(w):cancelIdleCallback(g)});const Kt=typeof navigator<"u"&&(!((Ae=navigator.scheduling)===null||Ae===void 0)&&Ae.isInputPending)?()=>navigator.scheduling.isInputPending():null,wt=ae.Z9.fromClass(class{constructor(g){this.view=g,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(g){let w=this.view.state.field($e.state).context;(w.updateViewport(g.view.viewport)||this.view.viewport.to>w.treeLen)&&this.scheduleWork(),(g.docChanged||g.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(w)}scheduleWork(){if(this.working)return;let{state:g}=this.view,w=g.field($e.state);(w.tree!=w.context.tree||!w.context.isDone(g.doc.length))&&(this.working=jt(this.work))}work(g){this.working=null;let w=Date.now();if(this.chunkEnd<w&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=w+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:P,viewport:{to:F}}=this.view,V=P.field($e.state);if(V.tree==V.context.tree&&V.context.isDone(F+1e5))return;let j=Date.now()+Math.min(this.chunkBudget,100,g&&!Kt?Math.max(25,g.timeRemaining()-5):1e9),ne=V.context.treeLen<F&&P.doc.length>F+1e3,ie=V.context.work(()=>Kt&&Kt()||Date.now()>j,F+(ne?0:1e5));this.chunkBudget-=Date.now()-w,(ie||this.chunkBudget<=0)&&(V.context.takeTree(),this.view.dispatch({effects:$e.setState.of(new at(V.context))})),this.chunkBudget>0&&!(ie&&!ne)&&this.scheduleWork(),this.checkAsyncSchedule(V.context)}checkAsyncSchedule(g){g.scheduleOn&&(this.workScheduled++,g.scheduleOn.then(()=>this.scheduleWork()).catch(w=>(0,ae.c_)(this.view.state,w)).then(()=>this.workScheduled--),g.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ct=Be.sj.define({combine(A){return A.length?A[0]:null},enables:A=>[$e.state,wt,ae.Lz.contentAttributes.compute([A],g=>{let w=g.facet(A);return w&&w.name?{"data-language":w.name}:{}})]});class $t{constructor(g,w=[]){this.language=g,this.support=w,this.extension=[g,w]}}class Tt{constructor(g,w,P,F,V,j=void 0){this.name=g,this.alias=w,this.extensions=P,this.filename=F,this.loadFunc=V,this.support=j,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(g=>this.support=g,g=>{throw this.loading=null,g}))}static of(g){let{load:w,support:P}=g;if(!w){if(!P)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");w=()=>Promise.resolve(P)}return new Tt(g.name,(g.alias||[]).concat(g.name).map(F=>F.toLowerCase()),g.extensions||[],g.filename,w,P)}static matchFilename(g,w){for(let F of g)if(F.filename&&F.filename.test(w))return F;let P=/\.([^.]+)$/.exec(w);if(P){for(let F of g)if(F.extensions.indexOf(P[1])>-1)return F}return null}static matchLanguageName(g,w,P=!0){w=w.toLowerCase();for(let F of g)if(F.alias.some(V=>V==w))return F;if(P)for(let F of g)for(let V of F.alias){let j=w.indexOf(V);if(j>-1&&(V.length>2||!/\w/.test(w[j-1])&&!/\w/.test(w[j+V.length])))return F}return null}}const di=Be.sj.define(),Yt=Be.sj.define({combine:A=>{if(!A.length)return"  ";let g=A[0];if(!g||/\S/.test(g)||Array.from(g).some(w=>w!=g[0]))throw new Error("Invalid indent unit: "+JSON.stringify(A[0]));return g}});function qt(A){let g=A.facet(Yt);return g.charCodeAt(0)==9?A.tabSize*g.length:g.length}function Me(A,g){let w="",P=A.tabSize,F=A.facet(Yt)[0];if(F=="	"){for(;g>=P;)w+="	",g-=P;F=" "}for(let V=0;V<g;V++)w+=F;return w}function Pt(A,g){A instanceof Be.$t&&(A=new oe(A));for(let P of A.state.facet(di)){let F=P(A,g);if(F!==void 0)return F}let w=Ee(A.state);return w.length>=g?Oe(A,w,g):null}function Ke(A,g,w){let P=Object.create(null),F=new oe(A,{overrideIndentation:j=>{var ne;return(ne=P[j])!==null&&ne!==void 0?ne:-1}}),V=[];for(let j=g;j<=w;){let ne=A.doc.lineAt(j);j=ne.to+1;let ie=Pt(F,ne.from);if(ie==null)continue;/\S/.test(ne.text)||(ie=0);let ge=/^\s*/.exec(ne.text)[0],Te=Me(A,ie);ge!=Te&&(P[ne.from]=ie,V.push({from:ne.from,to:ne.from+ge.length,insert:Te}))}return A.changes(V)}class oe{constructor(g,w={}){this.state=g,this.options=w,this.unit=qt(g)}lineAt(g,w=1){let P=this.state.doc.lineAt(g),{simulateBreak:F,simulateDoubleBreak:V}=this.options;return F!=null&&F>=P.from&&F<=P.to?V&&F==g?{text:"",from:g}:(w<0?F<g:F<=g)?{text:P.text.slice(F-P.from),from:F}:{text:P.text.slice(0,F-P.from),from:P.from}:P}textAfterPos(g,w=1){if(this.options.simulateDoubleBreak&&g==this.options.simulateBreak)return"";let{text:P,from:F}=this.lineAt(g,w);return P.slice(g-F,Math.min(P.length,g+100-F))}column(g,w=1){let{text:P,from:F}=this.lineAt(g,w),V=this.countColumn(P,g-F),j=this.options.overrideIndentation?this.options.overrideIndentation(F):-1;return j>-1&&(V+=j-this.countColumn(P,P.search(/\S|$/))),V}countColumn(g,w=g.length){return(0,Be.y$)(g,this.state.tabSize,w)}lineIndent(g,w=1){let{text:P,from:F}=this.lineAt(g,w),V=this.options.overrideIndentation;if(V){let j=V(F);if(j>-1)return j}return this.countColumn(P,P.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const pe=new z.uY;function Oe(A,g,w){let P=g.resolveStack(w),F=g.resolveInner(w,-1).resolve(w,0).enterUnfinishedNodesBefore(w);if(F!=P.node){let V=[];for(let j=F;j&&!(j.from<P.node.from||j.to>P.node.to||j.from==P.node.from&&j.type==P.node.type);j=j.parent)V.push(j);for(let j=V.length-1;j>=0;j--)P={node:V[j],next:P}}return fe(P,A,w)}function fe(A,g,w){for(let P=A;P;P=P.next){let F=dt(P.node);if(F)return F(Ve.create(g,w,P))}return 0}function Je(A){return A.pos==A.options.simulateBreak&&A.options.simulateDoubleBreak}function dt(A){let g=A.type.prop(pe);if(g)return g;let w=A.firstChild,P;if(w&&(P=w.type.prop(z.uY.closedBy))){let F=A.lastChild,V=F&&P.indexOf(F.name)>-1;return j=>gt(j,!0,1,void 0,V&&!Je(j)?F.from:void 0)}return A.parent==null?nt:null}function nt(){return 0}class Ve extends oe{constructor(g,w,P){super(g.state,g.options),this.base=g,this.pos=w,this.context=P}get node(){return this.context.node}static create(g,w,P){return new Ve(g,w,P)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(g){let w=this.state.doc.lineAt(g.from);for(;;){let P=g.resolve(w.from);for(;P.parent&&P.parent.from==P.from;)P=P.parent;if(Re(P,g))break;w=this.state.doc.lineAt(P.from)}return this.lineIndent(w.from)}continue(){return fe(this.context.next,this.base,this.pos)}}function Re(A,g){for(let w=g;w;w=w.parent)if(A==w)return!0;return!1}function Jt(A){let g=A.node,w=g.childAfter(g.from),P=g.lastChild;if(!w)return null;let F=A.options.simulateBreak,V=A.state.doc.lineAt(w.from),j=F==null||F<=V.from?V.to:Math.min(V.to,F);for(let ne=w.to;;){let ie=g.childAfter(ne);if(!ie||ie==P)return null;if(!ie.type.isSkipped){if(ie.from>=j)return null;let ge=/^ */.exec(V.text.slice(w.to-V.from))[0].length;return{from:w.from,to:w.to+ge}}ne=ie.to}}function et({closing:A,align:g=!0,units:w=1}){return P=>gt(P,g,w,A)}function gt(A,g,w,P,F){let V=A.textAfter,j=V.match(/^\s*/)[0].length,ne=P&&V.slice(j,j+P.length)==P||F==A.pos+j,ie=g?Jt(A):null;return ie?ne?A.column(ie.from):A.column(ie.to):A.baseIndent+(ne?0:A.unit*w)}const At=A=>A.baseIndent;function bi({except:A,units:g=1}={}){return w=>{let P=A&&A.test(w.textAfter);return w.baseIndent+(P?0:g*w.unit)}}const xi=200;function X(){return Be.$t.transactionFilter.of(A=>{if(!A.docChanged||!A.isUserEvent("input.type")&&!A.isUserEvent("input.complete"))return A;let g=A.startState.languageDataAt("indentOnInput",A.startState.selection.main.head);if(!g.length)return A;let w=A.newDoc,{head:P}=A.newSelection.main,F=w.lineAt(P);if(P>F.from+xi)return A;let V=w.sliceString(F.from,P);if(!g.some(ge=>ge.test(V)))return A;let{state:j}=A,ne=-1,ie=[];for(let{head:ge}of j.selection.ranges){let Te=j.doc.lineAt(ge);if(Te.from==ne)continue;ne=Te.from;let St=Pt(j,Te.from);if(St==null)continue;let Si=/^\s*/.exec(Te.text)[0],vi=Me(j,St);Si!=vi&&ie.push({from:Te.from,to:Te.from+Si.length,insert:vi})}return ie.length?[A,{changes:ie,sequential:!0}]:A})}const k=Be.sj.define(),O=new z.uY;function N(A){let g=A.firstChild,w=A.lastChild;return g&&g.to<w.from?{from:g.to,to:w.type.isError?A.to:w.from}:null}function L(A,g,w){let P=Ee(A);if(P.length<w)return null;let F=P.resolveStack(w,1),V=null;for(let j=F;j;j=j.next){let ne=j.node;if(ne.to<=w||ne.from>w)continue;if(V&&ne.from<g)break;let ie=ne.type.prop(O);if(ie&&(ne.to<P.length-50||P.length==A.doc.length||!$(ne))){let ge=ie(ne,A);ge&&ge.from<=w&&ge.from>=g&&ge.to>w&&(V=ge)}}return V}function $(A){let g=A.lastChild;return g&&g.to==A.to&&g.type.isError}function G(A,g,w){for(let P of A.facet(k)){let F=P(A,g,w);if(F)return F}return L(A,g,w)}function Q(A,g){let w=g.mapPos(A.from,1),P=g.mapPos(A.to,-1);return w>=P?void 0:{from:w,to:P}}const me=Be.Pe.define({map:Q}),be=Be.Pe.define({map:Q});function xe(A){let g=[];for(let{head:w}of A.state.selection.ranges)g.some(P=>P.from<=w&&P.to>=w)||g.push(A.lineBlockAt(w));return g}const Ie=Be.sU.define({create(){return ae.NZ.none},update(A,g){A=A.map(g.changes);for(let w of g.effects)if(w.is(me)&&!vt(A,w.value.from,w.value.to)){let{preparePlaceholder:P}=g.state.facet(lt),F=P?ae.NZ.replace({widget:new ft(P(g.state,w.value))}):Fe;A=A.update({add:[F.range(w.value.from,w.value.to)]})}else w.is(be)&&(A=A.update({filter:(P,F)=>w.value.from!=P||w.value.to!=F,filterFrom:w.value.from,filterTo:w.value.to}));if(g.selection){let w=!1,{head:P}=g.selection.main;A.between(P,P,(F,V)=>{F<P&&V>P&&(w=!0)}),w&&(A=A.update({filterFrom:P,filterTo:P,filter:(F,V)=>V<=P||F>=P}))}return A},provide:A=>ae.Lz.decorations.from(A),toJSON(A,g){let w=[];return A.between(0,g.doc.length,(P,F)=>{w.push(P,F)}),w},fromJSON(A){if(!Array.isArray(A)||A.length%2)throw new RangeError("Invalid JSON for fold state");let g=[];for(let w=0;w<A.length;){let P=A[w++],F=A[w++];if(typeof P!="number"||typeof F!="number")throw new RangeError("Invalid JSON for fold state");g.push(Fe.range(P,F))}return ae.NZ.set(g,!0)}});function _e(A){return A.field(Ie,!1)||RangeSet.empty}function ot(A,g,w){var P;let F=null;return(P=A.field(Ie,!1))===null||P===void 0||P.between(g,w,(V,j)=>{(!F||F.from>V)&&(F={from:V,to:j})}),F}function vt(A,g,w){let P=!1;return A.between(g,g,(F,V)=>{F==g&&V==w&&(P=!0)}),P}function It(A,g){return A.field(Ie,!1)?g:g.concat(Be.Pe.appendConfig.of(ct()))}const Wt=A=>{for(let g of xe(A)){let w=G(A.state,g.from,g.to);if(w)return A.dispatch({effects:It(A.state,[me.of(w),Lt(A,w)])}),!0}return!1},ei=A=>{if(!A.state.field(Ie,!1))return!1;let g=[];for(let w of xe(A)){let P=ot(A.state,w.from,w.to);P&&g.push(be.of(P),Lt(A,P,!1))}return g.length&&A.dispatch({effects:g}),g.length>0};function Lt(A,g,w=!0){let P=A.state.doc.lineAt(g.from).number,F=A.state.doc.lineAt(g.to).number;return ae.Lz.announce.of(`${A.state.phrase(w?"Folded lines":"Unfolded lines")} ${P} ${A.state.phrase("to")} ${F}.`)}const kt=A=>{let{state:g}=A,w=[];for(let P=0;P<g.doc.length;){let F=A.lineBlockAt(P),V=G(g,F.from,F.to);V&&w.push(me.of(V)),P=(V?A.lineBlockAt(V.to):F).to+1}return w.length&&A.dispatch({effects:It(A.state,w)}),!!w.length},ti=A=>{let g=A.state.field(Ie,!1);if(!g||!g.size)return!1;let w=[];return g.between(0,A.state.doc.length,(P,F)=>{w.push(be.of({from:P,to:F}))}),A.dispatch({effects:w}),!0};function st(A,g){for(let w=g;;){let P=G(A.state,w.from,w.to);if(P&&P.to>g.from)return P;if(!w.from)return null;w=A.lineBlockAt(w.from-1)}}const tt=A=>{let g=[];for(let w of xe(A)){let P=ot(A.state,w.from,w.to);if(P)g.push(be.of(P),Lt(A,P,!1));else{let F=st(A,w);F&&g.push(me.of(F),Lt(A,F))}}return g.length>0&&A.dispatch({effects:It(A.state,g)}),!!g.length},ue=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Wt},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:ei},{key:"Ctrl-Alt-[",run:kt},{key:"Ctrl-Alt-]",run:ti}],Ue={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},lt=Be.sj.define({combine(A){return(0,Be.QR)(A,Ue)}});function ct(A){let g=[Ie,Nt];return A&&g.push(lt.of(A)),g}function Xe(A,g){let{state:w}=A,P=w.facet(lt),F=j=>{let ne=A.lineBlockAt(A.posAtDOM(j.target)),ie=ot(A.state,ne.from,ne.to);ie&&A.dispatch({effects:be.of(ie)}),j.preventDefault()};if(P.placeholderDOM)return P.placeholderDOM(A,F,g);let V=document.createElement("span");return V.textContent=P.placeholderText,V.setAttribute("aria-label",w.phrase("folded code")),V.title=w.phrase("unfold"),V.className="cm-foldPlaceholder",V.onclick=F,V}const Fe=ae.NZ.replace({widget:new class extends ae.xO{toDOM(A){return Xe(A,null)}}});class ft extends ae.xO{constructor(g){super(),this.value=g}eq(g){return this.value==g.value}toDOM(g){return Xe(g,this.value)}}const Ge={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class pt extends ae.wJ{constructor(g,w){super(),this.config=g,this.open=w}eq(g){return this.config==g.config&&this.open==g.open}toDOM(g){if(this.config.markerDOM)return this.config.markerDOM(this.open);let w=document.createElement("span");return w.textContent=this.open?this.config.openText:this.config.closedText,w.title=g.state.phrase(this.open?"Fold line":"Unfold line"),w}}function Ut(A={}){let g={...Ge,...A},w=new pt(g,!0),P=new pt(g,!1),F=ae.Z9.fromClass(class{constructor(j){this.from=j.viewport.from,this.markers=this.buildMarkers(j)}update(j){(j.docChanged||j.viewportChanged||j.startState.facet(Ct)!=j.state.facet(Ct)||j.startState.field(Ie,!1)!=j.state.field(Ie,!1)||Ee(j.startState)!=Ee(j.state)||g.foldingChanged(j))&&(this.markers=this.buildMarkers(j.view))}buildMarkers(j){let ne=new Be.vB;for(let ie of j.viewportLineBlocks){let ge=ot(j.state,ie.from,ie.to)?P:G(j.state,ie.from,ie.to)?w:null;ge&&ne.add(ie.from,ie.from,ge)}return ne.finish()}}),{domEventHandlers:V}=g;return[F,(0,ae.cU)({class:"cm-foldGutter",markers(j){var ne;return((ne=j.plugin(F))===null||ne===void 0?void 0:ne.markers)||Be.om.empty},initialSpacer(){return new pt(g,!1)},domEventHandlers:{...V,click:(j,ne,ie)=>{if(V.click&&V.click(j,ne,ie))return!0;let ge=ot(j.state,ne.from,ne.to);if(ge)return j.dispatch({effects:be.of(ge)}),!0;let Te=G(j.state,ne.from,ne.to);return Te?(j.dispatch({effects:me.of(Te)}),!0):!1}}}),ct()]}const Nt=ae.Lz.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class si{constructor(g,w){this.specs=g;let P;function F(ne){let ie=J.G.newName();return(P||(P=Object.create(null)))["."+ie]=ne,ie}const V=typeof w.all=="string"?w.all:w.all?F(w.all):void 0,j=w.scope;this.scope=j instanceof $e?ne=>ne.prop(ze)==j.data:j?ne=>ne==j:void 0,this.style=(0,R.az)(g.map(ne=>({tag:ne.tag,class:ne.class||F(Object.assign({},ne,{tag:null}))})),{all:V}).style,this.module=P?new J.G(P):null,this.themeType=w.themeType}static define(g,w){return new si(g,w||{})}}const zt=Be.sj.define(),yt=Be.sj.define({combine(A){return A.length?[A[0]]:null}});function Bt(A){let g=A.facet(zt);return g.length?g:A.facet(yt)}function Ze(A,g){let w=[pi],P;return A instanceof si&&(A.module&&w.push(ae.Lz.styleModule.of(A.module)),P=A.themeType),g?.fallback?w.push(yt.of(A)):P?w.push(zt.computeN([ae.Lz.darkTheme],F=>F.facet(ae.Lz.darkTheme)==(P=="dark")?[A]:[])):w.push(zt.of(A)),w}function Vt(A,g,w){let P=Bt(A),F=null;if(P){for(let V of P)if(!V.scope||w&&V.scope(w)){let j=V.style(g);j&&(F=F?F+" "+j:j)}}return F}class ai{constructor(g){this.markCache=Object.create(null),this.tree=Ee(g.state),this.decorations=this.buildDeco(g,Bt(g.state)),this.decoratedTo=g.viewport.to}update(g){let w=Ee(g.state),P=Bt(g.state),F=P!=Bt(g.startState),{viewport:V}=g.view,j=g.changes.mapPos(this.decoratedTo,1);w.length<V.to&&!F&&w.type==this.tree.type&&j>=V.to?(this.decorations=this.decorations.map(g.changes),this.decoratedTo=j):(w!=this.tree||g.viewportChanged||F)&&(this.tree=w,this.decorations=this.buildDeco(g.view,P),this.decoratedTo=V.to)}buildDeco(g,w){if(!w||!this.tree.length)return ae.NZ.none;let P=new Be.vB;for(let{from:F,to:V}of g.visibleRanges)(0,R.DM)(this.tree,w,(j,ne,ie)=>{P.add(j,ne,this.markCache[ie]||(this.markCache[ie]=ae.NZ.mark({class:ie})))},F,V);return P.finish()}}const pi=Be.Nb.high(ae.Z9.fromClass(ai,{decorations:A=>A.decorations})),wi=si.define([{tag:R._A.meta,color:"#404740"},{tag:R._A.link,textDecoration:"underline"},{tag:R._A.heading,textDecoration:"underline",fontWeight:"bold"},{tag:R._A.emphasis,fontStyle:"italic"},{tag:R._A.strong,fontWeight:"bold"},{tag:R._A.strikethrough,textDecoration:"line-through"},{tag:R._A.keyword,color:"#708"},{tag:[R._A.atom,R._A.bool,R._A.url,R._A.contentSeparator,R._A.labelName],color:"#219"},{tag:[R._A.literal,R._A.inserted],color:"#164"},{tag:[R._A.string,R._A.deleted],color:"#a11"},{tag:[R._A.regexp,R._A.escape,R._A.special(R._A.string)],color:"#e40"},{tag:R._A.definition(R._A.variableName),color:"#00f"},{tag:R._A.local(R._A.variableName),color:"#30a"},{tag:[R._A.typeName,R._A.namespace],color:"#085"},{tag:R._A.className,color:"#167"},{tag:[R._A.special(R._A.variableName),R._A.macroName],color:"#256"},{tag:R._A.definition(R._A.propertyName),color:"#00c"},{tag:R._A.comment,color:"#940"},{tag:R._A.invalid,color:"#f00"}]),ii=ae.Lz.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Gt=1e4,Tn="()[]{}",ri=Be.sj.define({combine(A){return(0,Be.QR)(A,{afterCursor:!0,brackets:Tn,maxScanDistance:Gt,renderMatch:Ft})}}),cn=ae.NZ.mark({class:"cm-matchingBracket"}),bt=ae.NZ.mark({class:"cm-nonmatchingBracket"});function Ft(A){let g=[],w=A.matched?cn:bt;return g.push(w.range(A.start.from,A.start.to)),A.end&&g.push(w.range(A.end.from,A.end.to)),g}const Bi=[Be.sU.define({create(){return ae.NZ.none},update(A,g){if(!g.docChanged&&!g.selection)return A;let w=[],P=g.state.facet(ri);for(let F of g.state.selection.ranges){if(!F.empty)continue;let V=Ii(g.state,F.head,-1,P)||F.head>0&&Ii(g.state,F.head-1,1,P)||P.afterCursor&&(Ii(g.state,F.head,1,P)||F.head<g.state.doc.length&&Ii(g.state,F.head+1,-1,P));V&&(w=w.concat(P.renderMatch(V,g.state)))}return ae.NZ.set(w,!0)},provide:A=>ae.Lz.decorations.from(A)}),ii];function Vi(A={}){return[ri.of(A),Bi]}const Yi=new z.uY;function Ei(A,g,w){let P=A.prop(g<0?z.uY.openedBy:z.uY.closedBy);if(P)return P;if(A.name.length==1){let F=w.indexOf(A.name);if(F>-1&&F%2==(g<0?1:0))return[w[F+g]]}return null}function Ri(A){let g=A.type.prop(Yi);return g?g(A.node):A}function Ii(A,g,w,P={}){let F=P.maxScanDistance||Gt,V=P.brackets||Tn,j=Ee(A),ne=j.resolveInner(g,w);for(let ie=ne;ie;ie=ie.parent){let ge=Ei(ie.type,w,V);if(ge&&ie.from<ie.to){let Te=Ri(ie);if(Te&&(w>0?g>=Te.from&&g<Te.to:g>Te.from&&g<=Te.to))return _i(A,g,w,ie,Te,ge,V)}}return zn(A,g,w,j,ne.type,F,V)}function _i(A,g,w,P,F,V,j){let ne=P.parent,ie={from:F.from,to:F.to},ge=0,Te=ne?.cursor();if(Te&&(w<0?Te.childBefore(P.from):Te.childAfter(P.to)))do if(w<0?Te.to<=P.from:Te.from>=P.to){if(ge==0&&V.indexOf(Te.type.name)>-1&&Te.from<Te.to){let St=Ri(Te);return{start:ie,end:St?{from:St.from,to:St.to}:void 0,matched:!0}}else if(Ei(Te.type,w,j))ge++;else if(Ei(Te.type,-w,j)){if(ge==0){let St=Ri(Te);return{start:ie,end:St&&St.from<St.to?{from:St.from,to:St.to}:void 0,matched:!1}}ge--}}while(w<0?Te.prevSibling():Te.nextSibling());return{start:ie,matched:!1}}function zn(A,g,w,P,F,V,j){let ne=w<0?A.sliceDoc(g-1,g):A.sliceDoc(g,g+1),ie=j.indexOf(ne);if(ie<0||ie%2==0!=w>0)return null;let ge={from:w<0?g-1:g,to:w>0?g+1:g},Te=A.doc.iterRange(g,w>0?A.doc.length:0),St=0;for(let Si=0;!Te.next().done&&Si<=V;){let vi=Te.value;w<0&&(Si+=vi.length);let Ci=g+Si*w;for(let Hi=w>0?0:vi.length-1,ds=w>0?vi.length:-1;Hi!=ds;Hi+=w){let un=j.indexOf(vi[Hi]);if(!(un<0||P.resolveInner(Ci+Hi,1).type!=F))if(un%2==0==w>0)St++;else{if(St==1)return{start:ge,end:{from:Ci+Hi,to:Ci+Hi+1},matched:un>>1==ie>>1};St--}}w>0&&(Si+=vi.length)}return Te.done?{start:ge,matched:!1}:null}function B(A,g,w,P=0,F=0){g==null&&(g=A.search(/[^\s\u00a0]/),g==-1&&(g=A.length));let V=F;for(let j=P;j<g;j++)A.charCodeAt(j)==9?V+=w-V%w:V++;return V}class h{constructor(g,w,P,F){this.string=g,this.tabSize=w,this.indentUnit=P,this.overrideIndent=F,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(g){let w=this.string.charAt(this.pos),P;if(typeof g=="string"?P=w==g:P=w&&(g instanceof RegExp?g.test(w):g(w)),P)return++this.pos,w}eatWhile(g){let w=this.pos;for(;this.eat(g););return this.pos>w}eatSpace(){let g=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>g}skipToEnd(){this.pos=this.string.length}skipTo(g){let w=this.string.indexOf(g,this.pos);if(w>-1)return this.pos=w,!0}backUp(g){this.pos-=g}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=B(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var g;return(g=this.overrideIndent)!==null&&g!==void 0?g:B(this.string,null,this.tabSize)}match(g,w,P){if(typeof g=="string"){let F=j=>P?j.toLowerCase():j,V=this.string.substr(this.pos,g.length);return F(V)==F(g)?(w!==!1&&(this.pos+=g.length),!0):null}else{let F=this.string.slice(this.pos).match(g);return F&&F.index>0?null:(F&&w!==!1&&(this.pos+=F[0].length),F)}}current(){return this.string.slice(this.start,this.pos)}}function d(A){return{name:A.name||"",token:A.token,blankLine:A.blankLine||(()=>{}),startState:A.startState||(()=>!0),copyState:A.copyState||y,indent:A.indent||(()=>null),languageData:A.languageData||{},tokenTable:A.tokenTable||ce,mergeTokens:A.mergeTokens!==!1}}function y(A){if(typeof A!="object")return A;let g={};for(let w in A){let P=A[w];g[w]=P instanceof Array?P.slice():P}return g}const v=new WeakMap;class D extends $e{constructor(g){let w=Qt(g.languageData),P=d(g),F,V=new class extends z.iX{createParse(j,ne,ie){return new Z(F,j,ne,ie)}};super(w,V,[],g.name),this.topNode=Vn(w,this),F=this,this.streamParser=P,this.stateAfter=new z.uY({perNode:!0}),this.tokenTable=g.tokenTable?new Ji(P.tokenTable):Xi}static define(g){return new D(g)}getIndent(g){let w,{overrideIndentation:P}=g.options;P&&(w=v.get(g.state),w!=null&&w<g.pos-1e4&&(w=void 0));let F=T(this,g.node.tree,g.node.from,g.node.from,w??g.pos),V,j;if(F?(j=F.state,V=F.pos+1):(j=this.streamParser.startState(g.unit),V=g.node.from),g.pos-V>1e4)return null;for(;V<g.pos;){let ie=g.state.doc.lineAt(V),ge=Math.min(g.pos,ie.to);if(ie.length){let Te=P?P(ie.from):-1,St=new h(ie.text,g.state.tabSize,g.unit,Te<0?void 0:Te);for(;St.pos<ge-ie.from;)le(this.streamParser.token,St,j)}else this.streamParser.blankLine(j,g.unit);if(ge==g.pos)break;V=ie.to+1}let ne=g.lineAt(g.pos);return P&&w==null&&v.set(g.state,ne.from),this.streamParser.indent(j,/^\s*(.*)/.exec(ne.text)[1],g)}get allowsNesting(){return!1}}function T(A,g,w,P,F){let V=w>=P&&w+g.length<=F&&g.prop(A.stateAfter);if(V)return{state:A.streamParser.copyState(V),pos:w+g.length};for(let j=g.children.length-1;j>=0;j--){let ne=g.children[j],ie=w+g.positions[j],ge=ne instanceof z.PH&&ie<F&&T(A,ne,ie,P,F);if(ge)return ge}return null}function H(A,g,w,P,F){if(F&&w<=0&&P>=g.length)return g;!F&&w==0&&g.type==A.topNode&&(F=!0);for(let V=g.children.length-1;V>=0;V--){let j=g.positions[V],ne=g.children[V],ie;if(j<P&&ne instanceof z.PH){if(!(ie=H(A,ne,w-j,P-j,F)))break;return F?new z.PH(g.type,g.children.slice(0,V).concat(ie),g.positions.slice(0,V+1),j+ie.length):ie}}return null}function _(A,g,w,P,F){for(let V of g){let j=V.from+(V.openStart?25:0),ne=V.to-(V.openEnd?25:0),ie=j<=w&&ne>w&&T(A,V.tree,0-V.offset,w,ne),ge;if(ie&&ie.pos<=P&&(ge=H(A,V.tree,w+V.offset,ie.pos+V.offset,!1)))return{state:ie.state,tree:ge}}return{state:A.streamParser.startState(F?qt(F):4),tree:z.PH.empty}}class Z{constructor(g,w,P,F){this.lang=g,this.input=w,this.fragments=P,this.ranges=F,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=F[F.length-1].to;let V=Ot.get(),j=F[0].from,{state:ne,tree:ie}=_(g,P,j,this.to,V?.state);this.state=ne,this.parsedPos=this.chunkStart=j+ie.length;for(let ge=0;ge<ie.children.length;ge++)this.chunks.push(ie.children[ge]),this.chunkPos.push(ie.positions[ge]);V&&this.parsedPos<V.viewport.from-1e5&&F.some(ge=>ge.from<=V.viewport.from&&ge.to>=V.viewport.from)&&(this.state=this.lang.streamParser.startState(qt(V.state)),V.skipUntilInView(this.parsedPos,V.viewport.from),this.parsedPos=V.viewport.from),this.moveRangeIndex()}advance(){let g=Ot.get(),w=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),P=Math.min(w,this.chunkStart+2048);for(g&&(P=Math.min(P,g.viewport.to));this.parsedPos<P;)this.parseLine(g);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=w?this.finish():g&&this.parsedPos>=g.viewport.to?(g.skipUntilInView(this.parsedPos,w),this.finish()):null}stopAt(g){this.stoppedAt=g}lineAfter(g){let w=this.input.chunk(g);if(this.input.lineChunks)w==`
`&&(w="");else{let P=w.indexOf(`
`);P>-1&&(w=w.slice(0,P))}return g+w.length<=this.to?w:w.slice(0,this.to-g)}nextLine(){let g=this.parsedPos,w=this.lineAfter(g),P=g+w.length;for(let F=this.rangeIndex;;){let V=this.ranges[F].to;if(V>=P||(w=w.slice(0,V-(P-w.length)),F++,F==this.ranges.length))break;let j=this.ranges[F].from,ne=this.lineAfter(j);w+=ne,P=j+ne.length}return{line:w,end:P}}skipGapsTo(g,w,P){for(;;){let F=this.ranges[this.rangeIndex].to,V=g+w;if(P>0?F>V:F>=V)break;let j=this.ranges[++this.rangeIndex].from;w+=j-F}return w}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(g,w,P,F){let V=4;if(this.ranges.length>1){F=this.skipGapsTo(w,F,1),w+=F;let ne=this.chunk.length;F=this.skipGapsTo(P,F,-1),P+=F,V+=this.chunk.length-ne}let j=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&V==4&&j>=0&&this.chunk[j]==g&&this.chunk[j+2]==w?this.chunk[j+2]=P:this.chunk.push(g,w,P,V),F}parseLine(g){let{line:w,end:P}=this.nextLine(),F=0,{streamParser:V}=this.lang,j=new h(w,g?g.state.tabSize:4,g?qt(g.state):2);if(j.eol())V.blankLine(this.state,j.indentUnit);else for(;!j.eol();){let ne=le(V.token,j,this.state);if(ne&&(F=this.emitToken(this.lang.tokenTable.resolve(ne),this.parsedPos+j.start,this.parsedPos+j.pos,F)),j.start>1e4)break}this.parsedPos=P,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let g=z.PH.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:ve,topID:0,maxBufferLength:2048,reused:this.chunkReused});g=new z.PH(g.type,g.children,g.positions,g.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(g),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new z.PH(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function le(A,g,w){g.start=g.pos;for(let P=0;P<10;P++){let F=A(g,w);if(g.pos>g.start)return F}throw new Error("Stream parser failed to advance stream.")}const ce=Object.create(null),ye=[z.Z6.none],ve=new z.fI(ye),xt=[],Et=Object.create(null),mt=Object.create(null);for(let[A,g]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])mt[A]=Pn(ce,g);class Ji{constructor(g){this.extra=g,this.table=Object.assign(Object.create(null),mt)}resolve(g){return g?this.table[g]||(this.table[g]=Pn(this.extra,g)):0}}const Xi=new Ji(ce);function Xt(A,g){xt.indexOf(A)>-1||(xt.push(A),console.warn(g))}function Pn(A,g){let w=[];for(let ne of g.split(" ")){let ie=[];for(let ge of ne.split(".")){let Te=A[ge]||R._A[ge];Te?typeof Te=="function"?ie.length?ie=ie.map(Te):Xt(ge,`Modifier ${ge} used at start of tag`):ie.length?Xt(ge,`Tag ${ge} used as modifier`):ie=Array.isArray(Te)?Te:[Te]:Xt(ge,`Unknown highlighting tag ${ge}`)}for(let ge of ie)w.push(ge)}if(!w.length)return 0;let P=g.replace(/ /g,"_"),F=P+" "+w.map(ne=>ne.id),V=Et[F];if(V)return V.id;let j=Et[F]=z.Z6.define({id:ye.length,name:P,props:[(0,R.pn)({[P]:w})]});return ye.push(j),j.id}function Vn(A,g){let w=z.Z6.define({id:ye.length,name:"Document",props:[ze.add(()=>A),pe.add(()=>P=>g.getIndent(P))],top:!0});return ye.push(w),w}function Zi(A){return A.length<=4096&&/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/.test(A)}function ji(A){for(let g=A.iter();!g.next().done;)if(Zi(g.value))return!0;return!1}function _n(A){let g=!1;return A.iterChanges((w,P,F,V,j)=>{!g&&ji(j)&&(g=!0)}),g}const fn=Be.sj.define({combine:A=>A.some(g=>g)});function Hs(A={}){let g=[us];return A.alwaysIsolate&&g.push(fn.of(!0)),g}const us=ae.Z9.fromClass(class{constructor(A){this.always=A.state.facet(fn)||A.textDirection!=ae.OP.LTR||A.state.facet(ae.Lz.perLineTextDirection),this.hasRTL=!this.always&&ji(A.state.doc),this.tree=Ee(A.state),this.decorations=this.always||this.hasRTL?jn(A,this.tree,this.always):ae.NZ.none}update(A){let g=A.state.facet(fn)||A.view.textDirection!=ae.OP.LTR||A.state.facet(ae.Lz.perLineTextDirection);if(!g&&!this.hasRTL&&_n(A.changes)&&(this.hasRTL=!0),!g&&!this.hasRTL)return;let w=Ee(A.state);(g!=this.always||w!=this.tree||A.docChanged||A.viewportChanged)&&(this.tree=w,this.always=g,this.decorations=jn(A.view,w,g))}},{provide:A=>{function g(w){var P,F;return(F=(P=w.plugin(A))===null||P===void 0?void 0:P.decorations)!==null&&F!==void 0?F:ae.NZ.none}return[ae.Lz.outerDecorations.of(g),Be.Nb.lowest(ae.Lz.bidiIsolatedRanges.of(g))]}});function jn(A,g,w){let P=new Be.vB,F=A.visibleRanges;w||(F=Ni(F,A.state.doc));for(let{from:V,to:j}of F)g.iterate({enter:ne=>{let ie=ne.type.prop(z.uY.isolate);ie&&P.add(ne.from,ne.to,Fi[ie])},from:V,to:j});return P.finish()}function Ni(A,g){let w=g.iter(),P=0,F=[],V=null;for(let{from:j,to:ne}of A)if(!(V&&V.to>j&&(j=V.to,j>=ne)))for(P+w.value.length<j&&(w.next(j-(P+w.value.length)),P=j);;){let ie=P,ge=P+w.value.length;if(!w.lineBreak&&Zi(w.value)&&(V&&V.to>ie-10?V.to=Math.min(ne,ge):F.push(V={from:ie,to:Math.min(ne,ge)})),ge>=ne)break;P=ge,w.next()}return F}const Fi={rtl:ae.NZ.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:ae.OP.RTL}),ltr:ae.NZ.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:ae.OP.LTR}),auto:ae.NZ.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})}},37711:(hn,ni,Qe)=>{Qe.d(ni,{Ay:()=>Dn});var z=Qe(89575),Be=Qe(17502),ae=Qe(14041),R=Qe(57195),J=Qe(83173),Ae=Qe(29587),ze=Qe(79066);const Qt=r=>{let{state:n}=r,l=n.doc.lineAt(n.selection.main.from),c=he(r.state,l.from);return c.line?$e(r):c.block?qe(r):!1};function it(r,n){return({state:l,dispatch:c})=>{if(l.readOnly)return!1;let f=r(n,l);return f?(c(l.update(f)),!0):!1}}const $e=it(at,0),we=null,Pe=null,Ee=it(Rt,0),Se=null,Ne=null,qe=it((r,n)=>Rt(r,n,Ot(n)),0);function he(r,n){let l=r.languageDataAt("commentTokens",n,1);return l.length?l[0]:{}}const je=50;function ut(r,{open:n,close:l},c,f){let p=r.sliceDoc(c-je,c),x=r.sliceDoc(f,f+je),M=/\s*$/.exec(p)[0].length,E=/^\s*/.exec(x)[0].length,q=p.length-M;if(p.slice(q-n.length,q)==n&&x.slice(E,E+l.length)==l)return{open:{pos:c-M,margin:M&&1},close:{pos:f+E,margin:E&&1}};let K,te;f-c<=2*je?K=te=r.sliceDoc(c,f):(K=r.sliceDoc(c,c+je),te=r.sliceDoc(f-je,f));let de=/^\s*/.exec(K)[0].length,ke=/\s*$/.exec(te)[0].length,rt=te.length-ke-l.length;return K.slice(de,de+n.length)==n&&te.slice(rt,rt+l.length)==l?{open:{pos:c+de+n.length,margin:/\s/.test(K.charAt(de+n.length))?1:0},close:{pos:f-ke-l.length,margin:/\s/.test(te.charAt(rt-1))?1:0}}:null}function Ot(r){let n=[];for(let l of r.selection.ranges){let c=r.doc.lineAt(l.from),f=l.to<=c.to?c:r.doc.lineAt(l.to);f.from>c.from&&f.from==l.to&&(f=l.to==c.to+1?c:r.doc.lineAt(l.to-1));let p=n.length-1;p>=0&&n[p].to>c.from?n[p].to=f.to:n.push({from:c.from+/^\s*/.exec(c.text)[0].length,to:f.to})}return n}function Rt(r,n,l=n.selection.ranges){let c=l.map(p=>he(n,p.from).block);if(!c.every(p=>p))return null;let f=l.map((p,x)=>ut(n,c[x],p.from,p.to));if(r!=2&&!f.every(p=>p))return{changes:n.changes(l.map((p,x)=>f[x]?[]:[{from:p.from,insert:c[x].open+" "},{from:p.to,insert:" "+c[x].close}]))};if(r!=1&&f.some(p=>p)){let p=[];for(let x=0,M;x<f.length;x++)if(M=f[x]){let E=c[x],{open:q,close:K}=M;p.push({from:q.pos-E.open.length,to:q.pos+q.margin},{from:K.pos-K.margin,to:K.pos+E.close.length})}return{changes:p}}return null}function at(r,n,l=n.selection.ranges){let c=[],f=-1;for(let{from:p,to:x}of l){let M=c.length,E=1e9,q=he(n,p).line;if(q){for(let K=p;K<=x;){let te=n.doc.lineAt(K);if(te.from>f&&(p==x||x>te.from)){f=te.from;let de=/^\s*/.exec(te.text)[0].length,ke=de==te.length,rt=te.text.slice(de,de+q.length)==q?de:-1;de<te.text.length&&de<E&&(E=de),c.push({line:te,comment:rt,token:q,indent:de,empty:ke,single:!1})}K=te.to+1}if(E<1e9)for(let K=M;K<c.length;K++)c[K].indent<c[K].line.text.length&&(c[K].indent=E);c.length==M+1&&(c[M].single=!0)}}if(r!=2&&c.some(p=>p.comment<0&&(!p.empty||p.single))){let p=[];for(let{line:M,token:E,indent:q,empty:K,single:te}of c)(te||!K)&&p.push({from:M.from+q,insert:E+" "});let x=n.changes(p);return{changes:x,selection:n.selection.map(x,1)}}else if(r!=1&&c.some(p=>p.comment>=0)){let p=[];for(let{line:x,comment:M,token:E}of c)if(M>=0){let q=x.from+M,K=q+E.length;x.text[K-x.from]==" "&&K++,p.push({from:q,to:K})}return{changes:p}}return null}const jt=R.YH.define(),Kt=R.YH.define(),wt=R.sj.define(),Ct=R.sj.define({combine(r){return(0,R.QR)(r,{minDepth:100,newGroupDelay:500,joinToEvent:(n,l)=>l},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(n,l)=>(c,f)=>n(c,f)||l(c,f)})}}),$t=R.sU.define({create(){return X.empty},update(r,n){let l=n.state.facet(Ct),c=n.annotation(jt);if(c){let E=fe.fromTransaction(n,c.selection),q=c.side,K=q==0?r.undone:r.done;return E?K=Je(K,K.length,l.minDepth,E):K=et(K,n.startState.selection),new X(q==0?c.rest:K,q==0?K:c.rest)}let f=n.annotation(Kt);if((f=="full"||f=="before")&&(r=r.isolate()),n.annotation(R.ZX.addToHistory)===!1)return n.changes.empty?r:r.addMapping(n.changes.desc);let p=fe.fromTransaction(n),x=n.annotation(R.ZX.time),M=n.annotation(R.ZX.userEvent);return p?r=r.addChanges(p,x,M,l,n):n.selection&&(r=r.addSelection(n.startState.selection,x,M,l.newGroupDelay)),(f=="full"||f=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(n=>n.toJSON()),undone:r.undone.map(n=>n.toJSON())}},fromJSON(r){return new X(r.done.map(fe.fromJSON),r.undone.map(fe.fromJSON))}});function Tt(r={}){return[$t,Ct.of(r),J.Lz.domEventHandlers({beforeinput(n,l){let c=n.inputType=="historyUndo"?qt:n.inputType=="historyRedo"?Me:null;return c?(n.preventDefault(),c(l)):!1}})]}const di=null;function Yt(r,n){return function({state:l,dispatch:c}){if(!n&&l.readOnly)return!1;let f=l.field($t,!1);if(!f)return!1;let p=f.pop(r,l,n);return p?(c(p),!0):!1}}const qt=Yt(0,!1),Me=Yt(1,!1),Pt=Yt(0,!0),Ke=Yt(1,!0);function oe(r){return function(n){let l=n.field($t,!1);if(!l)return 0;let c=r==0?l.done:l.undone;return c.length-(c.length&&!c[0].changes?1:0)}}const pe=null,Oe=null;class fe{constructor(n,l,c,f,p){this.changes=n,this.effects=l,this.mapped=c,this.startSelection=f,this.selectionsAfter=p}setSelAfter(n){return new fe(this.changes,this.effects,this.mapped,this.startSelection,n)}toJSON(){var n,l,c;return{changes:(n=this.changes)===null||n===void 0?void 0:n.toJSON(),mapped:(l=this.mapped)===null||l===void 0?void 0:l.toJSON(),startSelection:(c=this.startSelection)===null||c===void 0?void 0:c.toJSON(),selectionsAfter:this.selectionsAfter.map(f=>f.toJSON())}}static fromJSON(n){return new fe(n.changes&&R.VR.fromJSON(n.changes),[],n.mapped&&R.Gu.fromJSON(n.mapped),n.startSelection&&R.OF.fromJSON(n.startSelection),n.selectionsAfter.map(R.OF.fromJSON))}static fromTransaction(n,l){let c=Re;for(let f of n.startState.facet(wt)){let p=f(n);p.length&&(c=c.concat(p))}return!c.length&&n.changes.empty?null:new fe(n.changes.invert(n.startState.doc),c,void 0,l||n.startState.selection,Re)}static selection(n){return new fe(void 0,Re,void 0,void 0,n)}}function Je(r,n,l,c){let f=n+1>l+20?n-l-1:0,p=r.slice(f,n);return p.push(c),p}function dt(r,n){let l=[],c=!1;return r.iterChangedRanges((f,p)=>l.push(f,p)),n.iterChangedRanges((f,p,x,M)=>{for(let E=0;E<l.length;){let q=l[E++],K=l[E++];M>=q&&x<=K&&(c=!0)}}),c}function nt(r,n){return r.ranges.length==n.ranges.length&&r.ranges.filter((l,c)=>l.empty!=n.ranges[c].empty).length===0}function Ve(r,n){return r.length?n.length?r.concat(n):r:n}const Re=[],Jt=200;function et(r,n){if(r.length){let l=r[r.length-1],c=l.selectionsAfter.slice(Math.max(0,l.selectionsAfter.length-Jt));return c.length&&c[c.length-1].eq(n)?r:(c.push(n),Je(r,r.length-1,1e9,l.setSelAfter(c)))}else return[fe.selection([n])]}function gt(r){let n=r[r.length-1],l=r.slice();return l[r.length-1]=n.setSelAfter(n.selectionsAfter.slice(0,n.selectionsAfter.length-1)),l}function At(r,n){if(!r.length)return r;let l=r.length,c=Re;for(;l;){let f=bi(r[l-1],n,c);if(f.changes&&!f.changes.empty||f.effects.length){let p=r.slice(0,l);return p[l-1]=f,p}else n=f.mapped,l--,c=f.selectionsAfter}return c.length?[fe.selection(c)]:Re}function bi(r,n,l){let c=Ve(r.selectionsAfter.length?r.selectionsAfter.map(M=>M.map(n)):Re,l);if(!r.changes)return fe.selection(c);let f=r.changes.map(n),p=n.mapDesc(r.changes,!0),x=r.mapped?r.mapped.composeDesc(p):p;return new fe(f,R.Pe.mapEffects(r.effects,n),x,r.startSelection.map(p),c)}const xi=/^(input\.type|delete)($|\.)/;class X{constructor(n,l,c=0,f=void 0){this.done=n,this.undone=l,this.prevTime=c,this.prevUserEvent=f}isolate(){return this.prevTime?new X(this.done,this.undone):this}addChanges(n,l,c,f,p){let x=this.done,M=x[x.length-1];return M&&M.changes&&!M.changes.empty&&n.changes&&(!c||xi.test(c))&&(!M.selectionsAfter.length&&l-this.prevTime<f.newGroupDelay&&f.joinToEvent(p,dt(M.changes,n.changes))||c=="input.type.compose")?x=Je(x,x.length-1,f.minDepth,new fe(n.changes.compose(M.changes),Ve(R.Pe.mapEffects(n.effects,M.changes),M.effects),M.mapped,M.startSelection,Re)):x=Je(x,x.length,f.minDepth,n),new X(x,Re,l,c)}addSelection(n,l,c,f){let p=this.done.length?this.done[this.done.length-1].selectionsAfter:Re;return p.length>0&&l-this.prevTime<f&&c==this.prevUserEvent&&c&&/^select($|\.)/.test(c)&&nt(p[p.length-1],n)?this:new X(et(this.done,n),this.undone,l,c)}addMapping(n){return new X(At(this.done,n),At(this.undone,n),this.prevTime,this.prevUserEvent)}pop(n,l,c){let f=n==0?this.done:this.undone;if(f.length==0)return null;let p=f[f.length-1],x=p.selectionsAfter[0]||l.selection;if(c&&p.selectionsAfter.length)return l.update({selection:p.selectionsAfter[p.selectionsAfter.length-1],annotations:jt.of({side:n,rest:gt(f),selection:x}),userEvent:n==0?"select.undo":"select.redo",scrollIntoView:!0});if(p.changes){let M=f.length==1?Re:f.slice(0,f.length-1);return p.mapped&&(M=At(M,p.mapped)),l.update({changes:p.changes,selection:p.startSelection,effects:p.effects,annotations:jt.of({side:n,rest:M,selection:x}),filter:!1,userEvent:n==0?"undo":"redo",scrollIntoView:!0})}else return null}}X.empty=new X(Re,Re);const k=[{key:"Mod-z",run:qt,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Me,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Me,preventDefault:!0},{key:"Mod-u",run:Pt,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Ke,preventDefault:!0}];function O(r,n){return R.OF.create(r.ranges.map(n),r.mainIndex)}function N(r,n){return r.update({selection:n,scrollIntoView:!0,userEvent:"select"})}function L({state:r,dispatch:n},l){let c=O(r.selection,l);return c.eq(r.selection,!0)?!1:(n(N(r,c)),!0)}function $(r,n){return R.OF.cursor(n?r.to:r.from)}function G(r,n){return L(r,l=>l.empty?r.moveByChar(l,n):$(l,n))}function Q(r){return r.textDirectionAt(r.state.selection.main.head)==J.OP.LTR}const me=r=>G(r,!Q(r)),be=r=>G(r,Q(r)),xe=r=>G(r,!0),Ie=r=>G(r,!1);function _e(r,n,l){let c=n.head,f=r.doc.lineAt(c);return c==(l?f.to:f.from)?c=l?Math.min(r.doc.length,f.to+1):Math.max(0,f.from-1):c=f.from+findClusterBreak(f.text,c-f.from,l),EditorSelection.cursor(c,l?-1:1)}function ot(r,n){return L(r,l=>l.empty?_e(r.state,l,n):$(l,n))}const vt=r=>ot(r,!0),It=r=>ot(r,!1);function Wt(r,n){return L(r,l=>l.empty?r.moveByGroup(l,n):$(l,n))}const ei=r=>Wt(r,!Q(r)),Lt=r=>Wt(r,Q(r)),kt=r=>Wt(r,!0),ti=r=>Wt(r,!1);function st(r,n,l){let c=r.state.charCategorizer(n),f=c(l),p=f!=CharCategory.Space;return x=>{let M=c(x);return M!=CharCategory.Space?p&&M==f:(p=!1,!0)}}const tt=r=>L(r,n=>n.empty?r.moveByChar(n,!0,l=>st(r,n.head,l)):$(n,!0)),ue=typeof Intl<"u"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function Ue(r,n,l){let c=r.state.charCategorizer(n.from),f=CharCategory.Space,p=n.from,x=0,M=!1,E=!1,q=!1,K=de=>{if(M)return!1;p+=l?de.length:-de.length;let ke=c(de),rt;if(ke==CharCategory.Word&&de.charCodeAt(0)<128&&/[\W_]/.test(de)&&(ke=-1),f==CharCategory.Space&&(f=ke),f!=ke)return!1;if(f==CharCategory.Word)if(de.toLowerCase()==de){if(!l&&E)return!1;q=!0}else if(q){if(l)return!1;M=!0}else{if(E&&l&&c(rt=r.state.sliceDoc(p,p+1))==CharCategory.Word&&rt.toLowerCase()==rt)return!1;E=!0}return x++,!0},te=r.moveByChar(n,l,de=>(K(de),K));if(ue&&f==CharCategory.Word&&te.from==n.from+x*(l?1:-1)){let de=Math.min(n.head,te.head),ke=Math.max(n.head,te.head),rt=r.state.sliceDoc(de,ke);if(rt.length>1&&/[\u4E00-\uffff]/.test(rt)){let Ye=Array.from(ue.segment(rt));if(Ye.length>1)return l?EditorSelection.cursor(n.head+Ye[1].index,-1):EditorSelection.cursor(te.head+Ye[Ye.length-1].index,1)}}return te}function lt(r,n){return L(r,l=>l.empty?Ue(r,l,n):$(l,n))}const ct=r=>lt(r,!0),Xe=r=>lt(r,!1);function Fe(r,n,l){if(n.type.prop(l))return!0;let c=n.to-n.from;return c&&(c>2||/[^\s,.;:]/.test(r.sliceDoc(n.from,n.to)))||n.firstChild}function ft(r,n,l){let c=(0,Ae.mv)(r).resolveInner(n.head),f=l?ze.uY.closedBy:ze.uY.openedBy;for(let E=n.head;;){let q=l?c.childAfter(E):c.childBefore(E);if(!q)break;Fe(r,q,f)?c=q:E=l?q.to:q.from}let p=c.type.prop(f),x,M;return p&&(x=l?(0,Ae.jU)(r,c.from,1):(0,Ae.jU)(r,c.to,-1))&&x.matched?M=l?x.end.to:x.end.from:M=l?c.to:c.from,R.OF.cursor(M,l?-1:1)}const Ge=r=>L(r,n=>ft(r.state,n,!Q(r))),pt=r=>L(r,n=>ft(r.state,n,Q(r)));function Ut(r,n){return L(r,l=>{if(!l.empty)return $(l,n);let c=r.moveVertically(l,n);return c.head!=l.head?c:r.moveToLineBoundary(l,n)})}const Nt=r=>Ut(r,!1),si=r=>Ut(r,!0);function zt(r){let n=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,l=0,c=0,f;if(n){for(let p of r.state.facet(J.Lz.scrollMargins)){let x=p(r);x?.top&&(l=Math.max(x?.top,l)),x?.bottom&&(c=Math.max(x?.bottom,c))}f=r.scrollDOM.clientHeight-l-c}else f=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:l,marginBottom:c,selfScroll:n,height:Math.max(r.defaultLineHeight,f-5)}}function yt(r,n){let l=zt(r),{state:c}=r,f=O(c.selection,x=>x.empty?r.moveVertically(x,n,l.height):$(x,n));if(f.eq(c.selection))return!1;let p;if(l.selfScroll){let x=r.coordsAtPos(c.selection.main.head),M=r.scrollDOM.getBoundingClientRect(),E=M.top+l.marginTop,q=M.bottom-l.marginBottom;x&&x.top>E&&x.bottom<q&&(p=J.Lz.scrollIntoView(f.main.head,{y:"start",yMargin:x.top-E}))}return r.dispatch(N(c,f),{effects:p}),!0}const Bt=r=>yt(r,!1),Ze=r=>yt(r,!0);function Vt(r,n,l){let c=r.lineBlockAt(n.head),f=r.moveToLineBoundary(n,l);if(f.head==n.head&&f.head!=(l?c.to:c.from)&&(f=r.moveToLineBoundary(n,l,!1)),!l&&f.head==c.from&&c.length){let p=/^\s*/.exec(r.state.sliceDoc(c.from,Math.min(c.from+100,c.to)))[0].length;p&&n.head!=c.from+p&&(f=R.OF.cursor(c.from+p))}return f}const ai=r=>L(r,n=>Vt(r,n,!0)),pi=r=>L(r,n=>Vt(r,n,!1)),wi=r=>L(r,n=>Vt(r,n,!Q(r))),ii=r=>L(r,n=>Vt(r,n,Q(r))),Gt=r=>L(r,n=>R.OF.cursor(r.lineBlockAt(n.head).from,1)),Tn=r=>L(r,n=>R.OF.cursor(r.lineBlockAt(n.head).to,-1));function ri(r,n,l){let c=!1,f=O(r.selection,p=>{let x=(0,Ae.jU)(r,p.head,-1)||(0,Ae.jU)(r,p.head,1)||p.head>0&&(0,Ae.jU)(r,p.head-1,1)||p.head<r.doc.length&&(0,Ae.jU)(r,p.head+1,-1);if(!x||!x.end)return p;c=!0;let M=x.start.from==p.head?x.end.to:x.end.from;return l?R.OF.range(p.anchor,M):R.OF.cursor(M)});return c?(n(N(r,f)),!0):!1}const cn=({state:r,dispatch:n})=>ri(r,n,!1),bt=({state:r,dispatch:n})=>ri(r,n,!0);function Ft(r,n){let l=O(r.state.selection,c=>{let f=n(c);return R.OF.range(c.anchor,f.head,f.goalColumn,f.bidiLevel||void 0)});return l.eq(r.state.selection)?!1:(r.dispatch(N(r.state,l)),!0)}function zi(r,n){return Ft(r,l=>r.moveByChar(l,n))}const Bi=r=>zi(r,!Q(r)),Vi=r=>zi(r,Q(r)),Yi=r=>zi(r,!0),Ei=r=>zi(r,!1),Ri=r=>Ft(r,n=>_e(r.state,n,!0)),Ii=r=>Ft(r,n=>_e(r.state,n,!1));function _i(r,n){return Ft(r,l=>r.moveByGroup(l,n))}const zn=r=>_i(r,!Q(r)),B=r=>_i(r,Q(r)),h=r=>_i(r,!0),d=r=>_i(r,!1),y=r=>Ft(r,n=>r.moveByChar(n,!0,l=>st(r,n.head,l)));function v(r,n){return Ft(r,l=>Ue(r,l,n))}const D=r=>v(r,!0),T=r=>v(r,!1),H=r=>Ft(r,n=>ft(r.state,n,!Q(r))),_=r=>Ft(r,n=>ft(r.state,n,Q(r)));function Z(r,n){return Ft(r,l=>r.moveVertically(l,n))}const le=r=>Z(r,!1),ce=r=>Z(r,!0);function ye(r,n){return Ft(r,l=>r.moveVertically(l,n,zt(r).height))}const ve=r=>ye(r,!1),xt=r=>ye(r,!0),Et=r=>Ft(r,n=>Vt(r,n,!0)),mt=r=>Ft(r,n=>Vt(r,n,!1)),Ji=r=>Ft(r,n=>Vt(r,n,!Q(r))),Xi=r=>Ft(r,n=>Vt(r,n,Q(r))),Xt=r=>Ft(r,n=>R.OF.cursor(r.lineBlockAt(n.head).from)),Pn=r=>Ft(r,n=>R.OF.cursor(r.lineBlockAt(n.head).to)),Vn=({state:r,dispatch:n})=>(n(N(r,{anchor:0})),!0),Zi=({state:r,dispatch:n})=>(n(N(r,{anchor:r.doc.length})),!0),ji=({state:r,dispatch:n})=>(n(N(r,{anchor:r.selection.main.anchor,head:0})),!0),_n=({state:r,dispatch:n})=>(n(N(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),fn=({state:r,dispatch:n})=>(n(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),Hs=({state:r,dispatch:n})=>{let l=Ci(r).map(({from:c,to:f})=>R.OF.range(c,Math.min(f+1,r.doc.length)));return n(r.update({selection:R.OF.create(l),userEvent:"select"})),!0},us=({state:r,dispatch:n})=>{let l=O(r.selection,c=>{let f=(0,Ae.mv)(r),p=f.resolveStack(c.from,1);if(c.empty){let x=f.resolveStack(c.from,-1);x.node.from>=p.node.from&&x.node.to<=p.node.to&&(p=x)}for(let x=p;x;x=x.next){let{node:M}=x;if((M.from<c.from&&M.to>=c.to||M.to>c.to&&M.from<=c.from)&&x.next)return R.OF.range(M.to,M.from)}return c});return l.eq(r.selection)?!1:(n(N(r,l)),!0)},jn=({state:r,dispatch:n})=>{let l=r.selection,c=null;return l.ranges.length>1?c=R.OF.create([l.main]):l.main.empty||(c=R.OF.create([R.OF.cursor(l.main.head)])),c?(n(N(r,c)),!0):!1};function Ni(r,n){if(r.state.readOnly)return!1;let l="delete.selection",{state:c}=r,f=c.changeByRange(p=>{let{from:x,to:M}=p;if(x==M){let E=n(p);E<x?(l="delete.backward",E=Fi(r,E,!1)):E>x&&(l="delete.forward",E=Fi(r,E,!0)),x=Math.min(x,E),M=Math.max(M,E)}else x=Fi(r,x,!1),M=Fi(r,M,!0);return x==M?{range:p}:{changes:{from:x,to:M},range:R.OF.cursor(x,x<p.head?-1:1)}});return f.changes.empty?!1:(r.dispatch(c.update(f,{scrollIntoView:!0,userEvent:l,effects:l=="delete.selection"?J.Lz.announce.of(c.phrase("Selection deleted")):void 0})),!0)}function Fi(r,n,l){if(r instanceof J.Lz)for(let c of r.state.facet(J.Lz.atomicRanges).map(f=>f(r)))c.between(n,n,(f,p)=>{f<n&&p>n&&(n=l?p:f)});return n}const A=(r,n,l)=>Ni(r,c=>{let f=c.from,{state:p}=r,x=p.doc.lineAt(f),M,E;if(l&&!n&&f>x.from&&f<x.from+200&&!/[^ \t]/.test(M=x.text.slice(0,f-x.from))){if(M[M.length-1]=="	")return f-1;let q=(0,R.y$)(M,p.tabSize),K=q%(0,Ae.tp)(p)||(0,Ae.tp)(p);for(let te=0;te<K&&M[M.length-1-te]==" ";te++)f--;E=f}else E=(0,R.zK)(x.text,f-x.from,n,n)+x.from,E==f&&x.number!=(n?p.doc.lines:1)?E+=n?1:-1:!n&&/[\ufe00-\ufe0f]/.test(x.text.slice(E-x.from,f-x.from))&&(E=(0,R.zK)(x.text,E-x.from,!1,!1)+x.from);return E}),g=r=>A(r,!1,!0),w=r=>A(r,!1,!1),P=r=>A(r,!0,!1),F=(r,n)=>Ni(r,l=>{let c=l.head,{state:f}=r,p=f.doc.lineAt(c),x=f.charCategorizer(c);for(let M=null;;){if(c==(n?p.to:p.from)){c==l.head&&p.number!=(n?f.doc.lines:1)&&(c+=n?1:-1);break}let E=(0,R.zK)(p.text,c-p.from,n)+p.from,q=p.text.slice(Math.min(c,E)-p.from,Math.max(c,E)-p.from),K=x(q);if(M!=null&&K!=M)break;(q!=" "||c!=l.head)&&(M=K),c=E}return c}),V=r=>F(r,!1),j=r=>F(r,!0),ne=r=>Ni(r,n=>{let l=r.lineBlockAt(n.head).to;return n.head<l?l:Math.min(r.state.doc.length,n.head+1)}),ie=r=>Ni(r,n=>{let l=r.lineBlockAt(n.head).from;return n.head>l?l:Math.max(0,n.head-1)}),ge=r=>Ni(r,n=>{let l=r.moveToLineBoundary(n,!1).head;return n.head>l?l:Math.max(0,n.head-1)}),Te=r=>Ni(r,n=>{let l=r.moveToLineBoundary(n,!0).head;return n.head<l?l:Math.min(r.state.doc.length,n.head+1)}),St=({state:r,dispatch:n})=>{if(r.readOnly)return!1;let l=[];for(let c=0,f="",p=r.doc.iter();;){if(p.next(),p.lineBreak||p.done){let x=f.search(/\s+$/);if(x>-1&&l.push({from:c-(f.length-x),to:c}),p.done)break;f=""}else f=p.value;c+=p.value.length}return l.length?(n(r.update({changes:l,userEvent:"delete"})),!0):!1},Si=({state:r,dispatch:n})=>{if(r.readOnly)return!1;let l=r.changeByRange(c=>({changes:{from:c.from,to:c.to,insert:R.EY.of(["",""])},range:R.OF.cursor(c.from)}));return n(r.update(l,{scrollIntoView:!0,userEvent:"input"})),!0},vi=({state:r,dispatch:n})=>{if(r.readOnly)return!1;let l=r.changeByRange(c=>{if(!c.empty||c.from==0||c.from==r.doc.length)return{range:c};let f=c.from,p=r.doc.lineAt(f),x=f==p.from?f-1:(0,R.zK)(p.text,f-p.from,!1)+p.from,M=f==p.to?f+1:(0,R.zK)(p.text,f-p.from,!0)+p.from;return{changes:{from:x,to:M,insert:r.doc.slice(f,M).append(r.doc.slice(x,f))},range:R.OF.cursor(M)}});return l.changes.empty?!1:(n(r.update(l,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Ci(r){let n=[],l=-1;for(let c of r.selection.ranges){let f=r.doc.lineAt(c.from),p=r.doc.lineAt(c.to);if(!c.empty&&c.to==p.from&&(p=r.doc.lineAt(c.to-1)),l>=f.number){let x=n[n.length-1];x.to=p.to,x.ranges.push(c)}else n.push({from:f.from,to:p.to,ranges:[c]});l=p.number+1}return n}function Hi(r,n,l){if(r.readOnly)return!1;let c=[],f=[];for(let p of Ci(r)){if(l?p.to==r.doc.length:p.from==0)continue;let x=r.doc.lineAt(l?p.to+1:p.from-1),M=x.length+1;if(l){c.push({from:p.to,to:x.to},{from:p.from,insert:x.text+r.lineBreak});for(let E of p.ranges)f.push(R.OF.range(Math.min(r.doc.length,E.anchor+M),Math.min(r.doc.length,E.head+M)))}else{c.push({from:x.from,to:p.from},{from:p.to,insert:r.lineBreak+x.text});for(let E of p.ranges)f.push(R.OF.range(E.anchor-M,E.head-M))}}return c.length?(n(r.update({changes:c,scrollIntoView:!0,selection:R.OF.create(f,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const ds=({state:r,dispatch:n})=>Hi(r,n,!1),un=({state:r,dispatch:n})=>Hi(r,n,!0);function Ws(r,n,l){if(r.readOnly)return!1;let c=[];for(let f of Ci(r))l?c.push({from:f.from,insert:r.doc.slice(f.from,f.to)+r.lineBreak}):c.push({from:f.to,insert:r.lineBreak+r.doc.slice(f.from,f.to)});return n(r.update({changes:c,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Cr=({state:r,dispatch:n})=>Ws(r,n,!1),Ar=({state:r,dispatch:n})=>Ws(r,n,!0),Io=r=>{if(r.state.readOnly)return!1;let{state:n}=r,l=n.changes(Ci(n).map(({from:f,to:p})=>(f>0?f--:p<n.doc.length&&p++,{from:f,to:p}))),c=O(n.selection,f=>{let p;if(r.lineWrapping){let x=r.lineBlockAt(f.head),M=r.coordsAtPos(f.head,f.assoc||1);M&&(p=x.bottom+r.documentTop-M.bottom+r.defaultLineHeight/2)}return r.moveVertically(f,!0,p)}).map(l);return r.dispatch({changes:l,selection:c,scrollIntoView:!0,userEvent:"delete.line"}),!0},Il=({state:r,dispatch:n})=>(n(r.update(r.replaceSelection(r.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0),Mr=({state:r,dispatch:n})=>(n(r.update(r.changeByRange(l=>{let c=/^\s*/.exec(r.doc.lineAt(l.from).text)[0];return{changes:{from:l.from,to:l.to,insert:r.lineBreak+c},range:EditorSelection.cursor(l.from+c.length+1)}}),{scrollIntoView:!0,userEvent:"input"})),!0);function No(r,n){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(n-1,n+1)))return{from:n,to:n};let l=(0,Ae.mv)(r).resolveInner(n),c=l.childBefore(n),f=l.childAfter(n),p;return c&&f&&c.to<=n&&f.from>=n&&(p=c.type.prop(ze.uY.closedBy))&&p.indexOf(f.name)>-1&&r.doc.lineAt(c.to).from==r.doc.lineAt(f.from).from&&!/\S/.test(r.sliceDoc(c.to,f.from))?{from:c.to,to:f.from}:null}const zs=Or(!1),Fo=Or(!0);function Or(r){return({state:n,dispatch:l})=>{if(n.readOnly)return!1;let c=n.changeByRange(f=>{let{from:p,to:x}=f,M=n.doc.lineAt(p),E=!r&&p==x&&No(n,p);r&&(p=x=(x<=M.to?M:n.doc.lineAt(x)).to);let q=new Ae.KB(n,{simulateBreak:p,simulateDoubleBreak:!!E}),K=(0,Ae._v)(q,p);for(K==null&&(K=(0,R.y$)(/^\s*/.exec(n.doc.lineAt(p).text)[0],n.tabSize));x<M.to&&/\s/.test(M.text[x-M.from]);)x++;E?{from:p,to:x}=E:p>M.from&&p<M.from+100&&!/\S/.test(M.text.slice(0,p))&&(p=M.from);let te=["",(0,Ae.EI)(n,K)];return E&&te.push((0,Ae.EI)(n,q.lineIndent(M.from,-1))),{changes:{from:p,to:x,insert:R.EY.of(te)},range:R.OF.cursor(p+1+te[1].length)}});return l(n.update(c,{scrollIntoView:!0,userEvent:"input"})),!0}}function Ln(r,n){let l=-1;return r.changeByRange(c=>{let f=[];for(let x=c.from;x<=c.to;){let M=r.doc.lineAt(x);M.number>l&&(c.empty||c.to>M.from)&&(n(M,f,c),l=M.number),x=M.to+1}let p=r.changes(f);return{changes:f,range:R.OF.range(p.mapPos(c.anchor,1),p.mapPos(c.head,1))}})}const Vs=({state:r,dispatch:n})=>{if(r.readOnly)return!1;let l=Object.create(null),c=new Ae.KB(r,{overrideIndentation:p=>{let x=l[p];return x??-1}}),f=Ln(r,(p,x,M)=>{let E=(0,Ae._v)(c,p.from);if(E==null)return;/\S/.test(p.text)||(E=0);let q=/^\s*/.exec(p.text)[0],K=(0,Ae.EI)(r,E);(q!=K||M.from<p.from+q.length)&&(l[p.from]=E,x.push({from:p.from,to:p.from+q.length,insert:K}))});return f.changes.empty||n(r.update(f,{userEvent:"indent"})),!0},dn=({state:r,dispatch:n})=>r.readOnly?!1:(n(r.update(Ln(r,(l,c)=>{c.push({from:l.from,insert:r.facet(Ae.Xt)})}),{userEvent:"input.indent"})),!0),Dr=({state:r,dispatch:n})=>r.readOnly?!1:(n(r.update(Ln(r,(l,c)=>{let f=/^\s*/.exec(l.text)[0];if(!f)return;let p=(0,R.y$)(f,r.tabSize),x=0,M=(0,Ae.EI)(r,Math.max(0,p-(0,Ae.tp)(r)));for(;x<f.length&&x<M.length&&f.charCodeAt(x)==M.charCodeAt(x);)x++;c.push({from:l.from+x,to:l.from+f.length,insert:M.slice(x)})}),{userEvent:"delete.dedent"})),!0),Ho=r=>(r.setTabFocusMode(),!0),Wo=r=>(r.setTabFocusMode(2e3),!0),Nl=({state:r,dispatch:n})=>r.selection.ranges.some(l=>!l.empty)?dn({state:r,dispatch:n}):(n(r.update(r.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),Tr=[{key:"Ctrl-b",run:me,shift:Bi,preventDefault:!0},{key:"Ctrl-f",run:be,shift:Vi},{key:"Ctrl-p",run:Nt,shift:le},{key:"Ctrl-n",run:si,shift:ce},{key:"Ctrl-a",run:Gt,shift:Xt},{key:"Ctrl-e",run:Tn,shift:Pn},{key:"Ctrl-d",run:P},{key:"Ctrl-h",run:g},{key:"Ctrl-k",run:ne},{key:"Ctrl-Alt-h",run:V},{key:"Ctrl-o",run:Si},{key:"Ctrl-t",run:vi},{key:"Ctrl-v",run:Ze}],_s=[{key:"ArrowLeft",run:me,shift:Bi,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:ei,shift:zn,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:wi,shift:Ji,preventDefault:!0},{key:"ArrowRight",run:be,shift:Vi,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Lt,shift:B,preventDefault:!0},{mac:"Cmd-ArrowRight",run:ii,shift:Xi,preventDefault:!0},{key:"ArrowUp",run:Nt,shift:le,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Vn,shift:ji},{mac:"Ctrl-ArrowUp",run:Bt,shift:ve},{key:"ArrowDown",run:si,shift:ce,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Zi,shift:_n},{mac:"Ctrl-ArrowDown",run:Ze,shift:xt},{key:"PageUp",run:Bt,shift:ve},{key:"PageDown",run:Ze,shift:xt},{key:"Home",run:pi,shift:mt,preventDefault:!0},{key:"Mod-Home",run:Vn,shift:ji},{key:"End",run:ai,shift:Et,preventDefault:!0},{key:"Mod-End",run:Zi,shift:_n},{key:"Enter",run:zs,shift:zs},{key:"Mod-a",run:fn},{key:"Backspace",run:g,shift:g},{key:"Delete",run:P},{key:"Mod-Backspace",mac:"Alt-Backspace",run:V},{key:"Mod-Delete",mac:"Alt-Delete",run:j},{mac:"Mod-Backspace",run:ge},{mac:"Mod-Delete",run:Te}].concat(Tr.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),zo=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Ge,shift:H},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:pt,shift:_},{key:"Alt-ArrowUp",run:ds},{key:"Shift-Alt-ArrowUp",run:Cr},{key:"Alt-ArrowDown",run:un},{key:"Shift-Alt-ArrowDown",run:Ar},{key:"Escape",run:jn},{key:"Mod-Enter",run:Fo},{key:"Alt-l",mac:"Ctrl-l",run:Hs},{key:"Mod-i",run:us,preventDefault:!0},{key:"Mod-[",run:Dr},{key:"Mod-]",run:dn},{key:"Mod-Alt-\\",run:Vs},{key:"Shift-Mod-k",run:Io},{key:"Shift-Mod-\\",run:cn},{key:"Mod-/",run:Qt},{key:"Alt-A",run:Ee},{key:"Ctrl-m",mac:"Shift-Alt-m",run:Ho}].concat(_s),Vo={key:"Tab",run:dn,shift:Dr};function Mt(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var n=1,l=arguments[1];if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){for(var c in l)if(Object.prototype.hasOwnProperty.call(l,c)){var f=l[c];typeof f=="string"?r.setAttribute(c,f):f!=null&&(r[c]=f)}n++}for(;n<arguments.length;n++)Pr(r,arguments[n]);return r}function Pr(r,n){if(typeof n=="string")r.appendChild(document.createTextNode(n));else if(n!=null)if(n.nodeType!=null)r.appendChild(n);else if(Array.isArray(n))for(var l=0;l<n.length;l++)Pr(r,n[l]);else throw new RangeError("Unsupported child node: "+n)}const Lr=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class pn{constructor(n,l,c=0,f=n.length,p,x){this.test=x,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=n.iterRange(c,f),this.bufferStart=c,this.normalize=p?M=>p(Lr(M)):Lr,this.query=this.normalize(l)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,R.vS)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let n=this.peek();if(n<0)return this.done=!0,this;let l=(0,R.MK)(n),c=this.bufferStart+this.bufferPos;this.bufferPos+=(0,R.Fh)(n);let f=this.normalize(l);if(f.length)for(let p=0,x=c;;p++){let M=f.charCodeAt(p),E=this.match(M,x,this.bufferPos+this.bufferStart);if(p==f.length-1){if(E)return this.value=E,this;break}x==c&&p<l.length&&l.charCodeAt(p)==M&&x++}}}match(n,l,c){let f=null;for(let p=0;p<this.matches.length;p+=2){let x=this.matches[p],M=!1;this.query.charCodeAt(x)==n&&(x==this.query.length-1?f={from:this.matches[p+1],to:c}:(this.matches[p]++,M=!0)),M||(this.matches.splice(p,2),p-=2)}return this.query.charCodeAt(0)==n&&(this.query.length==1?f={from:l,to:c}:this.matches.push(1,l)),f&&this.test&&!this.test(f.from,f.to,this.buffer,this.bufferStart)&&(f=null),f}}typeof Symbol<"u"&&(pn.prototype[Symbol.iterator]=function(){return this});const Br={from:-1,to:-1,match:/.*/.exec("")},ps="gm"+(/x/.unicode==null?"":"u");class Er{constructor(n,l,c,f=0,p=n.length){if(this.text=n,this.to=p,this.curLine="",this.done=!1,this.value=Br,/\\[sWDnr]|\n|\r|\[\^/.test(l))return new Kn(n,l,c,f,p);this.re=new RegExp(l,ps+(c?.ignoreCase?"i":"")),this.test=c?.test,this.iter=n.iter();let x=n.lineAt(f);this.curLineStart=x.from,this.matchPos=gs(n,f),this.getLine(this.curLineStart)}getLine(n){this.iter.next(n),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let n=this.matchPos-this.curLineStart;;){this.re.lastIndex=n;let l=this.matchPos<=this.to&&this.re.exec(this.curLine);if(l){let c=this.curLineStart+l.index,f=c+l[0].length;if(this.matchPos=gs(this.text,f+(c==f?1:0)),c==this.curLineStart+this.curLine.length&&this.nextLine(),(c<f||c>this.value.to)&&(!this.test||this.test(c,f,l)))return this.value={from:c,to:f,match:l},this;n=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),n=0;else return this.done=!0,this}}}const ms=new WeakMap;class Ki{constructor(n,l){this.from=n,this.text=l}get to(){return this.from+this.text.length}static get(n,l,c){let f=ms.get(n);if(!f||f.from>=c||f.to<=l){let M=new Ki(l,n.sliceString(l,c));return ms.set(n,M),M}if(f.from==l&&f.to==c)return f;let{text:p,from:x}=f;return x>l&&(p=n.sliceString(l,x)+p,x=l),f.to<c&&(p+=n.sliceString(f.to,c)),ms.set(n,new Ki(x,p)),new Ki(l,p.slice(l-x,c-x))}}class Kn{constructor(n,l,c,f,p){this.text=n,this.to=p,this.done=!1,this.value=Br,this.matchPos=gs(n,f),this.re=new RegExp(l,ps+(c?.ignoreCase?"i":"")),this.test=c?.test,this.flat=Ki.get(n,f,this.chunkEnd(f+5e3))}chunkEnd(n){return n>=this.to?this.to:this.text.lineAt(n).to}next(){for(;;){let n=this.re.lastIndex=this.matchPos-this.flat.from,l=this.re.exec(this.flat.text);if(l&&!l[0]&&l.index==n&&(this.re.lastIndex=n+1,l=this.re.exec(this.flat.text)),l){let c=this.flat.from+l.index,f=c+l[0].length;if((this.flat.to>=this.to||l.index+l[0].length<=this.flat.text.length-10)&&(!this.test||this.test(c,f,l)))return this.value={from:c,to:f,match:l},this.matchPos=gs(this.text,f+(c==f?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Ki.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(Er.prototype[Symbol.iterator]=Kn.prototype[Symbol.iterator]=function(){return this});function _o(r){try{return new RegExp(r,ps),!0}catch{return!1}}function gs(r,n){if(n>=r.length)return n;let l=r.lineAt(n),c;for(;n<l.to&&(c=l.text.charCodeAt(n-l.from))>=56320&&c<57344;)n++;return n}function js(r){let n=String(r.state.doc.lineAt(r.state.selection.main.head).number),l=Mt("input",{class:"cm-textfield",name:"line",value:n}),c=Mt("form",{class:"cm-gotoLine",onkeydown:p=>{p.keyCode==27?(p.preventDefault(),r.dispatch({effects:$n.of(!1)}),r.focus()):p.keyCode==13&&(p.preventDefault(),f())},onsubmit:p=>{p.preventDefault(),f()}},Mt("label",r.state.phrase("Go to line"),": ",l)," ",Mt("button",{class:"cm-button",type:"submit"},r.state.phrase("go")),Mt("button",{name:"close",onclick:()=>{r.dispatch({effects:$n.of(!1)}),r.focus()},"aria-label":r.state.phrase("close"),type:"button"},["\xD7"]));function f(){let p=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(l.value);if(!p)return;let{state:x}=r,M=x.doc.lineAt(x.selection.main.head),[,E,q,K,te]=p,de=K?+K.slice(1):0,ke=q?+q:M.number;if(q&&te){let ui=ke/100;E&&(ui=ui*(E=="-"?-1:1)+M.number/x.doc.lines),ke=Math.round(x.doc.lines*ui)}else q&&E&&(ke=ke*(E=="-"?-1:1)+M.number);let rt=x.doc.line(Math.max(1,Math.min(x.doc.lines,ke))),Ye=R.OF.cursor(rt.from+Math.max(0,Math.min(de,rt.length)));r.dispatch({effects:[$n.of(!1),J.Lz.scrollIntoView(Ye.from,{y:"center"})],selection:Ye}),r.focus()}return{dom:c}}const $n=R.Pe.define(),Rr=R.sU.define({create(){return!0},update(r,n){for(let l of n.effects)l.is($n)&&(r=l.value);return r},provide:r=>J.S7.from(r,n=>n?js:null)}),jo=r=>{let n=(0,J.ld)(r,js);if(!n){let l=[$n.of(!0)];r.state.field(Rr,!1)==null&&l.push(R.Pe.appendConfig.of([Rr,Pi])),r.dispatch({effects:l}),n=(0,J.ld)(r,js)}return n&&n.dom.querySelector("input").select(),!0},Pi=J.Lz.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),Oi={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Ks=R.sj.define({combine(r){return(0,R.QR)(r,Oi,{highlightWordAroundCursor:(n,l)=>n||l,minSelectionLength:Math.min,maxMatches:Math.min})}});function Ko(r){let n=[Fr,$o];return r&&n.push(Ks.of(r)),n}const ys=J.NZ.mark({class:"cm-selectionMatch"}),Ir=J.NZ.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function $s(r,n,l,c){return(l==0||r(n.sliceDoc(l-1,l))!=R.Je.Word)&&(c==n.doc.length||r(n.sliceDoc(c,c+1))!=R.Je.Word)}function Nr(r,n,l,c){return r(n.sliceDoc(l,l+1))==R.Je.Word&&r(n.sliceDoc(c-1,c))==R.Je.Word}const $o=J.Z9.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let n=r.state.facet(Ks),{state:l}=r,c=l.selection;if(c.ranges.length>1)return J.NZ.none;let f=c.main,p,x=null;if(f.empty){if(!n.highlightWordAroundCursor)return J.NZ.none;let E=l.wordAt(f.head);if(!E)return J.NZ.none;x=l.charCategorizer(f.head),p=l.sliceDoc(E.from,E.to)}else{let E=f.to-f.from;if(E<n.minSelectionLength||E>200)return J.NZ.none;if(n.wholeWords){if(p=l.sliceDoc(f.from,f.to),x=l.charCategorizer(f.head),!($s(x,l,f.from,f.to)&&Nr(x,l,f.from,f.to)))return J.NZ.none}else if(p=l.sliceDoc(f.from,f.to),!p)return J.NZ.none}let M=[];for(let E of r.visibleRanges){let q=new pn(l.doc,p,E.from,E.to);for(;!q.next().done;){let{from:K,to:te}=q.value;if((!x||$s(x,l,K,te))&&(f.empty&&K<=f.from&&te>=f.to?M.push(Ir.range(K,te)):(K>=f.to||te<=f.from)&&M.push(ys.range(K,te)),M.length>n.maxMatches))return J.NZ.none}}return J.NZ.set(M)}},{decorations:r=>r.decorations}),Fr=J.Lz.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),qo=({state:r,dispatch:n})=>{let{selection:l}=r,c=R.OF.create(l.ranges.map(f=>r.wordAt(f.head)||R.OF.cursor(f.head)),l.mainIndex);return c.eq(l)?!1:(n(r.update({selection:c})),!0)};function Hr(r,n){let{main:l,ranges:c}=r.selection,f=r.wordAt(l.head),p=f&&f.from==l.from&&f.to==l.to;for(let x=!1,M=new pn(r.doc,n,c[c.length-1].to);;)if(M.next(),M.done){if(x)return null;M=new pn(r.doc,n,0,Math.max(0,c[c.length-1].from-1)),x=!0}else{if(x&&c.some(E=>E.from==M.value.from))continue;if(p){let E=r.wordAt(M.value.from);if(!E||E.from!=M.value.from||E.to!=M.value.to)continue}return M.value}}const Wr=({state:r,dispatch:n})=>{let{ranges:l}=r.selection;if(l.some(p=>p.from===p.to))return qo({state:r,dispatch:n});let c=r.sliceDoc(l[0].from,l[0].to);if(r.selection.ranges.some(p=>r.sliceDoc(p.from,p.to)!=c))return!1;let f=Hr(r,c);return f?(n(r.update({selection:r.selection.addRange(R.OF.range(f.from,f.to),!1),effects:J.Lz.scrollIntoView(f.to)})),!0):!1},Qi=R.sj.define({combine(r){return(0,R.QR)(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:n=>new Us(n),scrollToMatch:n=>J.Lz.scrollIntoView(n)})}});function Uo(r){return r?[Qi.of(r),En]:En}class zr{constructor(n){this.search=n.search,this.caseSensitive=!!n.caseSensitive,this.literal=!!n.literal,this.regexp=!!n.regexp,this.replace=n.replace||"",this.valid=!!this.search&&(!this.regexp||_o(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!n.wholeWord}unquote(n){return this.literal?n:n.replace(/\\([nrt\\])/g,(l,c)=>c=="n"?`
`:c=="r"?"\r":c=="t"?"	":"\\")}eq(n){return this.search==n.search&&this.replace==n.replace&&this.caseSensitive==n.caseSensitive&&this.regexp==n.regexp&&this.wholeWord==n.wholeWord}create(){return this.regexp?new jr(this):new Yo(this)}getCursor(n,l=0,c){let f=n.doc?n:R.$t.create({doc:n});return c==null&&(c=f.doc.length),this.regexp?en(this,f,l,c):mn(this,f,l,c)}}class Vr{constructor(n){this.spec=n}}function mn(r,n,l,c){return new pn(n.doc,r.unquoted,l,c,r.caseSensitive?void 0:f=>f.toLowerCase(),r.wholeWord?Go(n.doc,n.charCategorizer(n.selection.main.head)):void 0)}function Go(r,n){return(l,c,f,p)=>((p>l||p+f.length<c)&&(p=Math.max(0,l-2),f=r.sliceString(p,Math.min(r.length,c+2))),(n(qn(f,l-p))!=R.Je.Word||n(Un(f,l-p))!=R.Je.Word)&&(n(Un(f,c-p))!=R.Je.Word||n(qn(f,c-p))!=R.Je.Word))}class Yo extends Vr{constructor(n){super(n)}nextMatch(n,l,c){let f=mn(this.spec,n,c,n.doc.length).nextOverlapping();if(f.done){let p=Math.min(n.doc.length,l+this.spec.unquoted.length);f=mn(this.spec,n,0,p).nextOverlapping()}return f.done||f.value.from==l&&f.value.to==c?null:f.value}prevMatchInRange(n,l,c){for(let f=c;;){let p=Math.max(l,f-1e4-this.spec.unquoted.length),x=mn(this.spec,n,p,f),M=null;for(;!x.nextOverlapping().done;)M=x.value;if(M)return M;if(p==l)return null;f-=1e4}}prevMatch(n,l,c){let f=this.prevMatchInRange(n,0,l);return f||(f=this.prevMatchInRange(n,Math.max(0,c-this.spec.unquoted.length),n.doc.length)),f&&(f.from!=l||f.to!=c)?f:null}getReplacement(n){return this.spec.unquote(this.spec.replace)}matchAll(n,l){let c=mn(this.spec,n,0,n.doc.length),f=[];for(;!c.next().done;){if(f.length>=l)return null;f.push(c.value)}return f}highlight(n,l,c,f){let p=mn(this.spec,n,Math.max(0,l-this.spec.unquoted.length),Math.min(c+this.spec.unquoted.length,n.doc.length));for(;!p.next().done;)f(p.value.from,p.value.to)}}function en(r,n,l,c){return new Er(n.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?_r(n.charCategorizer(n.selection.main.head)):void 0},l,c)}function qn(r,n){return r.slice((0,R.zK)(r,n,!1),n)}function Un(r,n){return r.slice(n,(0,R.zK)(r,n))}function _r(r){return(n,l,c)=>!c[0].length||(r(qn(c.input,c.index))!=R.Je.Word||r(Un(c.input,c.index))!=R.Je.Word)&&(r(Un(c.input,c.index+c[0].length))!=R.Je.Word||r(qn(c.input,c.index+c[0].length))!=R.Je.Word)}class jr extends Vr{nextMatch(n,l,c){let f=en(this.spec,n,c,n.doc.length).next();return f.done&&(f=en(this.spec,n,0,l).next()),f.done?null:f.value}prevMatchInRange(n,l,c){for(let f=1;;f++){let p=Math.max(l,c-f*1e4),x=en(this.spec,n,p,c),M=null;for(;!x.next().done;)M=x.value;if(M&&(p==l||M.from>p+10))return M;if(p==l)return null}}prevMatch(n,l,c){return this.prevMatchInRange(n,0,l)||this.prevMatchInRange(n,c,n.doc.length)}getReplacement(n){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(l,c)=>{if(c=="&")return n.match[0];if(c=="$")return"$";for(let f=c.length;f>0;f--){let p=+c.slice(0,f);if(p>0&&p<n.match.length)return n.match[p]+c.slice(f)}return l})}matchAll(n,l){let c=en(this.spec,n,0,n.doc.length),f=[];for(;!c.next().done;){if(f.length>=l)return null;f.push(c.value)}return f}highlight(n,l,c,f){let p=en(this.spec,n,Math.max(0,l-250),Math.min(c+250,n.doc.length));for(;!p.next().done;)f(p.value.from,p.value.to)}}const Gn=R.Pe.define(),bs=R.Pe.define(),mi=R.sU.define({create(r){return new xs(Bn(r).create(),null)},update(r,n){for(let l of n.effects)l.is(Gn)?r=new xs(l.value.create(),r.panel):l.is(bs)&&(r=new xs(r.query,l.value?qs:null));return r},provide:r=>J.S7.from(r,n=>n.panel)});function Kr(r){let n=r.field(mi,!1);return n?n.query.spec:Bn(r)}function Jo(r){var n;return((n=r.field(mi,!1))===null||n===void 0?void 0:n.panel)!=null}class xs{constructor(n,l){this.query=n,this.panel=l}}const Wi=J.NZ.mark({class:"cm-searchMatch"}),Dt=J.NZ.mark({class:"cm-searchMatch cm-searchMatch-selected"}),ws=J.Z9.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(mi))}update(r){let n=r.state.field(mi);(n!=r.startState.field(mi)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(n))}highlight({query:r,panel:n}){if(!n||!r.spec.valid)return J.NZ.none;let{view:l}=this,c=new R.vB;for(let f=0,p=l.visibleRanges,x=p.length;f<x;f++){let{from:M,to:E}=p[f];for(;f<x-1&&E>p[f+1].from-2*250;)E=p[++f].to;r.highlight(l.state,M,E,(q,K)=>{let te=l.state.selection.ranges.some(de=>de.from==q&&de.to==K);c.add(q,K,te?Dt:Wi)})}return c.finish()}},{decorations:r=>r.decorations});function Zt(r){return n=>{let l=n.state.field(mi,!1);return l&&l.query.spec.valid?r(n,l):Yr(n)}}const gn=Zt((r,{query:n})=>{let{to:l}=r.state.selection.main,c=n.nextMatch(r.state,l,l);if(!c)return!1;let f=R.OF.single(c.from,c.to),p=r.state.facet(Qi);return r.dispatch({selection:f,effects:[Gs(r,c),p.scrollToMatch(f.main,r)],userEvent:"select.search"}),Gr(r),!0}),Yn=Zt((r,{query:n})=>{let{state:l}=r,{from:c}=l.selection.main,f=n.prevMatch(l,c,c);if(!f)return!1;let p=R.OF.single(f.from,f.to),x=r.state.facet(Qi);return r.dispatch({selection:p,effects:[Gs(r,f),x.scrollToMatch(p.main,r)],userEvent:"select.search"}),Gr(r),!0}),Ai=Zt((r,{query:n})=>{let l=n.matchAll(r.state,1e3);return!l||!l.length?!1:(r.dispatch({selection:R.OF.create(l.map(c=>R.OF.range(c.from,c.to))),userEvent:"select.search.matches"}),!0)}),hi=({state:r,dispatch:n})=>{let l=r.selection;if(l.ranges.length>1||l.main.empty)return!1;let{from:c,to:f}=l.main,p=[],x=0;for(let M=new pn(r.doc,r.sliceDoc(c,f));!M.next().done;){if(p.length>1e3)return!1;M.value.from==c&&(x=p.length),p.push(R.OF.range(M.value.from,M.value.to))}return n(r.update({selection:R.OF.create(p,x),userEvent:"select.search.matches"})),!0},$r=Zt((r,{query:n})=>{let{state:l}=r,{from:c,to:f}=l.selection.main;if(l.readOnly)return!1;let p=n.nextMatch(l,c,c);if(!p)return!1;let x=p,M=[],E,q,K=[];x.from==c&&x.to==f&&(q=l.toText(n.getReplacement(x)),M.push({from:x.from,to:x.to,insert:q}),x=n.nextMatch(l,x.from,x.to),K.push(J.Lz.announce.of(l.phrase("replaced match on line $",l.doc.lineAt(c).number)+".")));let te=r.state.changes(M);return x&&(E=R.OF.single(x.from,x.to).map(te),K.push(Gs(r,x)),K.push(l.facet(Qi).scrollToMatch(E.main,r))),r.dispatch({changes:te,selection:E,effects:K,userEvent:"input.replace"}),!0}),qr=Zt((r,{query:n})=>{if(r.state.readOnly)return!1;let l=n.matchAll(r.state,1e9).map(f=>{let{from:p,to:x}=f;return{from:p,to:x,insert:n.getReplacement(f)}});if(!l.length)return!1;let c=r.state.phrase("replaced $ matches",l.length)+".";return r.dispatch({changes:l,effects:J.Lz.announce.of(c),userEvent:"input.replace.all"}),!0});function qs(r){return r.state.facet(Qi).createPanel(r)}function Bn(r,n){var l,c,f,p,x;let M=r.selection.main,E=M.empty||M.to>M.from+100?"":r.sliceDoc(M.from,M.to);if(n&&!E)return n;let q=r.facet(Qi);return new zr({search:((l=n?.literal)!==null&&l!==void 0?l:q.literal)?E:E.replace(/\n/g,"\\n"),caseSensitive:(c=n?.caseSensitive)!==null&&c!==void 0?c:q.caseSensitive,literal:(f=n?.literal)!==null&&f!==void 0?f:q.literal,regexp:(p=n?.regexp)!==null&&p!==void 0?p:q.regexp,wholeWord:(x=n?.wholeWord)!==null&&x!==void 0?x:q.wholeWord})}function Ur(r){let n=(0,J.ld)(r,qs);return n&&n.dom.querySelector("[main-field]")}function Gr(r){let n=Ur(r);n&&n==r.root.activeElement&&n.select()}const Yr=r=>{let n=r.state.field(mi,!1);if(n&&n.panel){let l=Ur(r);if(l&&l!=r.root.activeElement){let c=Bn(r.state,n.query.spec);c.valid&&r.dispatch({effects:Gn.of(c)}),l.focus(),l.select()}}else r.dispatch({effects:[bs.of(!0),n?Gn.of(Bn(r.state,n.query.spec)):R.Pe.appendConfig.of(En)]});return!0},Jr=r=>{let n=r.state.field(mi,!1);if(!n||!n.panel)return!1;let l=(0,J.ld)(r,qs);return l&&l.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:bs.of(!1)}),!0},Xo=[{key:"Mod-f",run:Yr,scope:"editor search-panel"},{key:"F3",run:gn,shift:Yn,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:gn,shift:Yn,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Jr,scope:"editor search-panel"},{key:"Mod-Shift-l",run:hi},{key:"Mod-Alt-g",run:jo},{key:"Mod-d",run:Wr,preventDefault:!0}];class Us{constructor(n){this.view=n;let l=this.query=n.state.field(mi).query.spec;this.commit=this.commit.bind(this),this.searchField=Mt("input",{value:l.search,placeholder:Mi(n,"Find"),"aria-label":Mi(n,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Mt("input",{value:l.replace,placeholder:Mi(n,"Replace"),"aria-label":Mi(n,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Mt("input",{type:"checkbox",name:"case",form:"",checked:l.caseSensitive,onchange:this.commit}),this.reField=Mt("input",{type:"checkbox",name:"re",form:"",checked:l.regexp,onchange:this.commit}),this.wordField=Mt("input",{type:"checkbox",name:"word",form:"",checked:l.wholeWord,onchange:this.commit});function c(f,p,x){return Mt("button",{class:"cm-button",name:f,onclick:p,type:"button"},x)}this.dom=Mt("div",{onkeydown:f=>this.keydown(f),class:"cm-search"},[this.searchField,c("next",()=>gn(n),[Mi(n,"next")]),c("prev",()=>Yn(n),[Mi(n,"previous")]),c("select",()=>Ai(n),[Mi(n,"all")]),Mt("label",null,[this.caseField,Mi(n,"match case")]),Mt("label",null,[this.reField,Mi(n,"regexp")]),Mt("label",null,[this.wordField,Mi(n,"by word")]),...n.state.readOnly?[]:[Mt("br"),this.replaceField,c("replace",()=>$r(n),[Mi(n,"replace")]),c("replaceAll",()=>qr(n),[Mi(n,"replace all")])],Mt("button",{name:"close",onclick:()=>Jr(n),"aria-label":Mi(n,"close"),type:"button"},["\xD7"])])}commit(){let n=new zr({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});n.eq(this.query)||(this.query=n,this.view.dispatch({effects:Gn.of(n)}))}keydown(n){(0,J.TS)(this.view,n,"search-panel")?n.preventDefault():n.keyCode==13&&n.target==this.searchField?(n.preventDefault(),(n.shiftKey?Yn:gn)(this.view)):n.keyCode==13&&n.target==this.replaceField&&(n.preventDefault(),$r(this.view))}update(n){for(let l of n.transactions)for(let c of l.effects)c.is(Gn)&&!c.value.eq(this.query)&&this.setQuery(c.value)}setQuery(n){this.query=n,this.searchField.value=n.search,this.replaceField.value=n.replace,this.caseField.checked=n.caseSensitive,this.reField.checked=n.regexp,this.wordField.checked=n.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Qi).top}}function Mi(r,n){return r.state.phrase(n)}const Jn=30,yn=/[\s\.,:;?!]/;function Gs(r,{from:n,to:l}){let c=r.state.doc.lineAt(n),f=r.state.doc.lineAt(l).to,p=Math.max(c.from,n-Jn),x=Math.min(f,l+Jn),M=r.state.sliceDoc(p,x);if(p!=c.from){for(let E=0;E<Jn;E++)if(!yn.test(M[E+1])&&yn.test(M[E])){M=M.slice(E);break}}if(x!=f){for(let E=M.length-1;E>M.length-Jn;E--)if(!yn.test(M[E-1])&&yn.test(M[E])){M=M.slice(0,E);break}}return J.Lz.announce.of(`${r.state.phrase("current match")}. ${M} ${r.state.phrase("on line")} ${c.number}.`)}const vs=J.Lz.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),En=[mi,R.Nb.low(ws),vs];class Xr{constructor(n,l,c,f){this.state=n,this.pos=l,this.explicit=c,this.view=f,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(n){let l=(0,Ae.mv)(this.state).resolveInner(this.pos,-1);for(;l&&n.indexOf(l.name)<0;)l=l.parent;return l?{from:l.from,to:this.pos,text:this.state.sliceDoc(l.from,this.pos),type:l.type}:null}matchBefore(n){let l=this.state.doc.lineAt(this.pos),c=Math.max(l.from,this.pos-250),f=l.text.slice(c-l.from,this.pos-l.from),p=f.search(Zs(n,!1));return p<0?null:{from:c+p,to:this.pos,text:f.slice(p)}}get aborted(){return this.abortListeners==null}addEventListener(n,l,c){n=="abort"&&this.abortListeners&&(this.abortListeners.push(l),c&&c.onDocChange&&(this.abortOnDocChange=!0))}}function Ys(r){let n=Object.keys(r).join(""),l=/\w/.test(n);return l&&(n=n.replace(/\w/g,"")),`[${l?"\\w":""}${n.replace(/[^\w\s]/g,"\\$&")}]`}function Js(r){let n=Object.create(null),l=Object.create(null);for(let{label:f}of r){n[f[0]]=!0;for(let p=1;p<f.length;p++)l[f[p]]=!0}let c=Ys(n)+Ys(l)+"*$";return[new RegExp("^"+c),new RegExp(c)]}function Xn(r){let n=r.map(f=>typeof f=="string"?{label:f}:f),[l,c]=n.every(f=>/^\w+$/.test(f.label))?[/\w*$/,/\w+$/]:Js(n);return f=>{let p=f.matchBefore(c);return p||f.explicit?{from:p?p.from:f.pos,options:n,validFor:l}:null}}function Xs(r,n){return l=>{for(let c=syntaxTree(l.state).resolveInner(l.pos,-1);c;c=c.parent){if(r.indexOf(c.name)>-1)return n(l);if(c.type.isTop)break}return null}}function Zr(r,n){return l=>{for(let c=syntaxTree(l.state).resolveInner(l.pos,-1);c;c=c.parent){if(r.indexOf(c.name)>-1)return null;if(c.type.isTop)break}return n(l)}}class ks{constructor(n,l,c,f){this.completion=n,this.source=l,this.match=c,this.score=f}}function tn(r){return r.selection.main.from}function Zs(r,n){var l;let{source:c}=r,f=n&&c[0]!="^",p=c[c.length-1]!="$";return!f&&!p?r:new RegExp(`${f?"^":""}(?:${c})${p?"$":""}`,(l=r.flags)!==null&&l!==void 0?l:r.ignoreCase?"i":"")}const Ss=R.YH.define();function Qs(r,n,l,c){let{main:f}=r.selection,p=l-f.from,x=c-f.from;return Object.assign(Object.assign({},r.changeByRange(M=>{if(M!=f&&l!=c&&r.sliceDoc(M.from+p,M.from+x)!=r.sliceDoc(l,c))return{range:M};let E=r.toText(n);return{changes:{from:M.from+p,to:c==f.from?M.to:M.from+x,insert:E},range:R.OF.cursor(M.from+p+E.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const Qr=new WeakMap;function Zo(r){if(!Array.isArray(r))return r;let n=Qr.get(r);return n||Qr.set(r,n=Xn(r)),n}const Rn=R.Pe.define(),Zn=R.Pe.define();class eo{constructor(n){this.pattern=n,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let l=0;l<n.length;){let c=(0,R.vS)(n,l),f=(0,R.Fh)(c);this.chars.push(c);let p=n.slice(l,l+f),x=p.toUpperCase();this.folded.push((0,R.vS)(x==p?p.toLowerCase():x,0)),l+=f}this.astral=n.length!=this.chars.length}ret(n,l){return this.score=n,this.matched=l,this}match(n){if(this.pattern.length==0)return this.ret(-100,[]);if(n.length<this.pattern.length)return null;let{chars:l,folded:c,any:f,precise:p,byWord:x}=this;if(l.length==1){let _t=(0,R.vS)(n,0),Gi=(0,R.Fh)(_t),Di=Gi==n.length?0:-100;if(_t!=l[0])if(_t==c[0])Di+=-200;else return null;return this.ret(Di,[0,Gi])}let M=n.indexOf(this.pattern);if(M==0)return this.ret(n.length==this.pattern.length?0:-100,[0,this.pattern.length]);let E=l.length,q=0;if(M<0){for(let _t=0,Gi=Math.min(n.length,200);_t<Gi&&q<E;){let Di=(0,R.vS)(n,_t);(Di==l[q]||Di==c[q])&&(f[q++]=_t),_t+=(0,R.Fh)(Di)}if(q<E)return null}let K=0,te=0,de=!1,ke=0,rt=-1,Ye=-1,ui=/[a-z]/.test(n),Li=!0;for(let _t=0,Gi=Math.min(n.length,200),Di=0;_t<Gi&&te<E;){let gi=(0,R.vS)(n,_t);M<0&&(K<E&&gi==l[K]&&(p[K++]=_t),ke<E&&(gi==l[ke]||gi==c[ke]?(ke==0&&(rt=_t),Ye=_t+1,ke++):ke=0));let ln,an=gi<255?gi>=48&&gi<=57||gi>=97&&gi<=122?2:gi>=65&&gi<=90?1:0:(ln=(0,R.MK)(gi))!=ln.toLowerCase()?1:ln!=ln.toUpperCase()?2:0;(!_t||an==1&&ui||Di==0&&an!=0)&&(l[te]==gi||c[te]==gi&&(de=!0)?x[te++]=_t:x.length&&(Li=!1)),Di=an,_t+=(0,R.Fh)(gi)}return te==E&&x[0]==0&&Li?this.result(-100+(de?-200:0),x,n):ke==E&&rt==0?this.ret(-200-n.length+(Ye==n.length?0:-100),[0,Ye]):M>-1?this.ret(-700-n.length,[M,M+this.pattern.length]):ke==E?this.ret(-900-n.length,[rt,Ye]):te==E?this.result(-100+(de?-200:0)+-700+(Li?0:-1100),x,n):l.length==2?null:this.result((f[0]?-700:0)+-200+-1100,f,n)}result(n,l,c){let f=[],p=0;for(let x of l){let M=x+(this.astral?(0,R.Fh)((0,R.vS)(c,x)):1);p&&f[p-1]==x?f[p-1]=M:(f[p++]=x,f[p++]=M)}return this.ret(n-c.length,f)}}class to{constructor(n){this.pattern=n,this.matched=[],this.score=0,this.folded=n.toLowerCase()}match(n){if(n.length<this.pattern.length)return null;let l=n.slice(0,this.pattern.length),c=l==this.pattern?0:l.toLowerCase()==this.folded?-200:null;return c==null?null:(this.matched=[0,l.length],this.score=c+(n.length==this.pattern.length?0:-100),this)}}const oi=R.sj.define({combine(r){return(0,R.QR)(r,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:ht,filterStrict:!1,compareCompletions:(n,l)=>n.label.localeCompare(l.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(n,l)=>n&&l,closeOnBlur:(n,l)=>n&&l,icons:(n,l)=>n&&l,tooltipClass:(n,l)=>c=>io(n(c),l(c)),optionClass:(n,l)=>c=>io(n(c),l(c)),addToOptions:(n,l)=>n.concat(l),filterStrict:(n,l)=>n||l})}});function io(r,n){return r?n?r+" "+n:r:n}function ht(r,n,l,c,f,p){let x=r.textDirection==J.OP.RTL,M=x,E=!1,q="top",K,te,de=n.left-f.left,ke=f.right-n.right,rt=c.right-c.left,Ye=c.bottom-c.top;if(M&&de<Math.min(rt,ke)?M=!1:!M&&ke<Math.min(rt,de)&&(M=!0),rt<=(M?de:ke))K=Math.max(f.top,Math.min(l.top,f.bottom-Ye))-n.top,te=Math.min(400,M?de:ke);else{E=!0,te=Math.min(400,(x?n.right:f.right-n.left)-30);let _t=f.bottom-n.bottom;_t>=Ye||_t>n.top?K=l.bottom-n.top:(q="bottom",K=n.bottom-l.top)}let ui=(n.bottom-n.top)/p.offsetHeight,Li=(n.right-n.left)/p.offsetWidth;return{style:`${q}: ${K/ui}px; max-width: ${te/Li}px`,class:"cm-completionInfo-"+(E?x?"left-narrow":"right-narrow":M?"left":"right")}}function Qo(r){let n=r.addToOptions.slice();return r.icons&&n.push({render(l){let c=document.createElement("div");return c.classList.add("cm-completionIcon"),l.type&&c.classList.add(...l.type.split(/\s+/g).map(f=>"cm-completionIcon-"+f)),c.setAttribute("aria-hidden","true"),c},position:20}),n.push({render(l,c,f,p){let x=document.createElement("span");x.className="cm-completionLabel";let M=l.displayLabel||l.label,E=0;for(let q=0;q<p.length;){let K=p[q++],te=p[q++];K>E&&x.appendChild(document.createTextNode(M.slice(E,K)));let de=x.appendChild(document.createElement("span"));de.appendChild(document.createTextNode(M.slice(K,te))),de.className="cm-completionMatchedText",E=te}return E<M.length&&x.appendChild(document.createTextNode(M.slice(E))),x},position:50},{render(l){if(!l.detail)return null;let c=document.createElement("span");return c.className="cm-completionDetail",c.textContent=l.detail,c},position:80}),n.sort((l,c)=>l.position-c.position).map(l=>l.render)}function Cs(r,n,l){if(r<=l)return{from:0,to:r};if(n<0&&(n=0),n<=r>>1){let f=Math.floor(n/l);return{from:f*l,to:(f+1)*l}}let c=Math.floor((r-n)/l);return{from:r-(c+1)*l,to:r-c*l}}class As{constructor(n,l,c){this.view=n,this.stateField=l,this.applyCompletion=c,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:E=>this.placeInfo(E),key:this},this.space=null,this.currentClass="";let f=n.state.field(l),{options:p,selected:x}=f.open,M=n.state.facet(oi);this.optionContent=Qo(M),this.optionClass=M.optionClass,this.tooltipClass=M.tooltipClass,this.range=Cs(p.length,x,M.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(n.state),this.dom.addEventListener("mousedown",E=>{let{options:q}=n.state.field(l).open;for(let K=E.target,te;K&&K!=this.dom;K=K.parentNode)if(K.nodeName=="LI"&&(te=/-(\d+)$/.exec(K.id))&&+te[1]<q.length){this.applyCompletion(n,q[+te[1]]),E.preventDefault();return}}),this.dom.addEventListener("focusout",E=>{let q=n.state.field(this.stateField,!1);q&&q.tooltip&&n.state.facet(oi).closeOnBlur&&E.relatedTarget!=n.contentDOM&&n.dispatch({effects:Zn.of(null)})}),this.showOptions(p,f.id)}mount(){this.updateSel()}showOptions(n,l){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(n,l,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(n){var l;let c=n.state.field(this.stateField),f=n.startState.field(this.stateField);if(this.updateTooltipClass(n.state),c!=f){let{options:p,selected:x,disabled:M}=c.open;(!f.open||f.open.options!=p)&&(this.range=Cs(p.length,x,n.state.facet(oi).maxRenderedOptions),this.showOptions(p,c.id)),this.updateSel(),M!=((l=f.open)===null||l===void 0?void 0:l.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!M)}}updateTooltipClass(n){let l=this.tooltipClass(n);if(l!=this.currentClass){for(let c of this.currentClass.split(" "))c&&this.dom.classList.remove(c);for(let c of l.split(" "))c&&this.dom.classList.add(c);this.currentClass=l}}positioned(n){this.space=n,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let n=this.view.state.field(this.stateField),l=n.open;if((l.selected>-1&&l.selected<this.range.from||l.selected>=this.range.to)&&(this.range=Cs(l.options.length,l.selected,this.view.state.facet(oi).maxRenderedOptions),this.showOptions(l.options,n.id)),this.updateSelectedOption(l.selected)){this.destroyInfo();let{completion:c}=l.options[l.selected],{info:f}=c;if(!f)return;let p=typeof f=="string"?document.createTextNode(f):f(c);if(!p)return;"then"in p?p.then(x=>{x&&this.view.state.field(this.stateField,!1)==n&&this.addInfoPane(x,c)}).catch(x=>(0,J.c_)(this.view.state,x,"completion info")):this.addInfoPane(p,c)}}addInfoPane(n,l){this.destroyInfo();let c=this.info=document.createElement("div");if(c.className="cm-tooltip cm-completionInfo",n.nodeType!=null)c.appendChild(n),this.infoDestroy=null;else{let{dom:f,destroy:p}=n;c.appendChild(f),this.infoDestroy=p||null}this.dom.appendChild(c),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(n){let l=null;for(let c=this.list.firstChild,f=this.range.from;c;c=c.nextSibling,f++)c.nodeName!="LI"||!c.id?f--:f==n?c.hasAttribute("aria-selected")||(c.setAttribute("aria-selected","true"),l=c):c.hasAttribute("aria-selected")&&c.removeAttribute("aria-selected");return l&&el(this.list,l),l}measureInfo(){let n=this.dom.querySelector("[aria-selected]");if(!n||!this.info)return null;let l=this.dom.getBoundingClientRect(),c=this.info.getBoundingClientRect(),f=n.getBoundingClientRect(),p=this.space;if(!p){let x=this.dom.ownerDocument.documentElement;p={left:0,top:0,right:x.clientWidth,bottom:x.clientHeight}}return f.top>Math.min(p.bottom,l.bottom)-10||f.bottom<Math.max(p.top,l.top)+10?null:this.view.state.facet(oi).positionInfo(this.view,l,f,c,p,this.dom)}placeInfo(n){this.info&&(n?(n.style&&(this.info.style.cssText=n.style),this.info.className="cm-tooltip cm-completionInfo "+(n.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(n,l,c){const f=document.createElement("ul");f.id=l,f.setAttribute("role","listbox"),f.setAttribute("aria-expanded","true"),f.setAttribute("aria-label",this.view.state.phrase("Completions")),f.addEventListener("mousedown",x=>{x.target==f&&x.preventDefault()});let p=null;for(let x=c.from;x<c.to;x++){let{completion:M,match:E}=n[x],{section:q}=M;if(q){let de=typeof q=="string"?q:q.name;if(de!=p&&(x>c.from||c.from==0))if(p=de,typeof q!="string"&&q.header)f.appendChild(q.header(q));else{let ke=f.appendChild(document.createElement("completion-section"));ke.textContent=de}}const K=f.appendChild(document.createElement("li"));K.id=l+"-"+x,K.setAttribute("role","option");let te=this.optionClass(M);te&&(K.className=te);for(let de of this.optionContent){let ke=de(M,this.view.state,this.view,E);ke&&K.appendChild(ke)}}return c.from&&f.classList.add("cm-completionListIncompleteTop"),c.to<n.length&&f.classList.add("cm-completionListIncompleteBottom"),f}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function no(r,n){return l=>new As(l,r,n)}function el(r,n){let l=r.getBoundingClientRect(),c=n.getBoundingClientRect(),f=l.height/r.offsetHeight;c.top<l.top?r.scrollTop-=(l.top-c.top)/f:c.bottom>l.bottom&&(r.scrollTop+=(c.bottom-l.bottom)/f)}function so(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function Ms(r,n){let l=[],c=null,f=q=>{l.push(q);let{section:K}=q.completion;if(K){c||(c=[]);let te=typeof K=="string"?K:K.name;c.some(de=>de.name==te)||c.push(typeof K=="string"?{name:te}:K)}},p=n.facet(oi);for(let q of r)if(q.hasResult()){let K=q.result.getMatch;if(q.result.filter===!1)for(let te of q.result.options)f(new ks(te,q.source,K?K(te):[],1e9-l.length));else{let te=n.sliceDoc(q.from,q.to),de,ke=p.filterStrict?new to(te):new eo(te);for(let rt of q.result.options)if(de=ke.match(rt.label)){let Ye=rt.displayLabel?K?K(rt,de.matched):[]:de.matched;f(new ks(rt,q.source,Ye,de.score+(rt.boost||0)))}}}if(c){let q=Object.create(null),K=0,te=(de,ke)=>{var rt,Ye;return((rt=de.rank)!==null&&rt!==void 0?rt:1e9)-((Ye=ke.rank)!==null&&Ye!==void 0?Ye:1e9)||(de.name<ke.name?-1:1)};for(let de of c.sort(te))K-=1e5,q[de.name]=K;for(let de of l){let{section:ke}=de.completion;ke&&(de.score+=q[typeof ke=="string"?ke:ke.name])}}let x=[],M=null,E=p.compareCompletions;for(let q of l.sort((K,te)=>te.score-K.score||E(K.completion,te.completion))){let K=q.completion;!M||M.label!=K.label||M.detail!=K.detail||M.type!=null&&K.type!=null&&M.type!=K.type||M.apply!=K.apply||M.boost!=K.boost?x.push(q):so(q.completion)>so(M)&&(x[x.length-1]=q),M=q.completion}return x}class In{constructor(n,l,c,f,p,x){this.options=n,this.attrs=l,this.tooltip=c,this.timestamp=f,this.selected=p,this.disabled=x}setSelected(n,l){return n==this.selected||n>=this.options.length?this:new In(this.options,$i(l,n),this.tooltip,this.timestamp,n,this.disabled)}static build(n,l,c,f,p,x){if(f&&!x&&n.some(q=>q.isPending))return f.setDisabled();let M=Ms(n,l);if(!M.length)return f&&n.some(q=>q.isPending)?f.setDisabled():null;let E=l.facet(oi).selectOnOpen?0:-1;if(f&&f.selected!=E&&f.selected!=-1){let q=f.options[f.selected].completion;for(let K=0;K<M.length;K++)if(M[K].completion==q){E=K;break}}return new In(M,$i(c,E),{pos:n.reduce((q,K)=>K.hasResult()?Math.min(q,K.from):q,1e8),create:nl,above:p.aboveCursor},f?f.timestamp:Date.now(),E,!1)}map(n){return new In(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:n.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new In(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Qn{constructor(n,l,c){this.active=n,this.id=l,this.open=c}static start(){return new Qn(il,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(n){let{state:l}=n,c=l.facet(oi),p=(c.override||l.languageDataAt("autocomplete",tn(l)).map(Zo)).map(E=>(this.active.find(K=>K.source==E)||new ki(E,this.active.some(K=>K.state!=0)?1:0)).update(n,c));p.length==this.active.length&&p.every((E,q)=>E==this.active[q])&&(p=this.active);let x=this.open,M=n.effects.some(E=>E.is(Os));x&&n.docChanged&&(x=x.map(n.changes)),n.selection||p.some(E=>E.hasResult()&&n.changes.touchesRange(E.from,E.to))||!ro(p,this.active)||M?x=In.build(p,l,this.id,x,c,M):x&&x.disabled&&!p.some(E=>E.isPending)&&(x=null),!x&&p.every(E=>!E.isPending)&&p.some(E=>E.hasResult())&&(p=p.map(E=>E.hasResult()?new ki(E.source,0):E));for(let E of n.effects)E.is(Ds)&&(x=x&&x.setSelected(E.value,this.id));return p==this.active&&x==this.open?this:new Qn(p,this.id,x)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?oo:tl}}function ro(r,n){if(r==n)return!0;for(let l=0,c=0;;){for(;l<r.length&&!r[l].hasResult();)l++;for(;c<n.length&&!n[c].hasResult();)c++;let f=l==r.length,p=c==n.length;if(f||p)return f==p;if(r[l++].result!=n[c++].result)return!1}}const oo={"aria-autocomplete":"list"},tl={};function $i(r,n){let l={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return n>-1&&(l["aria-activedescendant"]=r+"-"+n),l}const il=[];function lo(r,n){if(r.isUserEvent("input.complete")){let c=r.annotation(Ss);if(c&&n.activateOnCompletion(c))return 12}let l=r.isUserEvent("input.type");return l&&n.activateOnTyping?5:l?1:r.isUserEvent("delete.backward")?2:r.selection?8:r.docChanged?16:0}class ki{constructor(n,l,c=!1){this.source=n,this.state=l,this.explicit=c}hasResult(){return!1}get isPending(){return this.state==1}update(n,l){let c=lo(n,l),f=this;(c&8||c&16&&this.touches(n))&&(f=new ki(f.source,0)),c&4&&f.state==0&&(f=new ki(this.source,1)),f=f.updateFor(n,c);for(let p of n.effects)if(p.is(Rn))f=new ki(f.source,1,p.value);else if(p.is(Zn))f=new ki(f.source,0);else if(p.is(Os))for(let x of p.value)x.source==f.source&&(f=x);return f}updateFor(n,l){return this.map(n.changes)}map(n){return this}touches(n){return n.changes.touchesRange(tn(n.state))}}class bn extends ki{constructor(n,l,c,f,p,x){super(n,3,l),this.limit=c,this.result=f,this.from=p,this.to=x}hasResult(){return!0}updateFor(n,l){var c;if(!(l&3))return this.map(n.changes);let f=this.result;f.map&&!n.changes.empty&&(f=f.map(f,n.changes));let p=n.changes.mapPos(this.from),x=n.changes.mapPos(this.to,1),M=tn(n.state);if(M>x||!f||l&2&&(tn(n.startState)==this.from||M<this.limit))return new ki(this.source,l&4?1:0);let E=n.changes.mapPos(this.limit);return es(f.validFor,n.state,p,x)?new bn(this.source,this.explicit,E,f,p,x):f.update&&(f=f.update(f,p,x,new Xr(n.state,M,!1)))?new bn(this.source,this.explicit,E,f,f.from,(c=f.to)!==null&&c!==void 0?c:tn(n.state)):new ki(this.source,1,this.explicit)}map(n){return n.empty?this:(this.result.map?this.result.map(this.result,n):this.result)?new bn(this.source,this.explicit,n.mapPos(this.limit),this.result,n.mapPos(this.from),n.mapPos(this.to,1)):new ki(this.source,0)}touches(n){return n.changes.touchesRange(this.from,this.to)}}function es(r,n,l,c){if(!r)return!1;let f=n.sliceDoc(l,c);return typeof r=="function"?r(f,l,c,n):Zs(r,!0).test(f)}const Os=R.Pe.define({map(r,n){return r.map(l=>l.map(n))}}),Ds=R.Pe.define(),li=R.sU.define({create(){return Qn.start()},update(r,n){return r.update(n)},provide:r=>[J.DK.from(r,n=>n.tooltip),J.Lz.contentAttributes.from(r,n=>n.attrs)]});function er(r,n){const l=n.completion.apply||n.completion.label;let c=r.state.field(li).active.find(f=>f.source==n.source);return c instanceof bn?(typeof l=="string"?r.dispatch(Object.assign(Object.assign({},Qs(r.state,l,c.from,c.to)),{annotations:Ss.of(n.completion)})):l(r,n.completion,c.from,c.to),!0):!1}const nl=no(li,er);function xn(r,n="option"){return l=>{let c=l.state.field(li,!1);if(!c||!c.open||c.open.disabled||Date.now()-c.open.timestamp<l.state.facet(oi).interactionDelay)return!1;let f=1,p;n=="page"&&(p=(0,J.Eg)(l,c.open.tooltip))&&(f=Math.max(2,Math.floor(p.dom.offsetHeight/p.dom.querySelector("li").offsetHeight)-1));let{length:x}=c.open.options,M=c.open.selected>-1?c.open.selected+f*(r?1:-1):r?0:x-1;return M<0?M=n=="page"?0:x-1:M>=x&&(M=n=="page"?x-1:0),l.dispatch({effects:Ds.of(M)}),!0}}const ao=r=>{let n=r.state.field(li,!1);return r.state.readOnly||!n||!n.open||n.open.selected<0||n.open.disabled||Date.now()-n.open.timestamp<r.state.facet(oi).interactionDelay?!1:er(r,n.open.options[n.open.selected])},wn=r=>r.state.field(li,!1)?(r.dispatch({effects:Rn.of(!0)}),!0):!1,sl=r=>{let n=r.state.field(li,!1);return!n||!n.active.some(l=>l.state!=0)?!1:(r.dispatch({effects:Zn.of(null)}),!0)};class Fl{constructor(n,l){this.active=n,this.context=l,this.time=Date.now(),this.updates=[],this.done=void 0}}const ho=50,rl=1e3,co=J.Z9.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let n of r.state.field(li).active)n.isPending&&this.startQuery(n)}update(r){let n=r.state.field(li),l=r.state.facet(oi);if(!r.selectionSet&&!r.docChanged&&r.startState.field(li)==n)return;let c=r.transactions.some(p=>{let x=lo(p,l);return x&8||(p.selection||p.docChanged)&&!(x&3)});for(let p=0;p<this.running.length;p++){let x=this.running[p];if(c||x.context.abortOnDocChange&&r.docChanged||x.updates.length+r.transactions.length>ho&&Date.now()-x.time>rl){for(let M of x.context.abortListeners)try{M()}catch(E){(0,J.c_)(this.view.state,E)}x.context.abortListeners=null,this.running.splice(p--,1)}else x.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(p=>p.effects.some(x=>x.is(Rn)))&&(this.pendingStart=!0);let f=this.pendingStart?50:l.activateOnTypingDelay;if(this.debounceUpdate=n.active.some(p=>p.isPending&&!this.running.some(x=>x.active.source==p.source))?setTimeout(()=>this.startUpdate(),f):-1,this.composing!=0)for(let p of r.transactions)p.isUserEvent("input.type")?this.composing=2:this.composing==2&&p.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,n=r.field(li);for(let l of n.active)l.isPending&&!this.running.some(c=>c.active.source==l.source)&&this.startQuery(l);this.running.length&&n.open&&n.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(oi).updateSyncTime))}startQuery(r){let{state:n}=this.view,l=tn(n),c=new Xr(n,l,r.explicit,this.view),f=new Fl(r,c);this.running.push(f),Promise.resolve(r.source(c)).then(p=>{f.context.aborted||(f.done=p||null,this.scheduleAccept())},p=>{this.view.dispatch({effects:Zn.of(null)}),(0,J.c_)(this.view.state,p)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(oi).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let n=[],l=this.view.state.facet(oi),c=this.view.state.field(li);for(let f=0;f<this.running.length;f++){let p=this.running[f];if(p.done===void 0)continue;if(this.running.splice(f--,1),p.done){let M=tn(p.updates.length?p.updates[0].startState:this.view.state),E=Math.min(M,p.done.from+(p.active.explicit?0:1)),q=new bn(p.active.source,p.active.explicit,E,p.done,p.done.from,(r=p.done.to)!==null&&r!==void 0?r:M);for(let K of p.updates)q=q.update(K,l);if(q.hasResult()){n.push(q);continue}}let x=c.active.find(M=>M.source==p.active.source);if(x&&x.isPending)if(p.done==null){let M=new ki(p.active.source,0);for(let E of p.updates)M=M.update(E,l);M.isPending||n.push(M)}else this.startQuery(x)}(n.length||c.open&&c.open.disabled)&&this.view.dispatch({effects:Os.of(n)})}},{eventHandlers:{blur(r){let n=this.view.state.field(li,!1);if(n&&n.tooltip&&this.view.state.facet(oi).closeOnBlur){let l=n.open&&(0,J.Eg)(this.view,n.open.tooltip);(!l||!l.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Zn.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Rn.of(!1)}),20),this.composing=0}}}),ol=typeof navigator=="object"&&/Win/.test(navigator.platform),ll=R.Nb.highest(J.Lz.domEventHandlers({keydown(r,n){let l=n.state.field(li,!1);if(!l||!l.open||l.open.disabled||l.open.selected<0||r.key.length>1||r.ctrlKey&&!(ol&&r.altKey)||r.metaKey)return!1;let c=l.open.options[l.open.selected],f=l.active.find(x=>x.source==c.source),p=c.completion.commitCharacters||f.result.commitCharacters;return p&&p.indexOf(r.key)>-1&&er(n,c),!1}})),tr=J.Lz.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class ts{constructor(n,l,c,f){this.field=n,this.line=l,this.from=c,this.to=f}}class ir{constructor(n,l,c){this.field=n,this.from=l,this.to=c}map(n){let l=n.mapPos(this.from,-1,MapMode.TrackDel),c=n.mapPos(this.to,1,MapMode.TrackDel);return l==null||c==null?null:new ir(this.field,l,c)}}class nr{constructor(n,l){this.lines=n,this.fieldPositions=l}instantiate(n,l){let c=[],f=[l],p=n.doc.lineAt(l),x=/^\s*/.exec(p.text)[0];for(let E of this.lines){if(c.length){let q=x,K=/^\t*/.exec(E)[0].length;for(let te=0;te<K;te++)q+=n.facet(indentUnit);f.push(l+q.length-K),E=q+E.slice(K)}c.push(E),l+=E.length+1}let M=this.fieldPositions.map(E=>new ir(E.field,f[E.line]+E.from,f[E.line]+E.to));return{text:c,ranges:M}}static parse(n){let l=[],c=[],f=[],p;for(let x of n.split(/\r\n?|\n/)){for(;p=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(x);){let M=p[1]?+p[1]:null,E=p[2]||p[3]||"",q=-1,K=E.replace(/\\[{}]/g,te=>te[1]);for(let te=0;te<l.length;te++)(M!=null?l[te].seq==M:K&&l[te].name==K)&&(q=te);if(q<0){let te=0;for(;te<l.length&&(M==null||l[te].seq!=null&&l[te].seq<M);)te++;l.splice(te,0,{seq:M,name:K}),q=te;for(let de of f)de.field>=q&&de.field++}f.push(new ts(q,c.length,p.index,p.index+K.length)),x=x.slice(0,p.index)+E+x.slice(p.index+p[0].length)}x=x.replace(/\\([{}])/g,(M,E,q)=>{for(let K of f)K.line==c.length&&K.from>q&&(K.from--,K.to--);return E}),c.push(x)}return new nr(c,f)}}let fo=J.NZ.widget({widget:new class extends J.xO{toDOM(){let r=document.createElement("span");return r.className="cm-snippetFieldPosition",r}ignoreEvent(){return!1}}}),al=J.NZ.mark({class:"cm-snippetField"});class nn{constructor(n,l){this.ranges=n,this.active=l,this.deco=J.NZ.set(n.map(c=>(c.from==c.to?fo:al).range(c.from,c.to)))}map(n){let l=[];for(let c of this.ranges){let f=c.map(n);if(!f)return null;l.push(f)}return new nn(l,this.active)}selectionInsideField(n){return n.ranges.every(l=>this.ranges.some(c=>c.field==this.active&&c.from<=l.from&&c.to>=l.to))}}const vn=R.Pe.define({map(r,n){return r&&r.map(n)}}),hl=R.Pe.define(),kn=R.sU.define({create(){return null},update(r,n){for(let l of n.effects){if(l.is(vn))return l.value;if(l.is(hl)&&r)return new nn(r.ranges,l.value)}return r&&n.docChanged&&(r=r.map(n.changes)),r&&n.selection&&!r.selectionInsideField(n.selection)&&(r=null),r},provide:r=>J.Lz.decorations.from(r,n=>n?n.deco:J.NZ.none)});function is(r,n){return R.OF.create(r.filter(l=>l.field==n).map(l=>R.OF.range(l.from,l.to)))}function cl(r){let n=nr.parse(r);return(l,c,f,p)=>{let{text:x,ranges:M}=n.instantiate(l.state,f),{main:E}=l.state.selection,q={changes:{from:f,to:p==E.from?E.to:p,insert:Text.of(x)},scrollIntoView:!0,annotations:c?[Ss.of(c),Transaction.userEvent.of("input.complete")]:void 0};if(M.length&&(q.selection=is(M,0)),M.some(K=>K.field>0)){let K=new nn(M,0),te=q.effects=[vn.of(K)];l.state.field(kn,!1)===void 0&&te.push(StateEffect.appendConfig.of([kn,mo,pl,tr]))}l.dispatch(l.state.update(q))}}function ns(r){return({state:n,dispatch:l})=>{let c=n.field(kn,!1);if(!c||r<0&&c.active==0)return!1;let f=c.active+r,p=r>0&&!c.ranges.some(x=>x.field==f+r);return l(n.update({selection:is(c.ranges,f),effects:vn.of(p?null:new nn(c.ranges,f)),scrollIntoView:!0})),!0}}const fl=({state:r,dispatch:n})=>r.field(kn,!1)?(n(r.update({effects:vn.of(null)})),!0):!1,uo=ns(1),ul=ns(-1);function Hl(r){let n=r.field(kn,!1);return!!(n&&n.ranges.some(l=>l.field==n.active+1))}function Wl(r){let n=r.field(kn,!1);return!!(n&&n.active>0)}const dl=[{key:"Tab",run:uo,shift:ul},{key:"Escape",run:fl}],po=R.sj.define({combine(r){return r.length?r[0]:dl}}),mo=R.Nb.highest(J.w4.compute([po],r=>r.facet(po)));function Gl(r,n){return Object.assign(Object.assign({},n),{apply:cl(r)})}const pl=J.Lz.domEventHandlers({mousedown(r,n){let l=n.state.field(kn,!1),c;if(!l||(c=n.posAtCoords({x:r.clientX,y:r.clientY}))==null)return!1;let f=l.ranges.find(p=>p.from<=c&&p.to>=c);return!f||f.field==l.active?!1:(n.dispatch({selection:is(l.ranges,f.field),effects:vn.of(l.ranges.some(p=>p.field>f.field)?new nn(l.ranges,f.field):null),scrollIntoView:!0}),!0)}});function ml(r){let n=r.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${n}]+`,"ug")}catch{return new RegExp(`[w${n}]`,"g")}}function go(r,n){return new RegExp(n(r.source),r.unicode?"u":"")}const yo=null;function gl(r){return yo[r]||(yo[r]=new WeakMap)}function Ts(r,n,l,c,f){for(let p=r.iterLines(),x=0;!p.next().done;){let{value:M}=p,E;for(n.lastIndex=0;E=n.exec(M);)if(!c[E[0]]&&x+E.index!=f&&(l.push({type:"text",label:E[0]}),c[E[0]]=!0,l.length>=2e3))return;x+=M.length+1}}function bo(r,n,l,c,f){let p=r.length>=1e3,x=p&&n.get(r);if(x)return x;let M=[],E=Object.create(null);if(r.children){let q=0;for(let K of r.children){if(K.length>=1e3)for(let te of bo(K,n,l,c-q,f-q))E[te.label]||(E[te.label]=!0,M.push(te));else Ts(K,l,M,E,f-q);q+=K.length+1}}else Ts(r,l,M,E,f);return p&&M.length<2e3&&n.set(r,M),M}const zl=r=>{let n=r.state.languageDataAt("wordChars",r.pos).join(""),l=ml(n),c=r.matchBefore(go(l,x=>x+"$"));if(!c&&!r.explicit)return null;let f=c?c.from:r.pos,p=bo(r.state.doc,gl(n),l,5e4,f);return{from:f,options:p,validFor:go(l,x=>"^"+x)}},Nn={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Sn=R.Pe.define({map(r,n){let l=n.mapPos(r,-1,R.iR.TrackAfter);return l??void 0}}),sr=new class extends R.FB{};sr.startSide=1,sr.endSide=-1;const xo=R.sU.define({create(){return R.om.empty},update(r,n){if(r=r.map(n.changes),n.selection){let l=n.state.doc.lineAt(n.selection.main.head);r=r.update({filter:c=>c>=l.from&&c<=l.to})}for(let l of n.effects)l.is(Sn)&&(r=r.update({add:[sr.range(l.value,l.value+1)]}));return r}});function yl(){return[bl,xo]}const rr="()[]{}<>\xAB\xBB\xBB\xAB\uFF3B\uFF3D\uFF5B\uFF5D";function Fn(r){for(let n=0;n<rr.length;n+=2)if(rr.charCodeAt(n)==r)return rr.charAt(n+1);return(0,R.MK)(r<128?r:r+1)}function or(r,n){return r.languageDataAt("closeBrackets",n)[0]||Nn}const Vl=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),bl=J.Lz.inputHandler.of((r,n,l,c)=>{if((Vl?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let f=r.state.selection.main;if(c.length>2||c.length==2&&(0,R.Fh)((0,R.vS)(c,0))==1||n!=f.from||l!=f.to)return!1;let p=Ps(r.state,c);return p?(r.dispatch(p),!0):!1}),wo=[{key:"Backspace",run:({state:r,dispatch:n})=>{if(r.readOnly)return!1;let c=or(r,r.selection.main.head).brackets||Nn.brackets,f=null,p=r.changeByRange(x=>{if(x.empty){let M=xl(r.doc,x.head);for(let E of c)if(E==M&&Ls(r.doc,x.head)==Fn((0,R.vS)(E,0)))return{changes:{from:x.head-E.length,to:x.head+E.length},range:R.OF.cursor(x.head-E.length)}}return{range:f=x}});return f||n(r.update(p,{scrollIntoView:!0,userEvent:"delete.backward"})),!f}}];function Ps(r,n){let l=or(r,r.selection.main.head),c=l.brackets||Nn.brackets;for(let f of c){let p=Fn((0,R.vS)(f,0));if(n==f)return p==f?Bs(r,f,c.indexOf(f+f+f)>-1,l):hr(r,f,p,l.before||Nn.before);if(n==p&&ar(r,r.selection.main.from))return ss(r,f,p)}return null}function ar(r,n){let l=!1;return r.field(xo).between(0,r.doc.length,c=>{c==n&&(l=!0)}),l}function Ls(r,n){let l=r.sliceString(n,n+2);return l.slice(0,(0,R.Fh)((0,R.vS)(l,0)))}function xl(r,n){let l=r.sliceString(n-2,n);return(0,R.Fh)((0,R.vS)(l,0))==l.length?l:l.slice(1)}function hr(r,n,l,c){let f=null,p=r.changeByRange(x=>{if(!x.empty)return{changes:[{insert:n,from:x.from},{insert:l,from:x.to}],effects:Sn.of(x.to+n.length),range:R.OF.range(x.anchor+n.length,x.head+n.length)};let M=Ls(r.doc,x.head);return!M||/\s/.test(M)||c.indexOf(M)>-1?{changes:{insert:n+l,from:x.head},effects:Sn.of(x.head+n.length),range:R.OF.cursor(x.head+n.length)}:{range:f=x}});return f?null:r.update(p,{scrollIntoView:!0,userEvent:"input.type"})}function ss(r,n,l){let c=null,f=r.changeByRange(p=>p.empty&&Ls(r.doc,p.head)==l?{changes:{from:p.head,to:p.head+l.length,insert:l},range:R.OF.cursor(p.head+l.length)}:c={range:p});return c?null:r.update(f,{scrollIntoView:!0,userEvent:"input.type"})}function Bs(r,n,l,c){let f=c.stringPrefixes||Nn.stringPrefixes,p=null,x=r.changeByRange(M=>{if(!M.empty)return{changes:[{insert:n,from:M.from},{insert:n,from:M.to}],effects:Sn.of(M.to+n.length),range:R.OF.range(M.anchor+n.length,M.head+n.length)};let E=M.head,q=Ls(r.doc,E),K;if(q==n){if(vo(r,E))return{changes:{insert:n+n,from:E},effects:Sn.of(E+n.length),range:R.OF.cursor(E+n.length)};if(ar(r,E)){let de=l&&r.sliceDoc(E,E+n.length*3)==n+n+n?n+n+n:n;return{changes:{from:E,to:E+de.length,insert:de},range:R.OF.cursor(E+de.length)}}}else{if(l&&r.sliceDoc(E-2*n.length,E)==n+n&&(K=rs(r,E-2*n.length,f))>-1&&vo(r,K))return{changes:{insert:n+n+n+n,from:E},effects:Sn.of(E+n.length),range:R.OF.cursor(E+n.length)};if(r.charCategorizer(E)(q)!=R.Je.Word&&rs(r,E,f)>-1&&!wl(r,E,n,f))return{changes:{insert:n+n,from:E},effects:Sn.of(E+n.length),range:R.OF.cursor(E+n.length)}}return{range:p=M}});return p?null:r.update(x,{scrollIntoView:!0,userEvent:"input.type"})}function vo(r,n){let l=(0,Ae.mv)(r).resolveInner(n+1);return l.parent&&l.from==n}function wl(r,n,l,c){let f=(0,Ae.mv)(r).resolveInner(n,-1),p=c.reduce((x,M)=>Math.max(x,M.length),0);for(let x=0;x<5;x++){let M=r.sliceDoc(f.from,Math.min(f.to,f.from+l.length+p)),E=M.indexOf(l);if(!E||E>-1&&c.indexOf(M.slice(0,E))>-1){let K=f.firstChild;for(;K&&K.from==f.from&&K.to-K.from>l.length+E;){if(r.sliceDoc(K.to-l.length,K.to)==l)return!1;K=K.firstChild}return!0}let q=f.to==n&&f.parent;if(!q)break;f=q}return!1}function rs(r,n,l){let c=r.charCategorizer(n);if(c(r.sliceDoc(n-1,n))!=R.Je.Word)return n;for(let f of l){let p=n-f.length;if(r.sliceDoc(p,n)==f&&c(r.sliceDoc(p-1,p))!=R.Je.Word)return p}return-1}function vl(r={}){return[ll,li,oi.of(r),co,kl,tr]}const ko=[{key:"Ctrl-Space",run:wn},{mac:"Alt-`",run:wn},{key:"Escape",run:sl},{key:"ArrowDown",run:xn(!0)},{key:"ArrowUp",run:xn(!1)},{key:"PageDown",run:xn(!0,"page")},{key:"PageUp",run:xn(!1,"page")},{key:"Enter",run:ao}],kl=R.Nb.highest(J.w4.computeN([oi],r=>r.facet(oi).defaultKeymap?[ko]:[]));function _l(r){let n=r.field(li,!1);return n&&n.active.some(l=>l.isPending)?"pending":n&&n.active.some(l=>l.state!=0)?"active":null}const Sl=new WeakMap;function jl(r){var n;let l=(n=r.field(li,!1))===null||n===void 0?void 0:n.open;if(!l||l.disabled)return[];let c=Sl.get(l.options);return c||Sl.set(l.options,c=l.options.map(f=>f.completion)),c}function Yl(r){var n;let l=(n=r.field(li,!1))===null||n===void 0?void 0:n.open;return l&&!l.disabled&&l.selected>=0?l.options[l.selected].completion:null}function Jl(r){var n;let l=(n=r.field(li,!1))===null||n===void 0?void 0:n.open;return l&&!l.disabled&&l.selected>=0?l.selected:null}function So(r){return Ds.of(r)}class Cl{constructor(n,l,c){this.from=n,this.to=l,this.diagnostic=c}}class sn{constructor(n,l,c){this.diagnostics=n,this.panel=l,this.selected=c}static init(n,l,c){let f=c.facet(An).markerFilter;f&&(n=f(n,c));let p=n.slice().sort((K,te)=>K.from-te.from||K.to-te.to),x=new R.vB,M=[],E=0;for(let K=0;;){let te=K==p.length?null:p[K];if(!te&&!M.length)break;let de,ke;for(M.length?(de=E,ke=M.reduce((Ye,ui)=>Math.min(Ye,ui.to),te&&te.from>de?te.from:1e8)):(de=te.from,ke=te.to,M.push(te),K++);K<p.length;){let Ye=p[K];if(Ye.from==de&&(Ye.to>Ye.from||Ye.to==de))M.push(Ye),K++,ke=Math.min(Ye.to,ke);else{ke=Math.min(Ye.from,ke);break}}let rt=Do(M);if(M.some(Ye=>Ye.from==Ye.to||Ye.from==Ye.to-1&&c.doc.lineAt(Ye.from).to==Ye.from))x.add(de,de,J.NZ.widget({widget:new Dl(rt),diagnostics:M.slice()}));else{let Ye=M.reduce((ui,Li)=>Li.markClass?ui+" "+Li.markClass:ui,"");x.add(de,ke,J.NZ.mark({class:"cm-lintRange cm-lintRange-"+rt+Ye,diagnostics:M.slice(),inclusiveEnd:M.some(ui=>ui.to>ke)}))}E=ke;for(let Ye=0;Ye<M.length;Ye++)M[Ye].to<=E&&M.splice(Ye--,1)}let q=x.finish();return new sn(q,l,Cn(q))}}function Cn(r,n=null,l=0){let c=null;return r.between(l,1e9,(f,p,{spec:x})=>{if(!(n&&x.diagnostics.indexOf(n)<0))if(!c)c=new Cl(f,p,n||x.diagnostics[0]);else{if(x.diagnostics.indexOf(c.diagnostic)<0)return!1;c=new Cl(c.from,p,c.diagnostic)}}),c}function os(r,n){let l=n.pos,c=n.end||l,f=r.state.facet(An).hideOn(r,l,c);if(f!=null)return f;let p=r.startState.doc.lineAt(n.pos);return!!(r.effects.some(x=>x.is(ur))||r.changes.touchesRange(p.from,Math.max(p.to,c)))}function cr(r,n){return r.field(ci,!1)?n:n.concat(R.Pe.appendConfig.of(Lo))}function fr(r,n){return{effects:cr(r,[ur.of(n)])}}const ur=R.Pe.define(),Co=R.Pe.define(),ls=R.Pe.define(),ci=R.sU.define({create(){return new sn(J.NZ.none,null,null)},update(r,n){if(n.docChanged&&r.diagnostics.size){let l=r.diagnostics.map(n.changes),c=null,f=r.panel;if(r.selected){let p=n.changes.mapPos(r.selected.from,1);c=Cn(l,r.selected.diagnostic,p)||Cn(l,null,p)}!l.size&&f&&n.state.facet(An).autoPanel&&(f=null),r=new sn(l,f,c)}for(let l of n.effects)if(l.is(ur)){let c=n.state.facet(An).autoPanel?l.value.length?cs.open:null:r.panel;r=sn.init(l.value,c,n.state)}else l.is(Co)?r=new sn(r.diagnostics,l.value?cs.open:null,r.selected):l.is(ls)&&(r=new sn(r.diagnostics,r.panel,l.value));return r},provide:r=>[J.S7.from(r,n=>n.panel),J.Lz.decorations.from(r,n=>n.diagnostics)]});function Al(r){let n=r.field(ci,!1);return n?n.diagnostics.size:0}const Ml=J.NZ.mark({class:"cm-lintRange cm-lintRange-active"});function qi(r,n,l){let{diagnostics:c}=r.state.field(ci),f,p=-1,x=-1;c.between(n-(l<0?1:0),n+(l>0?1:0),(E,q,{spec:K})=>{if(n>=E&&n<=q&&(E==q||(n>E||l>0)&&(n<q||l<0)))return f=K.diagnostics,p=E,x=q,!1});let M=r.state.facet(An).tooltipFilter;return f&&M&&(f=M(f,r.state)),f?{pos:p,end:x,above:r.state.doc.lineAt(p).to<x,create(){return{dom:as(r,f)}}}:null}function as(r,n){return Mt("ul",{class:"cm-tooltip-lint"},n.map(l=>gr(r,l,!1)))}const Ol=r=>{let n=r.state.field(ci,!1);(!n||!n.panel)&&r.dispatch({effects:cr(r.state,[Co.of(!0)])});let l=(0,J.ld)(r,cs.open);return l&&l.dom.querySelector(".cm-panel-lint ul").focus(),!0},Ao=r=>{let n=r.state.field(ci,!1);return!n||!n.panel?!1:(r.dispatch({effects:Co.of(!1)}),!0)},hs=r=>{let n=r.state.field(ci,!1);if(!n)return!1;let l=r.state.selection.main,c=n.diagnostics.iter(l.to+1);return!c.value&&(c=n.diagnostics.iter(0),!c.value||c.from==l.from&&c.to==l.to)?!1:(r.dispatch({selection:{anchor:c.from,head:c.to},scrollIntoView:!0}),!0)},Kl=r=>{let{state:n}=r,l=n.field(ci,!1);if(!l)return!1;let c=n.selection.main,f,p,x,M;return l.diagnostics.between(0,n.doc.length,(E,q)=>{q<c.to&&(f==null||f<E)&&(f=E,p=q),(x==null||E>x)&&(x=E,M=q)}),x==null||f==null&&x==c.from?!1:(r.dispatch({selection:{anchor:f??x,head:p??M},scrollIntoView:!0}),!0)},dr=[{key:"Mod-Shift-m",run:Ol,preventDefault:!0},{key:"F8",run:hs}],pr=null;function $l(r,n,l){let c=[],f=-1;for(let p of r)p.then(x=>{c.push(x),clearTimeout(f),c.length==r.length?n(c):f=setTimeout(()=>n(c),200)},l)}const An=R.sj.define({combine(r){return Object.assign({sources:r.map(n=>n.source).filter(n=>n!=null)},(0,R.QR)(r.map(n=>n.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(n,l)=>n?l?c=>n(c)||l(c):n:l}))}});function Mo(r,n={}){return[An.of({source:r,config:n}),pr,Lo]}function ql(r){let n=r.plugin(pr);n&&n.force()}function mr(r){let n=[];if(r)e:for(let{name:l}of r){for(let c=0;c<l.length;c++){let f=l[c];if(/[a-zA-Z]/.test(f)&&!n.some(p=>p.toLowerCase()==f.toLowerCase())){n.push(f);continue e}}n.push("")}return n}function gr(r,n,l){var c;let f=l?mr(n.actions):[];return Mt("li",{class:"cm-diagnostic cm-diagnostic-"+n.severity},Mt("span",{class:"cm-diagnosticText"},n.renderMessage?n.renderMessage(r):n.message),(c=n.actions)===null||c===void 0?void 0:c.map((p,x)=>{let M=!1,E=de=>{if(de.preventDefault(),M)return;M=!0;let ke=Cn(r.state.field(ci).diagnostics,n);ke&&p.apply(r,ke.from,ke.to)},{name:q}=p,K=f[x]?q.indexOf(f[x]):-1,te=K<0?q:[q.slice(0,K),Mt("u",q.slice(K,K+1)),q.slice(K+1)];return Mt("button",{type:"button",class:"cm-diagnosticAction",onclick:E,onmousedown:E,"aria-label":` Action: ${q}${K<0?"":` (access key "${f[x]})"`}.`},te)}),n.source&&Mt("div",{class:"cm-diagnosticSource"},n.source))}class Dl extends J.xO{constructor(n){super(),this.sev=n}eq(n){return n.sev==this.sev}toDOM(){return Mt("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class Oo{constructor(n,l){this.diagnostic=l,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=gr(n,l,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class cs{constructor(n){this.view=n,this.items=[];let l=f=>{if(f.keyCode==27)Ao(this.view),this.view.focus();else if(f.keyCode==38||f.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(f.keyCode==40||f.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(f.keyCode==36)this.moveSelection(0);else if(f.keyCode==35)this.moveSelection(this.items.length-1);else if(f.keyCode==13)this.view.focus();else if(f.keyCode>=65&&f.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:p}=this.items[this.selectedIndex],x=mr(p.actions);for(let M=0;M<x.length;M++)if(x[M].toUpperCase().charCodeAt(0)==f.keyCode){let E=Cn(this.view.state.field(ci).diagnostics,p);E&&p.actions[M].apply(n,E.from,E.to)}}else return;f.preventDefault()},c=f=>{for(let p=0;p<this.items.length;p++)this.items[p].dom.contains(f.target)&&this.moveSelection(p)};this.list=Mt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:l,onclick:c}),this.dom=Mt("div",{class:"cm-panel-lint"},this.list,Mt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Ao(this.view)},"\xD7")),this.update()}get selectedIndex(){let n=this.view.state.field(ci).selected;if(!n)return-1;for(let l=0;l<this.items.length;l++)if(this.items[l].diagnostic==n.diagnostic)return l;return-1}update(){let{diagnostics:n,selected:l}=this.view.state.field(ci),c=0,f=!1,p=null,x=new Set;for(n.between(0,this.view.state.doc.length,(M,E,{spec:q})=>{for(let K of q.diagnostics){if(x.has(K))continue;x.add(K);let te=-1,de;for(let ke=c;ke<this.items.length;ke++)if(this.items[ke].diagnostic==K){te=ke;break}te<0?(de=new Oo(this.view,K),this.items.splice(c,0,de),f=!0):(de=this.items[te],te>c&&(this.items.splice(c,te-c),f=!0)),l&&de.diagnostic==l.diagnostic?de.dom.hasAttribute("aria-selected")||(de.dom.setAttribute("aria-selected","true"),p=de):de.dom.hasAttribute("aria-selected")&&de.dom.removeAttribute("aria-selected"),c++}});c<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)f=!0,this.items.pop();this.items.length==0&&(this.items.push(new Oo(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),f=!0),p?(this.list.setAttribute("aria-activedescendant",p.id),this.view.requestMeasure({key:this,read:()=>({sel:p.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:M,panel:E})=>{let q=E.height/this.list.offsetHeight;M.top<E.top?this.list.scrollTop-=(E.top-M.top)/q:M.bottom>E.bottom&&(this.list.scrollTop+=(M.bottom-E.bottom)/q)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),f&&this.sync()}sync(){let n=this.list.firstChild;function l(){let c=n;n=c.nextSibling,c.remove()}for(let c of this.items)if(c.dom.parentNode==this.list){for(;n!=c.dom;)l();n=c.dom.nextSibling}else this.list.insertBefore(c.dom,n);for(;n;)l()}moveSelection(n){if(this.selectedIndex<0)return;let l=this.view.state.field(ci),c=Cn(l.diagnostics,this.items[n].diagnostic);c&&this.view.dispatch({selection:{anchor:c.from,head:c.to},scrollIntoView:!0,effects:ls.of(c)})}static open(n){return new cs(n)}}function Ui(r,n='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${n}>${encodeURIComponent(r)}</svg>')`}function Hn(r){return Ui(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const yr=J.Lz.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Hn("#d11")},".cm-lintRange-warning":{backgroundImage:Hn("orange")},".cm-lintRange-info":{backgroundImage:Hn("#999")},".cm-lintRange-hint":{backgroundImage:Hn("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function Tl(r){return r=="error"?4:r=="warning"?3:r=="info"?2:1}function Do(r){let n="hint",l=1;for(let c of r){let f=Tl(c.severity);f>l&&(l=f,n=c.severity)}return n}class br extends J.wJ{constructor(n){super(),this.diagnostics=n,this.severity=Do(n)}toDOM(n){let l=document.createElement("div");l.className="cm-lint-marker cm-lint-marker-"+this.severity;let c=this.diagnostics,f=n.state.facet(vr).tooltipFilter;return f&&(c=f(c,n.state)),c.length&&(l.onmouseover=()=>Ll(n,l,c)),l}}function Pl(r,n){let l=c=>{let f=n.getBoundingClientRect();if(!(c.clientX>f.left-10&&c.clientX<f.right+10&&c.clientY>f.top-10&&c.clientY<f.bottom+10)){for(let p=c.target;p;p=p.parentNode)if(p.nodeType==1&&p.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",l),r.state.field(Po)&&r.dispatch({effects:wr.of(null)})}};window.addEventListener("mousemove",l)}function Ll(r,n,l){function c(){let x=r.elementAtHeight(n.getBoundingClientRect().top+5-r.documentTop);r.coordsAtPos(x.from)&&r.dispatch({effects:wr.of({pos:x.from,above:!1,clip:!1,create(){return{dom:as(r,l),getCoords:()=>n.getBoundingClientRect()}}})}),n.onmouseout=n.onmousemove=null,Pl(r,n)}let{hoverTime:f}=r.state.facet(vr),p=setTimeout(c,f);n.onmouseout=()=>{clearTimeout(p),n.onmouseout=n.onmousemove=null},n.onmousemove=()=>{clearTimeout(p),p=setTimeout(c,f)}}function Bl(r,n){let l=Object.create(null);for(let f of n){let p=r.lineAt(f.from);(l[p.from]||(l[p.from]=[])).push(f)}let c=[];for(let f in l)c.push(new br(l[f]).range(+f));return R.om.of(c,!0)}const To=(0,J.cU)({class:"cm-gutter-lint",markers:r=>r.state.field(xr),widgetMarker:(r,n,l)=>{let c=[];return r.state.field(xr).between(l.from,l.to,(f,p,x)=>{f>l.from&&f<l.to&&c.push(...x.diagnostics)}),c.length?new br(c):null}}),xr=R.sU.define({create(){return R.om.empty},update(r,n){r=r.map(n.changes);let l=n.state.facet(vr).markerFilter;for(let c of n.effects)if(c.is(ur)){let f=c.value;l&&(f=l(f||[],n.state)),r=Bl(n.state.doc,f.slice(0))}return r}}),wr=R.Pe.define(),Po=R.sU.define({create(){return null},update(r,n){return r&&n.docChanged&&(r=os(n,r)?null:Object.assign(Object.assign({},r),{pos:n.changes.mapPos(r.pos)})),n.effects.reduce((l,c)=>c.is(wr)?c.value:l,r)},provide:r=>J.DK.from(r)}),Ul=J.Lz.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Ui('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Ui('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Ui('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),Lo=[ci,J.Lz.decorations.compute([ci],r=>{let{selected:n,panel:l}=r.field(ci);return!n||!l||n.from==n.to?J.NZ.none:J.NZ.set([Ml.range(n.from,n.to)])}),(0,J.Ux)(qi,{hideOn:os}),yr],vr=R.sj.define({combine(r){return(0,R.QR)(r,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function Xl(r={}){return[vr.of(r),xr,To,Ul,Po]}function o(r,n){let l=r.field(ci,!1);if(l&&l.diagnostics.size){let c=[],f=[],p=-1;for(let x=RangeSet.iter([l.diagnostics]);;x.next()){for(let M=0;M<c.length;M++)(!x.value||x.value.spec.diagnostics.indexOf(c[M])<0)&&(n(c[M],f[M],p),c.splice(M,1),f.splice(M--,1));if(!x.value)break;for(let M of x.value.spec.diagnostics)c.indexOf(M)<0&&(c.push(M),f.push(x.from));p=x.to}}}var e=function(n){n===void 0&&(n={});var{crosshairCursor:l=!1}=n,c=[];n.closeBracketsKeymap!==!1&&(c=c.concat(wo)),n.defaultKeymap!==!1&&(c=c.concat(zo)),n.searchKeymap!==!1&&(c=c.concat(Xo)),n.historyKeymap!==!1&&(c=c.concat(k)),n.foldKeymap!==!1&&(c=c.concat(Ae.f7)),n.completionKeymap!==!1&&(c=c.concat(ko)),n.lintKeymap!==!1&&(c=c.concat(dr));var f=[];return n.lineNumbers!==!1&&f.push((0,J.$K)()),n.highlightActiveLineGutter!==!1&&f.push((0,J.Wu)()),n.highlightSpecialChars!==!1&&f.push((0,J.N$)()),n.history!==!1&&f.push(Tt()),n.foldGutter!==!1&&f.push((0,Ae.Lv)()),n.drawSelection!==!1&&f.push((0,J.VH)()),n.dropCursor!==!1&&f.push((0,J.A)()),n.allowMultipleSelections!==!1&&f.push(R.$t.allowMultipleSelections.of(!0)),n.indentOnInput!==!1&&f.push((0,Ae.WD)()),n.syntaxHighlighting!==!1&&f.push((0,Ae.y9)(Ae.Zt,{fallback:!0})),n.bracketMatching!==!1&&f.push((0,Ae.SG)()),n.closeBrackets!==!1&&f.push(yl()),n.autocompletion!==!1&&f.push(vl()),n.rectangularSelection!==!1&&f.push((0,J.D4)()),l!==!1&&f.push((0,J.HJ)()),n.highlightActiveLine!==!1&&f.push((0,J.dz)()),n.highlightSelectionMatches!==!1&&f.push(Ko()),n.tabSize&&typeof n.tabSize=="number"&&f.push(Ae.Xt.of(" ".repeat(n.tabSize))),f.concat([J.w4.of(c.flat())]).filter(Boolean)},t=function(n){n===void 0&&(n={});var l=[];n.defaultKeymap!==!1&&(l=l.concat(defaultKeymap)),n.historyKeymap!==!1&&(l=l.concat(historyKeymap));var c=[];return n.highlightSpecialChars!==!1&&c.push(highlightSpecialChars()),n.history!==!1&&c.push(history()),n.drawSelection!==!1&&c.push(drawSelection()),n.syntaxHighlighting!==!1&&c.push(syntaxHighlighting(defaultHighlightStyle,{fallback:!0})),c.concat([keymap.of(l.flat())]).filter(Boolean)},i=Qe(49913);const s="#e5c07b",a="#e06c75",u="#56b6c2",m="#ffffff",b="#abb2bf",C="#7d8799",S="#61afef",I="#98c379",W="#d19a66",U="#c678dd",Y="#21252b",ee="#2c313a",re="#282c34",se="#353a42",Ce="#3E4451",Le="#528bff",De={chalky:s,coral:a,cyan:u,invalid:m,ivory:b,stone:C,malibu:S,sage:I,whiskey:W,violet:U,darkBackground:Y,highlightBackground:ee,background:re,tooltipBackground:se,selection:Ce,cursor:Le},He=J.Lz.theme({"&":{color:b,backgroundColor:re},".cm-content":{caretColor:Le},".cm-cursor, .cm-dropCursor":{borderLeftColor:Le},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Ce},".cm-panels":{backgroundColor:Y,color:b},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:re,color:C,border:"none"},".cm-activeLineGutter":{backgroundColor:ee},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:se},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:se,borderBottomColor:se},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:ee,color:b}}},{dark:!0}),We=Ae.cr.define([{tag:i._A.keyword,color:U},{tag:[i._A.name,i._A.deleted,i._A.character,i._A.propertyName,i._A.macroName],color:a},{tag:[i._A.function(i._A.variableName),i._A.labelName],color:S},{tag:[i._A.color,i._A.constant(i._A.name),i._A.standard(i._A.name)],color:W},{tag:[i._A.definition(i._A.name),i._A.separator],color:b},{tag:[i._A.typeName,i._A.className,i._A.number,i._A.changed,i._A.annotation,i._A.modifier,i._A.self,i._A.namespace],color:s},{tag:[i._A.operator,i._A.operatorKeyword,i._A.url,i._A.escape,i._A.regexp,i._A.link,i._A.special(i._A.string)],color:u},{tag:[i._A.meta,i._A.comment],color:C},{tag:i._A.strong,fontWeight:"bold"},{tag:i._A.emphasis,fontStyle:"italic"},{tag:i._A.strikethrough,textDecoration:"line-through"},{tag:i._A.link,color:C,textDecoration:"underline"},{tag:i._A.heading,fontWeight:"bold",color:a},{tag:[i._A.atom,i._A.bool,i._A.special(i._A.variableName)],color:W},{tag:[i._A.processingInstruction,i._A.string,i._A.inserted],color:I},{tag:i._A.invalid,color:m}]),Ht=[He,(0,Ae.y9)(We)];var fi=J.Lz.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),rn=function(n){n===void 0&&(n={});var{indentWithTab:l=!0,editable:c=!0,readOnly:f=!1,theme:p="light",placeholder:x="",basicSetup:M=!0}=n,E=[];switch(l&&E.unshift(J.w4.of([Vo])),M&&(typeof M=="boolean"?E.unshift(e()):E.unshift(e(M))),x&&E.unshift((0,J.qf)(x)),p){case"light":E.push(fi);break;case"dark":E.push(Ht);break;case"none":break;default:E.push(p);break}return c===!1&&E.push(J.Lz.editable.of(!1)),f&&E.push(R.$t.readOnly.of(!0)),[...E]},Es=r=>({line:r.state.doc.lineAt(r.state.selection.main.from),lineCount:r.state.doc.lines,lineBreak:r.state.lineBreak,length:r.state.doc.length,readOnly:r.state.readOnly,tabSize:r.state.tabSize,selection:r.state.selection,selectionAsSingle:r.state.selection.asSingle().main,ranges:r.state.selection.ranges,selectionCode:r.state.sliceDoc(r.state.selection.main.from,r.state.selection.main.to),selections:r.state.selection.ranges.map(n=>r.state.sliceDoc(n.from,n.to)),selectedText:r.state.selection.ranges.some(n=>!n.empty)}),kr=R.YH.define(),Rs=[];function Is(r){var{value:n,selection:l,onChange:c,onStatistics:f,onCreateEditor:p,onUpdate:x,extensions:M=Rs,autoFocus:E,theme:q="light",height:K=null,minHeight:te=null,maxHeight:de=null,width:ke=null,minWidth:rt=null,maxWidth:Ye=null,placeholder:ui="",editable:Li=!0,readOnly:_t=!1,indentWithTab:Gi=!0,basicSetup:Di=!0,root:gi,initialState:ln}=r,[an,Bo]=(0,ae.useState)(),[yi,Wn]=(0,ae.useState)(),[Ns,Fs]=(0,ae.useState)(),El=J.Lz.theme({"&":{height:K,minHeight:te,maxHeight:de,width:ke,minWidth:rt,maxWidth:Ye},"& .cm-scroller":{height:"100% !important"}}),Eo=J.Lz.updateListener.of(Ti=>{if(Ti.docChanged&&typeof c=="function"&&!Ti.transactions.some(Zl=>Zl.annotation(kr))){var Sr=Ti.state.doc,Ro=Sr.toString();c(Ro,Ti)}f&&f(Es(Ti))}),Rl=rn({theme:q,editable:Li,readOnly:_t,placeholder:ui,indentWithTab:Gi,basicSetup:Di}),fs=[Eo,El,...Rl];return x&&typeof x=="function"&&fs.push(J.Lz.updateListener.of(x)),fs=fs.concat(M),(0,ae.useLayoutEffect)(()=>{if(an&&!Ns){var Ti={doc:n,selection:l,extensions:fs},Sr=ln?R.$t.fromJSON(ln.json,Ti,ln.fields):R.$t.create(Ti);if(Fs(Sr),!yi){var Ro=new J.Lz({state:Sr,parent:an,root:gi});Wn(Ro),p&&p(Ro,Sr)}}return()=>{yi&&(Fs(void 0),Wn(void 0))}},[an,Ns]),(0,ae.useEffect)(()=>{r.container&&Bo(r.container)},[r.container]),(0,ae.useEffect)(()=>()=>{yi&&(yi.destroy(),Wn(void 0))},[yi]),(0,ae.useEffect)(()=>{E&&yi&&yi.focus()},[E,yi]),(0,ae.useEffect)(()=>{yi&&yi.dispatch({effects:R.Pe.reconfigure.of(fs)})},[q,M,K,te,de,ke,rt,Ye,ui,Li,_t,Gi,Di,c,x]),(0,ae.useEffect)(()=>{if(n!==void 0){var Ti=yi?yi.state.doc.toString():"";yi&&n!==Ti&&yi.dispatch({changes:{from:0,to:Ti.length,insert:n||""},annotations:[kr.of(!0)]})}},[n,yi]),{state:Ns,setState:Fs,view:yi,setView:Wn,container:an,setContainer:Bo}}var Mn=Qe(31085),on=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],On=(0,ae.forwardRef)((r,n)=>{var{className:l,value:c="",selection:f,extensions:p=[],onChange:x,onStatistics:M,onCreateEditor:E,onUpdate:q,autoFocus:K,theme:te="light",height:de,minHeight:ke,maxHeight:rt,width:Ye,minWidth:ui,maxWidth:Li,basicSetup:_t,placeholder:Gi,indentWithTab:Di,editable:gi,readOnly:ln,root:an,initialState:Bo}=r,yi=(0,Be.A)(r,on),Wn=(0,ae.useRef)(null),{state:Ns,view:Fs,container:El,setContainer:Eo}=Is({root:an,value:c,autoFocus:K,theme:te,height:de,minHeight:ke,maxHeight:rt,width:Ye,minWidth:ui,maxWidth:Li,basicSetup:_t,placeholder:Gi,indentWithTab:Di,editable:gi,readOnly:ln,selection:f,onChange:x,onStatistics:M,onCreateEditor:E,onUpdate:q,extensions:p,initialState:Bo});(0,ae.useImperativeHandle)(n,()=>({editor:Wn.current,state:Ns,view:Fs}),[Wn,El,Ns,Fs]);var Rl=(0,ae.useCallback)(Ti=>{Wn.current=Ti,Eo(Ti)},[Eo]);if(typeof c!="string")throw new Error("value must be typeof string but got "+typeof c);var fs=typeof te=="string"?"cm-theme-"+te:"cm-theme";return(0,Mn.jsx)("div",(0,z.A)({ref:Rl,className:""+fs+(l?" "+l:"")},yi))});On.displayName="CodeMirror";const Dn=On},49913:(hn,ni,Qe)=>{Qe.d(ni,{DM:()=>Ee,_A:()=>Me,az:()=>we,pn:()=>Qt});var z=Qe(79066);let Be=0;class ae{constructor(oe,pe,Oe,fe){this.name=oe,this.set=pe,this.base=Oe,this.modified=fe,this.id=Be++}toString(){let{name:oe}=this;for(let pe of this.modified)pe.name&&(oe=`${pe.name}(${oe})`);return oe}static define(oe,pe){let Oe=typeof oe=="string"?oe:"?";if(oe instanceof ae&&(pe=oe),pe?.base)throw new Error("Can not derive from a modified tag");let fe=new ae(Oe,[],null,[]);if(fe.set.push(fe),pe)for(let Je of pe.set)fe.set.push(Je);return fe}static defineModifier(oe){let pe=new J(oe);return Oe=>Oe.modified.indexOf(pe)>-1?Oe:J.get(Oe.base||Oe,Oe.modified.concat(pe).sort((fe,Je)=>fe.id-Je.id))}}let R=0;class J{constructor(oe){this.name=oe,this.instances=[],this.id=R++}static get(oe,pe){if(!pe.length)return oe;let Oe=pe[0].instances.find(nt=>nt.base==oe&&Ae(pe,nt.modified));if(Oe)return Oe;let fe=[],Je=new ae(oe.name,fe,oe,pe);for(let nt of pe)nt.instances.push(Je);let dt=ze(pe);for(let nt of oe.set)if(!nt.modified.length)for(let Ve of dt)fe.push(J.get(nt,Ve));return Je}}function Ae(Ke,oe){return Ke.length==oe.length&&Ke.every((pe,Oe)=>pe==oe[Oe])}function ze(Ke){let oe=[[]];for(let pe=0;pe<Ke.length;pe++)for(let Oe=0,fe=oe.length;Oe<fe;Oe++)oe.push(oe[Oe].concat(Ke[pe]));return oe.sort((pe,Oe)=>Oe.length-pe.length)}function Qt(Ke){let oe=Object.create(null);for(let pe in Ke){let Oe=Ke[pe];Array.isArray(Oe)||(Oe=[Oe]);for(let fe of pe.split(" "))if(fe){let Je=[],dt=2,nt=fe;for(let et=0;;){if(nt=="..."&&et>0&&et+3==fe.length){dt=1;break}let gt=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(nt);if(!gt)throw new RangeError("Invalid path: "+fe);if(Je.push(gt[0]=="*"?"":gt[0][0]=='"'?JSON.parse(gt[0]):gt[0]),et+=gt[0].length,et==fe.length)break;let At=fe[et++];if(et==fe.length&&At=="!"){dt=0;break}if(At!="/")throw new RangeError("Invalid path: "+fe);nt=fe.slice(et)}let Ve=Je.length-1,Re=Je[Ve];if(!Re)throw new RangeError("Invalid path: "+fe);let Jt=new $e(Oe,dt,Ve>0?Je.slice(0,Ve):null);oe[Re]=Jt.sort(oe[Re])}}return it.add(oe)}const it=new z.uY;class $e{constructor(oe,pe,Oe,fe){this.tags=oe,this.mode=pe,this.context=Oe,this.next=fe}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(oe){return!oe||oe.depth<this.depth?(this.next=oe,this):(oe.next=this.sort(oe.next),oe)}get depth(){return this.context?this.context.length:0}}$e.empty=new $e([],2,null);function we(Ke,oe){let pe=Object.create(null);for(let Je of Ke)if(!Array.isArray(Je.tag))pe[Je.tag.id]=Je.class;else for(let dt of Je.tag)pe[dt.id]=Je.class;let{scope:Oe,all:fe=null}=oe||{};return{style:Je=>{let dt=fe;for(let nt of Je)for(let Ve of nt.set){let Re=pe[Ve.id];if(Re){dt=dt?dt+" "+Re:Re;break}}return dt},scope:Oe}}function Pe(Ke,oe){let pe=null;for(let Oe of Ke){let fe=Oe.style(oe);fe&&(pe=pe?pe+" "+fe:fe)}return pe}function Ee(Ke,oe,pe,Oe=0,fe=Ke.length){let Je=new Ne(Oe,Array.isArray(oe)?oe:[oe],pe);Je.highlightRange(Ke.cursor(),Oe,fe,"",Je.highlighters),Je.flush(fe)}function Se(Ke,oe,pe,Oe,fe,Je=0,dt=Ke.length){let nt=Je;function Ve(Re,Jt){if(!(Re<=nt)){for(let et=Ke.slice(nt,Re),gt=0;;){let At=et.indexOf(`
`,gt),bi=At<0?et.length:At;if(bi>gt&&Oe(et.slice(gt,bi),Jt),At<0)break;fe(),gt=At+1}nt=Re}}Ee(oe,pe,(Re,Jt,et)=>{Ve(Re,""),Ve(Jt,et)},Je,dt),Ve(dt,"")}class Ne{constructor(oe,pe,Oe){this.at=oe,this.highlighters=pe,this.span=Oe,this.class=""}startSpan(oe,pe){pe!=this.class&&(this.flush(oe),oe>this.at&&(this.at=oe),this.class=pe)}flush(oe){oe>this.at&&this.class&&this.span(this.at,oe,this.class)}highlightRange(oe,pe,Oe,fe,Je){let{type:dt,from:nt,to:Ve}=oe;if(nt>=Oe||Ve<=pe)return;dt.isTop&&(Je=this.highlighters.filter(At=>!At.scope||At.scope(dt)));let Re=fe,Jt=qe(oe)||$e.empty,et=Pe(Je,Jt.tags);if(et&&(Re&&(Re+=" "),Re+=et,Jt.mode==1&&(fe+=(fe?" ":"")+et)),this.startSpan(Math.max(pe,nt),Re),Jt.opaque)return;let gt=oe.tree&&oe.tree.prop(z.uY.mounted);if(gt&&gt.overlay){let At=oe.node.enter(gt.overlay[0].from+nt,1),bi=this.highlighters.filter(X=>!X.scope||X.scope(gt.tree.type)),xi=oe.firstChild();for(let X=0,k=nt;;X++){let O=X<gt.overlay.length?gt.overlay[X]:null,N=O?O.from+nt:Ve,L=Math.max(pe,k),$=Math.min(Oe,N);if(L<$&&xi)for(;oe.from<$&&(this.highlightRange(oe,L,$,fe,Je),this.startSpan(Math.min($,oe.to),Re),!(oe.to>=N||!oe.nextSibling())););if(!O||N>Oe)break;k=O.to+nt,k>pe&&(this.highlightRange(At.cursor(),Math.max(pe,O.from+nt),Math.min(Oe,k),"",bi),this.startSpan(Math.min(Oe,k),Re))}xi&&oe.parent()}else if(oe.firstChild()){gt&&(fe="");do if(!(oe.to<=pe)){if(oe.from>=Oe)break;this.highlightRange(oe,pe,Oe,fe,Je),this.startSpan(Math.min(Oe,oe.to),Re)}while(oe.nextSibling());oe.parent()}}}function qe(Ke){let oe=Ke.type.prop(it);for(;oe&&oe.context&&!Ke.matchContext(oe.context);)oe=oe.next;return oe||null}const he=ae.define,je=he(),ut=he(),Ot=he(ut),Rt=he(ut),at=he(),jt=he(at),Kt=he(at),wt=he(),Ct=he(wt),$t=he(),Tt=he(),di=he(),Yt=he(di),qt=he(),Me={comment:je,lineComment:he(je),blockComment:he(je),docComment:he(je),name:ut,variableName:he(ut),typeName:Ot,tagName:he(Ot),propertyName:Rt,attributeName:he(Rt),className:he(ut),labelName:he(ut),namespace:he(ut),macroName:he(ut),literal:at,string:jt,docString:he(jt),character:he(jt),attributeValue:he(jt),number:Kt,integer:he(Kt),float:he(Kt),bool:he(at),regexp:he(at),escape:he(at),color:he(at),url:he(at),keyword:$t,self:he($t),null:he($t),atom:he($t),unit:he($t),modifier:he($t),operatorKeyword:he($t),controlKeyword:he($t),definitionKeyword:he($t),moduleKeyword:he($t),operator:Tt,derefOperator:he(Tt),arithmeticOperator:he(Tt),logicOperator:he(Tt),bitwiseOperator:he(Tt),compareOperator:he(Tt),updateOperator:he(Tt),definitionOperator:he(Tt),typeOperator:he(Tt),controlOperator:he(Tt),punctuation:di,separator:he(di),bracket:Yt,angleBracket:he(Yt),squareBracket:he(Yt),paren:he(Yt),brace:he(Yt),content:wt,heading:Ct,heading1:he(Ct),heading2:he(Ct),heading3:he(Ct),heading4:he(Ct),heading5:he(Ct),heading6:he(Ct),contentSeparator:he(wt),list:he(wt),quote:he(wt),emphasis:he(wt),strong:he(wt),link:he(wt),monospace:he(wt),strikethrough:he(wt),inserted:he(),deleted:he(),changed:he(),invalid:he(),meta:qt,documentMeta:he(qt),annotation:he(qt),processingInstruction:he(qt),definition:ae.defineModifier("definition"),constant:ae.defineModifier("constant"),function:ae.defineModifier("function"),standard:ae.defineModifier("standard"),local:ae.defineModifier("local"),special:ae.defineModifier("special")};for(let Ke in Me){let oe=Me[Ke];oe instanceof ae&&(oe.name=Ke)}const Pt=we([{tag:Me.link,class:"tok-link"},{tag:Me.heading,class:"tok-heading"},{tag:Me.emphasis,class:"tok-emphasis"},{tag:Me.strong,class:"tok-strong"},{tag:Me.keyword,class:"tok-keyword"},{tag:Me.atom,class:"tok-atom"},{tag:Me.bool,class:"tok-bool"},{tag:Me.url,class:"tok-url"},{tag:Me.labelName,class:"tok-labelName"},{tag:Me.inserted,class:"tok-inserted"},{tag:Me.deleted,class:"tok-deleted"},{tag:Me.literal,class:"tok-literal"},{tag:Me.string,class:"tok-string"},{tag:Me.number,class:"tok-number"},{tag:[Me.regexp,Me.escape,Me.special(Me.string)],class:"tok-string2"},{tag:Me.variableName,class:"tok-variableName"},{tag:Me.local(Me.variableName),class:"tok-variableName tok-local"},{tag:Me.definition(Me.variableName),class:"tok-variableName tok-definition"},{tag:Me.special(Me.variableName),class:"tok-variableName2"},{tag:Me.definition(Me.propertyName),class:"tok-propertyName tok-definition"},{tag:Me.typeName,class:"tok-typeName"},{tag:Me.namespace,class:"tok-namespace"},{tag:Me.className,class:"tok-className"},{tag:Me.macroName,class:"tok-macroName"},{tag:Me.propertyName,class:"tok-propertyName"},{tag:Me.operator,class:"tok-operator"},{tag:Me.comment,class:"tok-comment"},{tag:Me.meta,class:"tok-meta"},{tag:Me.invalid,class:"tok-invalid"},{tag:Me.punctuation,class:"tok-punctuation"}])},57195:(hn,ni,Qe)=>{Qe.d(ni,{YH:()=>ti,Gu:()=>Pt,VR:()=>Ke,Je:()=>Nt,OF:()=>Ve,$t:()=>Ze,sj:()=>et,iR:()=>Me,Nb:()=>$,om:()=>Gt,vB:()=>ri,FB:()=>ai,Pe:()=>ue,sU:()=>O,EY:()=>Se,ZX:()=>Ue,vS:()=>Tt,Fh:()=>Yt,QR:()=>Vt,y$:()=>_i,zK:()=>wt,kn:()=>zn,MK:()=>di});let z=[],Be=[];(()=>{let B="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(h=>h?parseInt(h,36):1);for(let h=0,d=0;h<B.length;h++)(h%2?Be:z).push(d=d+B[h])})();function ae(B){if(B<768)return!1;for(let h=0,d=z.length;;){let y=h+d>>1;if(B<z[y])d=y;else if(B>=Be[y])h=y+1;else return!0;if(h==d)return!1}}function R(B){return B>=127462&&B<=127487}function J(B){for(let h=0;h<z.length;h++)if(Be[h]>B)return z[h]<=B;return!1}const Ae=8205;function ze(B,h,d=!0,y=!0){return(d?Qt:it)(B,h,y)}function Qt(B,h,d){if(h==B.length)return h;h&&we(B.charCodeAt(h))&&Pe(B.charCodeAt(h-1))&&h--;let y=$e(B,h);for(h+=Ee(y);h<B.length;){let v=$e(B,h);if(y==Ae||v==Ae||d&&ae(v))h+=Ee(v),y=v;else if(R(v)){let D=0,T=h-2;for(;T>=0&&R($e(B,T));)D++,T-=2;if(D%2==0)break;h+=2}else break}return h}function it(B,h,d){for(;h>0;){let y=Qt(B,h-2,d);if(y<h)return y;h--}return 0}function $e(B,h){let d=B.charCodeAt(h);if(!Pe(d)||h+1==B.length)return d;let y=B.charCodeAt(h+1);return we(y)?(d-55296<<10)+(y-56320)+65536:d}function we(B){return B>=56320&&B<57344}function Pe(B){return B>=55296&&B<56320}function Ee(B){return B<65536?1:2}class Se{lineAt(h){if(h<0||h>this.length)throw new RangeError(`Invalid position ${h} in document of length ${this.length}`);return this.lineInner(h,!1,1,0)}line(h){if(h<1||h>this.lines)throw new RangeError(`Invalid line number ${h} in ${this.lines}-line document`);return this.lineInner(h,!0,1,0)}replace(h,d,y){[h,d]=Kt(this,h,d);let v=[];return this.decompose(0,h,v,2),y.length&&y.decompose(0,y.length,v,3),this.decompose(d,this.length,v,1),qe.from(v,this.length-(d-h)+y.length)}append(h){return this.replace(this.length,this.length,h)}slice(h,d=this.length){[h,d]=Kt(this,h,d);let y=[];return this.decompose(h,d,y,0),qe.from(y,d-h)}eq(h){if(h==this)return!0;if(h.length!=this.length||h.lines!=this.lines)return!1;let d=this.scanIdentical(h,1),y=this.length-this.scanIdentical(h,-1),v=new Ot(this),D=new Ot(h);for(let T=d,H=d;;){if(v.next(T),D.next(T),T=0,v.lineBreak!=D.lineBreak||v.done!=D.done||v.value!=D.value)return!1;if(H+=v.value.length,v.done||H>=y)return!0}}iter(h=1){return new Ot(this,h)}iterRange(h,d=this.length){return new Rt(this,h,d)}iterLines(h,d){let y;if(h==null)y=this.iter();else{d==null&&(d=this.lines+1);let v=this.line(h).from;y=this.iterRange(v,Math.max(v,d==this.lines+1?this.length:d<=1?0:this.line(d-1).to))}return new at(y)}toString(){return this.sliceString(0)}toJSON(){let h=[];return this.flatten(h),h}constructor(){}static of(h){if(h.length==0)throw new RangeError("A document must have at least one line");return h.length==1&&!h[0]?Se.empty:h.length<=32?new Ne(h):qe.from(Ne.split(h,[]))}}class Ne extends Se{constructor(h,d=he(h)){super(),this.text=h,this.length=d}get lines(){return this.text.length}get children(){return null}lineInner(h,d,y,v){for(let D=0;;D++){let T=this.text[D],H=v+T.length;if((d?y:H)>=h)return new jt(v,H,y,T);v=H+1,y++}}decompose(h,d,y,v){let D=h<=0&&d>=this.length?this:new Ne(ut(this.text,h,d),Math.min(d,this.length)-Math.max(0,h));if(v&1){let T=y.pop(),H=je(D.text,T.text.slice(),0,D.length);if(H.length<=32)y.push(new Ne(H,T.length+D.length));else{let _=H.length>>1;y.push(new Ne(H.slice(0,_)),new Ne(H.slice(_)))}}else y.push(D)}replace(h,d,y){if(!(y instanceof Ne))return super.replace(h,d,y);[h,d]=Kt(this,h,d);let v=je(this.text,je(y.text,ut(this.text,0,h)),d),D=this.length+y.length-(d-h);return v.length<=32?new Ne(v,D):qe.from(Ne.split(v,[]),D)}sliceString(h,d=this.length,y=`
`){[h,d]=Kt(this,h,d);let v="";for(let D=0,T=0;D<=d&&T<this.text.length;T++){let H=this.text[T],_=D+H.length;D>h&&T&&(v+=y),h<_&&d>D&&(v+=H.slice(Math.max(0,h-D),d-D)),D=_+1}return v}flatten(h){for(let d of this.text)h.push(d)}scanIdentical(){return 0}static split(h,d){let y=[],v=-1;for(let D of h)y.push(D),v+=D.length+1,y.length==32&&(d.push(new Ne(y,v)),y=[],v=-1);return v>-1&&d.push(new Ne(y,v)),d}}class qe extends Se{constructor(h,d){super(),this.children=h,this.length=d,this.lines=0;for(let y of h)this.lines+=y.lines}lineInner(h,d,y,v){for(let D=0;;D++){let T=this.children[D],H=v+T.length,_=y+T.lines-1;if((d?_:H)>=h)return T.lineInner(h,d,y,v);v=H+1,y=_+1}}decompose(h,d,y,v){for(let D=0,T=0;T<=d&&D<this.children.length;D++){let H=this.children[D],_=T+H.length;if(h<=_&&d>=T){let Z=v&((T<=h?1:0)|(_>=d?2:0));T>=h&&_<=d&&!Z?y.push(H):H.decompose(h-T,d-T,y,Z)}T=_+1}}replace(h,d,y){if([h,d]=Kt(this,h,d),y.lines<this.lines)for(let v=0,D=0;v<this.children.length;v++){let T=this.children[v],H=D+T.length;if(h>=D&&d<=H){let _=T.replace(h-D,d-D,y),Z=this.lines-T.lines+_.lines;if(_.lines<Z>>4&&_.lines>Z>>6){let le=this.children.slice();return le[v]=_,new qe(le,this.length-(d-h)+y.length)}return super.replace(D,H,_)}D=H+1}return super.replace(h,d,y)}sliceString(h,d=this.length,y=`
`){[h,d]=Kt(this,h,d);let v="";for(let D=0,T=0;D<this.children.length&&T<=d;D++){let H=this.children[D],_=T+H.length;T>h&&D&&(v+=y),h<_&&d>T&&(v+=H.sliceString(h-T,d-T,y)),T=_+1}return v}flatten(h){for(let d of this.children)d.flatten(h)}scanIdentical(h,d){if(!(h instanceof qe))return 0;let y=0,[v,D,T,H]=d>0?[0,0,this.children.length,h.children.length]:[this.children.length-1,h.children.length-1,-1,-1];for(;;v+=d,D+=d){if(v==T||D==H)return y;let _=this.children[v],Z=h.children[D];if(_!=Z)return y+_.scanIdentical(Z,d);y+=_.length+1}}static from(h,d=h.reduce((y,v)=>y+v.length+1,-1)){let y=0;for(let ve of h)y+=ve.lines;if(y<32){let ve=[];for(let xt of h)xt.flatten(ve);return new Ne(ve,d)}let v=Math.max(32,y>>5),D=v<<1,T=v>>1,H=[],_=0,Z=-1,le=[];function ce(ve){let xt;if(ve.lines>D&&ve instanceof qe)for(let Et of ve.children)ce(Et);else ve.lines>T&&(_>T||!_)?(ye(),H.push(ve)):ve instanceof Ne&&_&&(xt=le[le.length-1])instanceof Ne&&ve.lines+xt.lines<=32?(_+=ve.lines,Z+=ve.length+1,le[le.length-1]=new Ne(xt.text.concat(ve.text),xt.length+1+ve.length)):(_+ve.lines>v&&ye(),_+=ve.lines,Z+=ve.length+1,le.push(ve))}function ye(){_!=0&&(H.push(le.length==1?le[0]:qe.from(le,Z)),Z=-1,_=le.length=0)}for(let ve of h)ce(ve);return ye(),H.length==1?H[0]:new qe(H,d)}}Se.empty=new Ne([""],0);function he(B){let h=-1;for(let d of B)h+=d.length+1;return h}function je(B,h,d=0,y=1e9){for(let v=0,D=0,T=!0;D<B.length&&v<=y;D++){let H=B[D],_=v+H.length;_>=d&&(_>y&&(H=H.slice(0,y-v)),v<d&&(H=H.slice(d-v)),T?(h[h.length-1]+=H,T=!1):h.push(H)),v=_+1}return h}function ut(B,h,d){return je(B,[""],h,d)}class Ot{constructor(h,d=1){this.dir=d,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[h],this.offsets=[d>0?1:(h instanceof Ne?h.text.length:h.children.length)<<1]}nextInner(h,d){for(this.done=this.lineBreak=!1;;){let y=this.nodes.length-1,v=this.nodes[y],D=this.offsets[y],T=D>>1,H=v instanceof Ne?v.text.length:v.children.length;if(T==(d>0?H:0)){if(y==0)return this.done=!0,this.value="",this;d>0&&this.offsets[y-1]++,this.nodes.pop(),this.offsets.pop()}else if((D&1)==(d>0?0:1)){if(this.offsets[y]+=d,h==0)return this.lineBreak=!0,this.value=`
`,this;h--}else if(v instanceof Ne){let _=v.text[T+(d<0?-1:0)];if(this.offsets[y]+=d,_.length>Math.max(0,h))return this.value=h==0?_:d>0?_.slice(h):_.slice(0,_.length-h),this;h-=_.length}else{let _=v.children[T+(d<0?-1:0)];h>_.length?(h-=_.length,this.offsets[y]+=d):(d<0&&this.offsets[y]--,this.nodes.push(_),this.offsets.push(d>0?1:(_ instanceof Ne?_.text.length:_.children.length)<<1))}}}next(h=0){return h<0&&(this.nextInner(-h,-this.dir),h=this.value.length),this.nextInner(h,this.dir)}}class Rt{constructor(h,d,y){this.value="",this.done=!1,this.cursor=new Ot(h,d>y?-1:1),this.pos=d>y?h.length:0,this.from=Math.min(d,y),this.to=Math.max(d,y)}nextInner(h,d){if(d<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;h+=Math.max(0,d<0?this.pos-this.to:this.from-this.pos);let y=d<0?this.pos-this.from:this.to-this.pos;h>y&&(h=y),y-=h;let{value:v}=this.cursor.next(h);return this.pos+=(v.length+h)*d,this.value=v.length<=y?v:d<0?v.slice(v.length-y):v.slice(0,y),this.done=!this.value,this}next(h=0){return h<0?h=Math.max(h,this.from-this.pos):h>0&&(h=Math.min(h,this.to-this.pos)),this.nextInner(h,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class at{constructor(h){this.inner=h,this.afterBreak=!0,this.value="",this.done=!1}next(h=0){let{done:d,lineBreak:y,value:v}=this.inner.next(h);return d&&this.afterBreak?(this.value="",this.afterBreak=!1):d?(this.done=!0,this.value=""):y?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=v,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Se.prototype[Symbol.iterator]=function(){return this.iter()},Ot.prototype[Symbol.iterator]=Rt.prototype[Symbol.iterator]=at.prototype[Symbol.iterator]=function(){return this});class jt{constructor(h,d,y,v){this.from=h,this.to=d,this.number=y,this.text=v}get length(){return this.to-this.from}}function Kt(B,h,d){return h=Math.max(0,Math.min(B.length,h)),[h,Math.max(h,Math.min(B.length,d))]}function wt(B,h,d=!0,y=!0){return ze(B,h,d,y)}function Ct(B){return B>=56320&&B<57344}function $t(B){return B>=55296&&B<56320}function Tt(B,h){let d=B.charCodeAt(h);if(!$t(d)||h+1==B.length)return d;let y=B.charCodeAt(h+1);return Ct(y)?(d-55296<<10)+(y-56320)+65536:d}function di(B){return B<=65535?String.fromCharCode(B):(B-=65536,String.fromCharCode((B>>10)+55296,(B&1023)+56320))}function Yt(B){return B<65536?1:2}const qt=/\r\n?|\n/;var Me=function(B){return B[B.Simple=0]="Simple",B[B.TrackDel=1]="TrackDel",B[B.TrackBefore=2]="TrackBefore",B[B.TrackAfter=3]="TrackAfter",B}(Me||(Me={}));class Pt{constructor(h){this.sections=h}get length(){let h=0;for(let d=0;d<this.sections.length;d+=2)h+=this.sections[d];return h}get newLength(){let h=0;for(let d=0;d<this.sections.length;d+=2){let y=this.sections[d+1];h+=y<0?this.sections[d]:y}return h}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(h){for(let d=0,y=0,v=0;d<this.sections.length;){let D=this.sections[d++],T=this.sections[d++];T<0?(h(y,v,D),v+=D):v+=T,y+=D}}iterChangedRanges(h,d=!1){Oe(this,h,d)}get invertedDesc(){let h=[];for(let d=0;d<this.sections.length;){let y=this.sections[d++],v=this.sections[d++];v<0?h.push(y,v):h.push(v,y)}return new Pt(h)}composeDesc(h){return this.empty?h:h.empty?this:Je(this,h)}mapDesc(h,d=!1){return h.empty?this:fe(this,h,d)}mapPos(h,d=-1,y=Me.Simple){let v=0,D=0;for(let T=0;T<this.sections.length;){let H=this.sections[T++],_=this.sections[T++],Z=v+H;if(_<0){if(Z>h)return D+(h-v);D+=H}else{if(y!=Me.Simple&&Z>=h&&(y==Me.TrackDel&&v<h&&Z>h||y==Me.TrackBefore&&v<h||y==Me.TrackAfter&&Z>h))return null;if(Z>h||Z==h&&d<0&&!H)return h==v||d<0?D:D+_;D+=_}v=Z}if(h>v)throw new RangeError(`Position ${h} is out of range for changeset of length ${v}`);return D}touchesRange(h,d=h){for(let y=0,v=0;y<this.sections.length&&v<=d;){let D=this.sections[y++],T=this.sections[y++],H=v+D;if(T>=0&&v<=d&&H>=h)return v<h&&H>d?"cover":!0;v=H}return!1}toString(){let h="";for(let d=0;d<this.sections.length;){let y=this.sections[d++],v=this.sections[d++];h+=(h?" ":"")+y+(v>=0?":"+v:"")}return h}toJSON(){return this.sections}static fromJSON(h){if(!Array.isArray(h)||h.length%2||h.some(d=>typeof d!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Pt(h)}static create(h){return new Pt(h)}}class Ke extends Pt{constructor(h,d){super(h),this.inserted=d}apply(h){if(this.length!=h.length)throw new RangeError("Applying change set to a document with the wrong length");return Oe(this,(d,y,v,D,T)=>h=h.replace(v,v+(y-d),T),!1),h}mapDesc(h,d=!1){return fe(this,h,d,!0)}invert(h){let d=this.sections.slice(),y=[];for(let v=0,D=0;v<d.length;v+=2){let T=d[v],H=d[v+1];if(H>=0){d[v]=H,d[v+1]=T;let _=v>>1;for(;y.length<_;)y.push(Se.empty);y.push(T?h.slice(D,D+T):Se.empty)}D+=T}return new Ke(d,y)}compose(h){return this.empty?h:h.empty?this:Je(this,h,!0)}map(h,d=!1){return h.empty?this:fe(this,h,d,!0)}iterChanges(h,d=!1){Oe(this,h,d)}get desc(){return Pt.create(this.sections)}filter(h){let d=[],y=[],v=[],D=new dt(this);e:for(let T=0,H=0;;){let _=T==h.length?1e9:h[T++];for(;H<_||H==_&&D.len==0;){if(D.done)break e;let le=Math.min(D.len,_-H);oe(v,le,-1);let ce=D.ins==-1?-1:D.off==0?D.ins:0;oe(d,le,ce),ce>0&&pe(y,d,D.text),D.forward(le),H+=le}let Z=h[T++];for(;H<Z;){if(D.done)break e;let le=Math.min(D.len,Z-H);oe(d,le,-1),oe(v,le,D.ins==-1?-1:D.off==0?D.ins:0),D.forward(le),H+=le}}return{changes:new Ke(d,y),filtered:Pt.create(v)}}toJSON(){let h=[];for(let d=0;d<this.sections.length;d+=2){let y=this.sections[d],v=this.sections[d+1];v<0?h.push(y):v==0?h.push([y]):h.push([y].concat(this.inserted[d>>1].toJSON()))}return h}static of(h,d,y){let v=[],D=[],T=0,H=null;function _(le=!1){if(!le&&!v.length)return;T<d&&oe(v,d-T,-1);let ce=new Ke(v,D);H=H?H.compose(ce.map(H)):ce,v=[],D=[],T=0}function Z(le){if(Array.isArray(le))for(let ce of le)Z(ce);else if(le instanceof Ke){if(le.length!=d)throw new RangeError(`Mismatched change set length (got ${le.length}, expected ${d})`);_(),H=H?H.compose(le.map(H)):le}else{let{from:ce,to:ye=ce,insert:ve}=le;if(ce>ye||ce<0||ye>d)throw new RangeError(`Invalid change range ${ce} to ${ye} (in doc of length ${d})`);let xt=ve?typeof ve=="string"?Se.of(ve.split(y||qt)):ve:Se.empty,Et=xt.length;if(ce==ye&&Et==0)return;ce<T&&_(),ce>T&&oe(v,ce-T,-1),oe(v,ye-ce,Et),pe(D,v,xt),T=ye}}return Z(h),_(!H),H}static empty(h){return new Ke(h?[h,-1]:[],[])}static fromJSON(h){if(!Array.isArray(h))throw new RangeError("Invalid JSON representation of ChangeSet");let d=[],y=[];for(let v=0;v<h.length;v++){let D=h[v];if(typeof D=="number")d.push(D,-1);else{if(!Array.isArray(D)||typeof D[0]!="number"||D.some((T,H)=>H&&typeof T!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(D.length==1)d.push(D[0],0);else{for(;y.length<v;)y.push(Se.empty);y[v]=Se.of(D.slice(1)),d.push(D[0],y[v].length)}}}return new Ke(d,y)}static createSet(h,d){return new Ke(h,d)}}function oe(B,h,d,y=!1){if(h==0&&d<=0)return;let v=B.length-2;v>=0&&d<=0&&d==B[v+1]?B[v]+=h:v>=0&&h==0&&B[v]==0?B[v+1]+=d:y?(B[v]+=h,B[v+1]+=d):B.push(h,d)}function pe(B,h,d){if(d.length==0)return;let y=h.length-2>>1;if(y<B.length)B[B.length-1]=B[B.length-1].append(d);else{for(;B.length<y;)B.push(Se.empty);B.push(d)}}function Oe(B,h,d){let y=B.inserted;for(let v=0,D=0,T=0;T<B.sections.length;){let H=B.sections[T++],_=B.sections[T++];if(_<0)v+=H,D+=H;else{let Z=v,le=D,ce=Se.empty;for(;Z+=H,le+=_,_&&y&&(ce=ce.append(y[T-2>>1])),!(d||T==B.sections.length||B.sections[T+1]<0);)H=B.sections[T++],_=B.sections[T++];h(v,Z,D,le,ce),v=Z,D=le}}}function fe(B,h,d,y=!1){let v=[],D=y?[]:null,T=new dt(B),H=new dt(h);for(let _=-1;;){if(T.done&&H.len||H.done&&T.len)throw new Error("Mismatched change set lengths");if(T.ins==-1&&H.ins==-1){let Z=Math.min(T.len,H.len);oe(v,Z,-1),T.forward(Z),H.forward(Z)}else if(H.ins>=0&&(T.ins<0||_==T.i||T.off==0&&(H.len<T.len||H.len==T.len&&!d))){let Z=H.len;for(oe(v,H.ins,-1);Z;){let le=Math.min(T.len,Z);T.ins>=0&&_<T.i&&T.len<=le&&(oe(v,0,T.ins),D&&pe(D,v,T.text),_=T.i),T.forward(le),Z-=le}H.next()}else if(T.ins>=0){let Z=0,le=T.len;for(;le;)if(H.ins==-1){let ce=Math.min(le,H.len);Z+=ce,le-=ce,H.forward(ce)}else if(H.ins==0&&H.len<le)le-=H.len,H.next();else break;oe(v,Z,_<T.i?T.ins:0),D&&_<T.i&&pe(D,v,T.text),_=T.i,T.forward(T.len-le)}else{if(T.done&&H.done)return D?Ke.createSet(v,D):Pt.create(v);throw new Error("Mismatched change set lengths")}}}function Je(B,h,d=!1){let y=[],v=d?[]:null,D=new dt(B),T=new dt(h);for(let H=!1;;){if(D.done&&T.done)return v?Ke.createSet(y,v):Pt.create(y);if(D.ins==0)oe(y,D.len,0,H),D.next();else if(T.len==0&&!T.done)oe(y,0,T.ins,H),v&&pe(v,y,T.text),T.next();else{if(D.done||T.done)throw new Error("Mismatched change set lengths");{let _=Math.min(D.len2,T.len),Z=y.length;if(D.ins==-1){let le=T.ins==-1?-1:T.off?0:T.ins;oe(y,_,le,H),v&&le&&pe(v,y,T.text)}else T.ins==-1?(oe(y,D.off?0:D.len,_,H),v&&pe(v,y,D.textBit(_))):(oe(y,D.off?0:D.len,T.off?0:T.ins,H),v&&!T.off&&pe(v,y,T.text));H=(D.ins>_||T.ins>=0&&T.len>_)&&(H||y.length>Z),D.forward2(_),T.forward(_)}}}}class dt{constructor(h){this.set=h,this.i=0,this.next()}next(){let{sections:h}=this.set;this.i<h.length?(this.len=h[this.i++],this.ins=h[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:h}=this.set,d=this.i-2>>1;return d>=h.length?Se.empty:h[d]}textBit(h){let{inserted:d}=this.set,y=this.i-2>>1;return y>=d.length&&!h?Se.empty:d[y].slice(this.off,h==null?void 0:this.off+h)}forward(h){h==this.len?this.next():(this.len-=h,this.off+=h)}forward2(h){this.ins==-1?this.forward(h):h==this.ins?this.next():(this.ins-=h,this.off+=h)}}class nt{constructor(h,d,y){this.from=h,this.to=d,this.flags=y}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let h=this.flags&7;return h==7?null:h}get goalColumn(){let h=this.flags>>6;return h==16777215?void 0:h}map(h,d=-1){let y,v;return this.empty?y=v=h.mapPos(this.from,d):(y=h.mapPos(this.from,1),v=h.mapPos(this.to,-1)),y==this.from&&v==this.to?this:new nt(y,v,this.flags)}extend(h,d=h){if(h<=this.anchor&&d>=this.anchor)return Ve.range(h,d);let y=Math.abs(h-this.anchor)>Math.abs(d-this.anchor)?h:d;return Ve.range(this.anchor,y)}eq(h,d=!1){return this.anchor==h.anchor&&this.head==h.head&&(!d||!this.empty||this.assoc==h.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(h){if(!h||typeof h.anchor!="number"||typeof h.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Ve.range(h.anchor,h.head)}static create(h,d,y){return new nt(h,d,y)}}class Ve{constructor(h,d){this.ranges=h,this.mainIndex=d}map(h,d=-1){return h.empty?this:Ve.create(this.ranges.map(y=>y.map(h,d)),this.mainIndex)}eq(h,d=!1){if(this.ranges.length!=h.ranges.length||this.mainIndex!=h.mainIndex)return!1;for(let y=0;y<this.ranges.length;y++)if(!this.ranges[y].eq(h.ranges[y],d))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Ve([this.main],0)}addRange(h,d=!0){return Ve.create([h].concat(this.ranges),d?0:this.mainIndex+1)}replaceRange(h,d=this.mainIndex){let y=this.ranges.slice();return y[d]=h,Ve.create(y,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(h=>h.toJSON()),main:this.mainIndex}}static fromJSON(h){if(!h||!Array.isArray(h.ranges)||typeof h.main!="number"||h.main>=h.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Ve(h.ranges.map(d=>nt.fromJSON(d)),h.main)}static single(h,d=h){return new Ve([Ve.range(h,d)],0)}static create(h,d=0){if(h.length==0)throw new RangeError("A selection needs at least one range");for(let y=0,v=0;v<h.length;v++){let D=h[v];if(D.empty?D.from<=y:D.from<y)return Ve.normalized(h.slice(),d);y=D.to}return new Ve(h,d)}static cursor(h,d=0,y,v){return nt.create(h,h,(d==0?0:d<0?8:16)|(y==null?7:Math.min(6,y))|(v??16777215)<<6)}static range(h,d,y,v){let D=(y??16777215)<<6|(v==null?7:Math.min(6,v));return d<h?nt.create(d,h,48|D):nt.create(h,d,(d>h?8:0)|D)}static normalized(h,d=0){let y=h[d];h.sort((v,D)=>v.from-D.from),d=h.indexOf(y);for(let v=1;v<h.length;v++){let D=h[v],T=h[v-1];if(D.empty?D.from<=T.to:D.from<T.to){let H=T.from,_=Math.max(D.to,T.to);v<=d&&d--,h.splice(--v,2,D.anchor>D.head?Ve.range(_,H):Ve.range(H,_))}}return new Ve(h,d)}}function Re(B,h){for(let d of B.ranges)if(d.to>h)throw new RangeError("Selection points outside of document")}let Jt=0;class et{constructor(h,d,y,v,D){this.combine=h,this.compareInput=d,this.compare=y,this.isStatic=v,this.id=Jt++,this.default=h([]),this.extensions=typeof D=="function"?D(this):D}get reader(){return this}static define(h={}){return new et(h.combine||(d=>d),h.compareInput||((d,y)=>d===y),h.compare||(h.combine?(d,y)=>d===y:gt),!!h.static,h.enables)}of(h){return new At([],this,0,h)}compute(h,d){if(this.isStatic)throw new Error("Can't compute a static facet");return new At(h,this,1,d)}computeN(h,d){if(this.isStatic)throw new Error("Can't compute a static facet");return new At(h,this,2,d)}from(h,d){return d||(d=y=>y),this.compute([h],y=>d(y.field(h)))}}function gt(B,h){return B==h||B.length==h.length&&B.every((d,y)=>d===h[y])}class At{constructor(h,d,y,v){this.dependencies=h,this.facet=d,this.type=y,this.value=v,this.id=Jt++}dynamicSlot(h){var d;let y=this.value,v=this.facet.compareInput,D=this.id,T=h[D]>>1,H=this.type==2,_=!1,Z=!1,le=[];for(let ce of this.dependencies)ce=="doc"?_=!0:ce=="selection"?Z=!0:(((d=h[ce.id])!==null&&d!==void 0?d:1)&1)==0&&le.push(h[ce.id]);return{create(ce){return ce.values[T]=y(ce),1},update(ce,ye){if(_&&ye.docChanged||Z&&(ye.docChanged||ye.selection)||xi(ce,le)){let ve=y(ce);if(H?!bi(ve,ce.values[T],v):!v(ve,ce.values[T]))return ce.values[T]=ve,1}return 0},reconfigure:(ce,ye)=>{let ve,xt=ye.config.address[D];if(xt!=null){let Et=_e(ye,xt);if(this.dependencies.every(mt=>mt instanceof et?ye.facet(mt)===ce.facet(mt):mt instanceof O?ye.field(mt,!1)==ce.field(mt,!1):!0)||(H?bi(ve=y(ce),Et,v):v(ve=y(ce),Et)))return ce.values[T]=Et,0}else ve=y(ce);return ce.values[T]=ve,1}}}}function bi(B,h,d){if(B.length!=h.length)return!1;for(let y=0;y<B.length;y++)if(!d(B[y],h[y]))return!1;return!0}function xi(B,h){let d=!1;for(let y of h)Ie(B,y)&1&&(d=!0);return d}function X(B,h,d){let y=d.map(_=>B[_.id]),v=d.map(_=>_.type),D=y.filter(_=>!(_&1)),T=B[h.id]>>1;function H(_){let Z=[];for(let le=0;le<y.length;le++){let ce=_e(_,y[le]);if(v[le]==2)for(let ye of ce)Z.push(ye);else Z.push(ce)}return h.combine(Z)}return{create(_){for(let Z of y)Ie(_,Z);return _.values[T]=H(_),1},update(_,Z){if(!xi(_,D))return 0;let le=H(_);return h.compare(le,_.values[T])?0:(_.values[T]=le,1)},reconfigure(_,Z){let le=xi(_,y),ce=Z.config.facets[h.id],ye=Z.facet(h);if(ce&&!le&&gt(d,ce))return _.values[T]=ye,0;let ve=H(_);return h.compare(ve,ye)?(_.values[T]=ye,0):(_.values[T]=ve,1)}}}const k=et.define({static:!0});class O{constructor(h,d,y,v,D){this.id=h,this.createF=d,this.updateF=y,this.compareF=v,this.spec=D,this.provides=void 0}static define(h){let d=new O(Jt++,h.create,h.update,h.compare||((y,v)=>y===v),h);return h.provide&&(d.provides=h.provide(d)),d}create(h){let d=h.facet(k).find(y=>y.field==this);return(d?.create||this.createF)(h)}slot(h){let d=h[this.id]>>1;return{create:y=>(y.values[d]=this.create(y),1),update:(y,v)=>{let D=y.values[d],T=this.updateF(D,v);return this.compareF(D,T)?0:(y.values[d]=T,1)},reconfigure:(y,v)=>{let D=y.facet(k),T=v.facet(k),H;return(H=D.find(_=>_.field==this))&&H!=T.find(_=>_.field==this)?(y.values[d]=H.create(y),1):v.config.address[this.id]!=null?(y.values[d]=v.field(this),0):(y.values[d]=this.create(y),1)}}}init(h){return[this,k.of({field:this,create:h})]}get extension(){return this}}const N={lowest:4,low:3,default:2,high:1,highest:0};function L(B){return h=>new G(h,B)}const $={highest:L(N.highest),high:L(N.high),default:L(N.default),low:L(N.low),lowest:L(N.lowest)};class G{constructor(h,d){this.inner=h,this.prec=d}}class Q{of(h){return new me(this,h)}reconfigure(h){return Q.reconfigure.of({compartment:this,extension:h})}get(h){return h.config.compartments.get(this)}}class me{constructor(h,d){this.compartment=h,this.inner=d}}class be{constructor(h,d,y,v,D,T){for(this.base=h,this.compartments=d,this.dynamicSlots=y,this.address=v,this.staticValues=D,this.facets=T,this.statusTemplate=[];this.statusTemplate.length<y.length;)this.statusTemplate.push(0)}staticFacet(h){let d=this.address[h.id];return d==null?h.default:this.staticValues[d>>1]}static resolve(h,d,y){let v=[],D=Object.create(null),T=new Map;for(let ye of xe(h,d,T))ye instanceof O?v.push(ye):(D[ye.facet.id]||(D[ye.facet.id]=[])).push(ye);let H=Object.create(null),_=[],Z=[];for(let ye of v)H[ye.id]=Z.length<<1,Z.push(ve=>ye.slot(ve));let le=y?.config.facets;for(let ye in D){let ve=D[ye],xt=ve[0].facet,Et=le&&le[ye]||[];if(ve.every(mt=>mt.type==0))if(H[xt.id]=_.length<<1|1,gt(Et,ve))_.push(y.facet(xt));else{let mt=xt.combine(ve.map(Ji=>Ji.value));_.push(y&&xt.compare(mt,y.facet(xt))?y.facet(xt):mt)}else{for(let mt of ve)mt.type==0?(H[mt.id]=_.length<<1|1,_.push(mt.value)):(H[mt.id]=Z.length<<1,Z.push(Ji=>mt.dynamicSlot(Ji)));H[xt.id]=Z.length<<1,Z.push(mt=>X(mt,xt,ve))}}let ce=Z.map(ye=>ye(H));return new be(h,T,ce,H,_,D)}}function xe(B,h,d){let y=[[],[],[],[],[]],v=new Map;function D(T,H){let _=v.get(T);if(_!=null){if(_<=H)return;let Z=y[_].indexOf(T);Z>-1&&y[_].splice(Z,1),T instanceof me&&d.delete(T.compartment)}if(v.set(T,H),Array.isArray(T))for(let Z of T)D(Z,H);else if(T instanceof me){if(d.has(T.compartment))throw new RangeError("Duplicate use of compartment in extensions");let Z=h.get(T.compartment)||T.inner;d.set(T.compartment,Z),D(Z,H)}else if(T instanceof G)D(T.inner,T.prec);else if(T instanceof O)y[H].push(T),T.provides&&D(T.provides,H);else if(T instanceof At)y[H].push(T),T.facet.extensions&&D(T.facet.extensions,N.default);else{let Z=T.extension;if(!Z)throw new Error(`Unrecognized extension value in extension set (${T}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);D(Z,H)}}return D(B,N.default),y.reduce((T,H)=>T.concat(H))}function Ie(B,h){if(h&1)return 2;let d=h>>1,y=B.status[d];if(y==4)throw new Error("Cyclic dependency between fields and/or facets");if(y&2)return y;B.status[d]=4;let v=B.computeSlot(B,B.config.dynamicSlots[d]);return B.status[d]=2|v}function _e(B,h){return h&1?B.config.staticValues[h>>1]:B.values[h>>1]}const ot=et.define(),vt=et.define({combine:B=>B.some(h=>h),static:!0}),It=et.define({combine:B=>B.length?B[0]:void 0,static:!0}),Wt=et.define(),ei=et.define(),Lt=et.define(),kt=et.define({combine:B=>B.length?B[0]:!1});class ti{constructor(h,d){this.type=h,this.value=d}static define(){return new st}}class st{of(h){return new ti(this,h)}}class tt{constructor(h){this.map=h}of(h){return new ue(this,h)}}class ue{constructor(h,d){this.type=h,this.value=d}map(h){let d=this.type.map(this.value,h);return d===void 0?void 0:d==this.value?this:new ue(this.type,d)}is(h){return this.type==h}static define(h={}){return new tt(h.map||(d=>d))}static mapEffects(h,d){if(!h.length)return h;let y=[];for(let v of h){let D=v.map(d);D&&y.push(D)}return y}}ue.reconfigure=ue.define(),ue.appendConfig=ue.define();class Ue{constructor(h,d,y,v,D,T){this.startState=h,this.changes=d,this.selection=y,this.effects=v,this.annotations=D,this.scrollIntoView=T,this._doc=null,this._state=null,y&&Re(y,d.newLength),D.some(H=>H.type==Ue.time)||(this.annotations=D.concat(Ue.time.of(Date.now())))}static create(h,d,y,v,D,T){return new Ue(h,d,y,v,D,T)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(h){for(let d of this.annotations)if(d.type==h)return d.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(h){let d=this.annotation(Ue.userEvent);return!!(d&&(d==h||d.length>h.length&&d.slice(0,h.length)==h&&d[h.length]=="."))}}Ue.time=ti.define(),Ue.userEvent=ti.define(),Ue.addToHistory=ti.define(),Ue.remote=ti.define();function lt(B,h){let d=[];for(let y=0,v=0;;){let D,T;if(y<B.length&&(v==h.length||h[v]>=B[y]))D=B[y++],T=B[y++];else if(v<h.length)D=h[v++],T=h[v++];else return d;!d.length||d[d.length-1]<D?d.push(D,T):d[d.length-1]<T&&(d[d.length-1]=T)}}function ct(B,h,d){var y;let v,D,T;return d?(v=h.changes,D=Ke.empty(h.changes.length),T=B.changes.compose(h.changes)):(v=h.changes.map(B.changes),D=B.changes.mapDesc(h.changes,!0),T=B.changes.compose(v)),{changes:T,selection:h.selection?h.selection.map(D):(y=B.selection)===null||y===void 0?void 0:y.map(v),effects:ue.mapEffects(B.effects,v).concat(ue.mapEffects(h.effects,D)),annotations:B.annotations.length?B.annotations.concat(h.annotations):h.annotations,scrollIntoView:B.scrollIntoView||h.scrollIntoView}}function Xe(B,h,d){let y=h.selection,v=Ut(h.annotations);return h.userEvent&&(v=v.concat(Ue.userEvent.of(h.userEvent))),{changes:h.changes instanceof Ke?h.changes:Ke.of(h.changes||[],d,B.facet(It)),selection:y&&(y instanceof Ve?y:Ve.single(y.anchor,y.head)),effects:Ut(h.effects),annotations:v,scrollIntoView:!!h.scrollIntoView}}function Fe(B,h,d){let y=Xe(B,h.length?h[0]:{},B.doc.length);h.length&&h[0].filter===!1&&(d=!1);for(let D=1;D<h.length;D++){h[D].filter===!1&&(d=!1);let T=!!h[D].sequential;y=ct(y,Xe(B,h[D],T?y.changes.newLength:B.doc.length),T)}let v=Ue.create(B,y.changes,y.selection,y.effects,y.annotations,y.scrollIntoView);return Ge(d?ft(v):v)}function ft(B){let h=B.startState,d=!0;for(let v of h.facet(Wt)){let D=v(B);if(D===!1){d=!1;break}Array.isArray(D)&&(d=d===!0?D:lt(d,D))}if(d!==!0){let v,D;if(d===!1)D=B.changes.invertedDesc,v=Ke.empty(h.doc.length);else{let T=B.changes.filter(d);v=T.changes,D=T.filtered.mapDesc(T.changes).invertedDesc}B=Ue.create(h,v,B.selection&&B.selection.map(D),ue.mapEffects(B.effects,D),B.annotations,B.scrollIntoView)}let y=h.facet(ei);for(let v=y.length-1;v>=0;v--){let D=y[v](B);D instanceof Ue?B=D:Array.isArray(D)&&D.length==1&&D[0]instanceof Ue?B=D[0]:B=Fe(h,Ut(D),!1)}return B}function Ge(B){let h=B.startState,d=h.facet(Lt),y=B;for(let v=d.length-1;v>=0;v--){let D=d[v](B);D&&Object.keys(D).length&&(y=ct(y,Xe(h,D,B.changes.newLength),!0))}return y==B?B:Ue.create(h,B.changes,B.selection,y.effects,y.annotations,y.scrollIntoView)}const pt=[];function Ut(B){return B==null?pt:Array.isArray(B)?B:[B]}var Nt=function(B){return B[B.Word=0]="Word",B[B.Space=1]="Space",B[B.Other=2]="Other",B}(Nt||(Nt={}));const si=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let zt;try{zt=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function yt(B){if(zt)return zt.test(B);for(let h=0;h<B.length;h++){let d=B[h];if(/\w/.test(d)||d>"\x80"&&(d.toUpperCase()!=d.toLowerCase()||si.test(d)))return!0}return!1}function Bt(B){return h=>{if(!/\S/.test(h))return Nt.Space;if(yt(h))return Nt.Word;for(let d=0;d<B.length;d++)if(h.indexOf(B[d])>-1)return Nt.Word;return Nt.Other}}class Ze{constructor(h,d,y,v,D,T){this.config=h,this.doc=d,this.selection=y,this.values=v,this.status=h.statusTemplate.slice(),this.computeSlot=D,T&&(T._state=this);for(let H=0;H<this.config.dynamicSlots.length;H++)Ie(this,H<<1);this.computeSlot=null}field(h,d=!0){let y=this.config.address[h.id];if(y==null){if(d)throw new RangeError("Field is not present in this state");return}return Ie(this,y),_e(this,y)}update(...h){return Fe(this,h,!0)}applyTransaction(h){let d=this.config,{base:y,compartments:v}=d;for(let H of h.effects)H.is(Q.reconfigure)?(d&&(v=new Map,d.compartments.forEach((_,Z)=>v.set(Z,_)),d=null),v.set(H.value.compartment,H.value.extension)):H.is(ue.reconfigure)?(d=null,y=H.value):H.is(ue.appendConfig)&&(d=null,y=Ut(y).concat(H.value));let D;d?D=h.startState.values.slice():(d=be.resolve(y,v,this),D=new Ze(d,this.doc,this.selection,d.dynamicSlots.map(()=>null),(_,Z)=>Z.reconfigure(_,this),null).values);let T=h.startState.facet(vt)?h.newSelection:h.newSelection.asSingle();new Ze(d,h.newDoc,T,D,(H,_)=>_.update(H,h),h)}replaceSelection(h){return typeof h=="string"&&(h=this.toText(h)),this.changeByRange(d=>({changes:{from:d.from,to:d.to,insert:h},range:Ve.cursor(d.from+h.length)}))}changeByRange(h){let d=this.selection,y=h(d.ranges[0]),v=this.changes(y.changes),D=[y.range],T=Ut(y.effects);for(let H=1;H<d.ranges.length;H++){let _=h(d.ranges[H]),Z=this.changes(_.changes),le=Z.map(v);for(let ye=0;ye<H;ye++)D[ye]=D[ye].map(le);let ce=v.mapDesc(Z,!0);D.push(_.range.map(ce)),v=v.compose(le),T=ue.mapEffects(T,le).concat(ue.mapEffects(Ut(_.effects),ce))}return{changes:v,selection:Ve.create(D,d.mainIndex),effects:T}}changes(h=[]){return h instanceof Ke?h:Ke.of(h,this.doc.length,this.facet(Ze.lineSeparator))}toText(h){return Se.of(h.split(this.facet(Ze.lineSeparator)||qt))}sliceDoc(h=0,d=this.doc.length){return this.doc.sliceString(h,d,this.lineBreak)}facet(h){let d=this.config.address[h.id];return d==null?h.default:(Ie(this,d),_e(this,d))}toJSON(h){let d={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(h)for(let y in h){let v=h[y];v instanceof O&&this.config.address[v.id]!=null&&(d[y]=v.spec.toJSON(this.field(h[y]),this))}return d}static fromJSON(h,d={},y){if(!h||typeof h.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let v=[];if(y){for(let D in y)if(Object.prototype.hasOwnProperty.call(h,D)){let T=y[D],H=h[D];v.push(T.init(_=>T.spec.fromJSON(H,_)))}}return Ze.create({doc:h.doc,selection:Ve.fromJSON(h.selection),extensions:d.extensions?v.concat([d.extensions]):v})}static create(h={}){let d=be.resolve(h.extensions||[],new Map),y=h.doc instanceof Se?h.doc:Se.of((h.doc||"").split(d.staticFacet(Ze.lineSeparator)||qt)),v=h.selection?h.selection instanceof Ve?h.selection:Ve.single(h.selection.anchor,h.selection.head):Ve.single(0);return Re(v,y.length),d.staticFacet(vt)||(v=v.asSingle()),new Ze(d,y,v,d.dynamicSlots.map(()=>null),(D,T)=>T.create(D),null)}get tabSize(){return this.facet(Ze.tabSize)}get lineBreak(){return this.facet(Ze.lineSeparator)||`
`}get readOnly(){return this.facet(kt)}phrase(h,...d){for(let y of this.facet(Ze.phrases))if(Object.prototype.hasOwnProperty.call(y,h)){h=y[h];break}return d.length&&(h=h.replace(/\$(\$|\d*)/g,(y,v)=>{if(v=="$")return"$";let D=+(v||1);return!D||D>d.length?y:d[D-1]})),h}languageDataAt(h,d,y=-1){let v=[];for(let D of this.facet(ot))for(let T of D(this,d,y))Object.prototype.hasOwnProperty.call(T,h)&&v.push(T[h]);return v}charCategorizer(h){return Bt(this.languageDataAt("wordChars",h).join(""))}wordAt(h){let{text:d,from:y,length:v}=this.doc.lineAt(h),D=this.charCategorizer(h),T=h-y,H=h-y;for(;T>0;){let _=wt(d,T,!1);if(D(d.slice(_,T))!=Nt.Word)break;T=_}for(;H<v;){let _=wt(d,H);if(D(d.slice(H,_))!=Nt.Word)break;H=_}return T==H?null:Ve.range(T+y,H+y)}}Ze.allowMultipleSelections=vt,Ze.tabSize=et.define({combine:B=>B.length?B[0]:4}),Ze.lineSeparator=It,Ze.readOnly=kt,Ze.phrases=et.define({compare(B,h){let d=Object.keys(B),y=Object.keys(h);return d.length==y.length&&d.every(v=>B[v]==h[v])}}),Ze.languageData=ot,Ze.changeFilter=Wt,Ze.transactionFilter=ei,Ze.transactionExtender=Lt,Q.reconfigure=ue.define();function Vt(B,h,d={}){let y={};for(let v of B)for(let D of Object.keys(v)){let T=v[D],H=y[D];if(H===void 0)y[D]=T;else if(!(H===T||T===void 0))if(Object.hasOwnProperty.call(d,D))y[D]=d[D](H,T);else throw new Error("Config merge conflict for field "+D)}for(let v in h)y[v]===void 0&&(y[v]=h[v]);return y}class ai{eq(h){return this==h}range(h,d=h){return pi.create(h,d,this)}}ai.prototype.startSide=ai.prototype.endSide=0,ai.prototype.point=!1,ai.prototype.mapMode=Me.TrackDel;class pi{constructor(h,d,y){this.from=h,this.to=d,this.value=y}static create(h,d,y){return new pi(h,d,y)}}function wi(B,h){return B.from-h.from||B.value.startSide-h.value.startSide}class ii{constructor(h,d,y,v){this.from=h,this.to=d,this.value=y,this.maxPoint=v}get length(){return this.to[this.to.length-1]}findIndex(h,d,y,v=0){let D=y?this.to:this.from;for(let T=v,H=D.length;;){if(T==H)return T;let _=T+H>>1,Z=D[_]-h||(y?this.value[_].endSide:this.value[_].startSide)-d;if(_==T)return Z>=0?T:H;Z>=0?H=_:T=_+1}}between(h,d,y,v){for(let D=this.findIndex(d,-1e9,!0),T=this.findIndex(y,1e9,!1,D);D<T;D++)if(v(this.from[D]+h,this.to[D]+h,this.value[D])===!1)return!1}map(h,d){let y=[],v=[],D=[],T=-1,H=-1;for(let _=0;_<this.value.length;_++){let Z=this.value[_],le=this.from[_]+h,ce=this.to[_]+h,ye,ve;if(le==ce){let xt=d.mapPos(le,Z.startSide,Z.mapMode);if(xt==null||(ye=ve=xt,Z.startSide!=Z.endSide&&(ve=d.mapPos(le,Z.endSide),ve<ye)))continue}else if(ye=d.mapPos(le,Z.startSide),ve=d.mapPos(ce,Z.endSide),ye>ve||ye==ve&&Z.startSide>0&&Z.endSide<=0)continue;(ve-ye||Z.endSide-Z.startSide)<0||(T<0&&(T=ye),Z.point&&(H=Math.max(H,ve-ye)),y.push(Z),v.push(ye-T),D.push(ve-T))}return{mapped:y.length?new ii(v,D,y,H):null,pos:T}}}class Gt{constructor(h,d,y,v){this.chunkPos=h,this.chunk=d,this.nextLayer=y,this.maxPoint=v}static create(h,d,y,v){return new Gt(h,d,y,v)}get length(){let h=this.chunk.length-1;return h<0?0:Math.max(this.chunkEnd(h),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let h=this.nextLayer.size;for(let d of this.chunk)h+=d.value.length;return h}chunkEnd(h){return this.chunkPos[h]+this.chunk[h].length}update(h){let{add:d=[],sort:y=!1,filterFrom:v=0,filterTo:D=this.length}=h,T=h.filter;if(d.length==0&&!T)return this;if(y&&(d=d.slice().sort(wi)),this.isEmpty)return d.length?Gt.of(d):this;let H=new bt(this,null,-1).goto(0),_=0,Z=[],le=new ri;for(;H.value||_<d.length;)if(_<d.length&&(H.from-d[_].from||H.startSide-d[_].value.startSide)>=0){let ce=d[_++];le.addInner(ce.from,ce.to,ce.value)||Z.push(ce)}else H.rangeIndex==1&&H.chunkIndex<this.chunk.length&&(_==d.length||this.chunkEnd(H.chunkIndex)<d[_].from)&&(!T||v>this.chunkEnd(H.chunkIndex)||D<this.chunkPos[H.chunkIndex])&&le.addChunk(this.chunkPos[H.chunkIndex],this.chunk[H.chunkIndex])?H.nextChunk():((!T||v>H.to||D<H.from||T(H.from,H.to,H.value))&&(le.addInner(H.from,H.to,H.value)||Z.push(pi.create(H.from,H.to,H.value))),H.next());return le.finishInner(this.nextLayer.isEmpty&&!Z.length?Gt.empty:this.nextLayer.update({add:Z,filter:T,filterFrom:v,filterTo:D}))}map(h){if(h.empty||this.isEmpty)return this;let d=[],y=[],v=-1;for(let T=0;T<this.chunk.length;T++){let H=this.chunkPos[T],_=this.chunk[T],Z=h.touchesRange(H,H+_.length);if(Z===!1)v=Math.max(v,_.maxPoint),d.push(_),y.push(h.mapPos(H));else if(Z===!0){let{mapped:le,pos:ce}=_.map(H,h);le&&(v=Math.max(v,le.maxPoint),d.push(le),y.push(ce))}}let D=this.nextLayer.map(h);return d.length==0?D:new Gt(y,d,D||Gt.empty,v)}between(h,d,y){if(!this.isEmpty){for(let v=0;v<this.chunk.length;v++){let D=this.chunkPos[v],T=this.chunk[v];if(d>=D&&h<=D+T.length&&T.between(D,h-D,d-D,y)===!1)return}this.nextLayer.between(h,d,y)}}iter(h=0){return Ft.from([this]).goto(h)}get isEmpty(){return this.nextLayer==this}static iter(h,d=0){return Ft.from(h).goto(d)}static compare(h,d,y,v,D=-1){let T=h.filter(ce=>ce.maxPoint>0||!ce.isEmpty&&ce.maxPoint>=D),H=d.filter(ce=>ce.maxPoint>0||!ce.isEmpty&&ce.maxPoint>=D),_=cn(T,H,y),Z=new Bi(T,_,D),le=new Bi(H,_,D);y.iterGaps((ce,ye,ve)=>Vi(Z,ce,le,ye,ve,v)),y.empty&&y.length==0&&Vi(Z,0,le,0,0,v)}static eq(h,d,y=0,v){v==null&&(v=999999999);let D=h.filter(le=>!le.isEmpty&&d.indexOf(le)<0),T=d.filter(le=>!le.isEmpty&&h.indexOf(le)<0);if(D.length!=T.length)return!1;if(!D.length)return!0;let H=cn(D,T),_=new Bi(D,H,0).goto(y),Z=new Bi(T,H,0).goto(y);for(;;){if(_.to!=Z.to||!Yi(_.active,Z.active)||_.point&&(!Z.point||!_.point.eq(Z.point)))return!1;if(_.to>v)return!0;_.next(),Z.next()}}static spans(h,d,y,v,D=-1){let T=new Bi(h,null,D).goto(d),H=d,_=T.openStart;for(;;){let Z=Math.min(T.to,y);if(T.point){let le=T.activeForPoint(T.to),ce=T.pointFrom<d?le.length+1:T.point.startSide<0?le.length:Math.min(le.length,_);v.point(H,Z,T.point,le,ce,T.pointRank),_=Math.min(T.openEnd(Z),le.length)}else Z>H&&(v.span(H,Z,T.active,_),_=T.openEnd(Z));if(T.to>y)return _+(T.point&&T.to>y?1:0);H=T.to,T.next()}}static of(h,d=!1){let y=new ri;for(let v of h instanceof pi?[h]:d?Tn(h):h)y.add(v.from,v.to,v.value);return y.finish()}static join(h){if(!h.length)return Gt.empty;let d=h[h.length-1];for(let y=h.length-2;y>=0;y--)for(let v=h[y];v!=Gt.empty;v=v.nextLayer)d=new Gt(v.chunkPos,v.chunk,d,Math.max(v.maxPoint,d.maxPoint));return d}}Gt.empty=new Gt([],[],null,-1);function Tn(B){if(B.length>1)for(let h=B[0],d=1;d<B.length;d++){let y=B[d];if(wi(h,y)>0)return B.slice().sort(wi);h=y}return B}Gt.empty.nextLayer=Gt.empty;class ri{finishChunk(h){this.chunks.push(new ii(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,h&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(h,d,y){this.addInner(h,d,y)||(this.nextLayer||(this.nextLayer=new ri)).add(h,d,y)}addInner(h,d,y){let v=h-this.lastTo||y.startSide-this.last.endSide;if(v<=0&&(h-this.lastFrom||y.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return v<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=h),this.from.push(h-this.chunkStart),this.to.push(d-this.chunkStart),this.last=y,this.lastFrom=h,this.lastTo=d,this.value.push(y),y.point&&(this.maxPoint=Math.max(this.maxPoint,d-h)),!0)}addChunk(h,d){if((h-this.lastTo||d.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,d.maxPoint),this.chunks.push(d),this.chunkPos.push(h);let y=d.value.length-1;return this.last=d.value[y],this.lastFrom=d.from[y]+h,this.lastTo=d.to[y]+h,!0}finish(){return this.finishInner(Gt.empty)}finishInner(h){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return h;let d=Gt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(h):h,this.setMaxPoint);return this.from=null,d}}function cn(B,h,d){let y=new Map;for(let D of B)for(let T=0;T<D.chunk.length;T++)D.chunk[T].maxPoint<=0&&y.set(D.chunk[T],D.chunkPos[T]);let v=new Set;for(let D of h)for(let T=0;T<D.chunk.length;T++){let H=y.get(D.chunk[T]);H!=null&&(d?d.mapPos(H):H)==D.chunkPos[T]&&!d?.touchesRange(H,H+D.chunk[T].length)&&v.add(D.chunk[T])}return v}class bt{constructor(h,d,y,v=0){this.layer=h,this.skip=d,this.minPoint=y,this.rank=v}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(h,d=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(h,d,!1),this}gotoInner(h,d,y){for(;this.chunkIndex<this.layer.chunk.length;){let v=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(v)||this.layer.chunkEnd(this.chunkIndex)<h||v.maxPoint<this.minPoint))break;this.chunkIndex++,y=!1}if(this.chunkIndex<this.layer.chunk.length){let v=this.layer.chunk[this.chunkIndex].findIndex(h-this.layer.chunkPos[this.chunkIndex],d,!0);(!y||this.rangeIndex<v)&&this.setRangeIndex(v)}this.next()}forward(h,d){(this.to-h||this.endSide-d)<0&&this.gotoInner(h,d,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let h=this.layer.chunkPos[this.chunkIndex],d=this.layer.chunk[this.chunkIndex],y=h+d.from[this.rangeIndex];if(this.from=y,this.to=h+d.to[this.rangeIndex],this.value=d.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(h){if(h==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=h}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(h){return this.from-h.from||this.startSide-h.startSide||this.rank-h.rank||this.to-h.to||this.endSide-h.endSide}}class Ft{constructor(h){this.heap=h}static from(h,d=null,y=-1){let v=[];for(let D=0;D<h.length;D++)for(let T=h[D];!T.isEmpty;T=T.nextLayer)T.maxPoint>=y&&v.push(new bt(T,d,y,D));return v.length==1?v[0]:new Ft(v)}get startSide(){return this.value?this.value.startSide:0}goto(h,d=-1e9){for(let y of this.heap)y.goto(h,d);for(let y=this.heap.length>>1;y>=0;y--)zi(this.heap,y);return this.next(),this}forward(h,d){for(let y of this.heap)y.forward(h,d);for(let y=this.heap.length>>1;y>=0;y--)zi(this.heap,y);(this.to-h||this.value.endSide-d)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let h=this.heap[0];this.from=h.from,this.to=h.to,this.value=h.value,this.rank=h.rank,h.value&&h.next(),zi(this.heap,0)}}}function zi(B,h){for(let d=B[h];;){let y=(h<<1)+1;if(y>=B.length)break;let v=B[y];if(y+1<B.length&&v.compare(B[y+1])>=0&&(v=B[y+1],y++),d.compare(v)<0)break;B[y]=d,B[h]=v,h=y}}class Bi{constructor(h,d,y){this.minPoint=y,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Ft.from(h,d,y)}goto(h,d=-1e9){return this.cursor.goto(h,d),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=h,this.endSide=d,this.openStart=-1,this.next(),this}forward(h,d){for(;this.minActive>-1&&(this.activeTo[this.minActive]-h||this.active[this.minActive].endSide-d)<0;)this.removeActive(this.minActive);this.cursor.forward(h,d)}removeActive(h){Ei(this.active,h),Ei(this.activeTo,h),Ei(this.activeRank,h),this.minActive=Ii(this.active,this.activeTo)}addActive(h){let d=0,{value:y,to:v,rank:D}=this.cursor;for(;d<this.activeRank.length&&(D-this.activeRank[d]||v-this.activeTo[d])>0;)d++;Ri(this.active,d,y),Ri(this.activeTo,d,v),Ri(this.activeRank,d,D),h&&Ri(h,d,this.cursor.from),this.minActive=Ii(this.active,this.activeTo)}next(){let h=this.to,d=this.point;this.point=null;let y=this.openStart<0?[]:null;for(;;){let v=this.minActive;if(v>-1&&(this.activeTo[v]-this.cursor.from||this.active[v].endSide-this.cursor.startSide)<0){if(this.activeTo[v]>h){this.to=this.activeTo[v],this.endSide=this.active[v].endSide;break}this.removeActive(v),y&&Ei(y,v)}else if(this.cursor.value)if(this.cursor.from>h){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let D=this.cursor.value;if(!D.point)this.addActive(y),this.cursor.next();else if(d&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=D,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=D.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(y){this.openStart=0;for(let v=y.length-1;v>=0&&y[v]<h;v--)this.openStart++}}activeForPoint(h){if(!this.active.length)return this.active;let d=[];for(let y=this.active.length-1;y>=0&&!(this.activeRank[y]<this.pointRank);y--)(this.activeTo[y]>h||this.activeTo[y]==h&&this.active[y].endSide>=this.point.endSide)&&d.push(this.active[y]);return d.reverse()}openEnd(h){let d=0;for(let y=this.activeTo.length-1;y>=0&&this.activeTo[y]>h;y--)d++;return d}}function Vi(B,h,d,y,v,D){B.goto(h),d.goto(y);let T=y+v,H=y,_=y-h;for(;;){let Z=B.to+_-d.to,le=Z||B.endSide-d.endSide,ce=le<0?B.to+_:d.to,ye=Math.min(ce,T);if(B.point||d.point?B.point&&d.point&&(B.point==d.point||B.point.eq(d.point))&&Yi(B.activeForPoint(B.to),d.activeForPoint(d.to))||D.comparePoint(H,ye,B.point,d.point):ye>H&&!Yi(B.active,d.active)&&D.compareRange(H,ye,B.active,d.active),ce>T)break;(Z||B.openEnd!=d.openEnd)&&D.boundChange&&D.boundChange(ce),H=ce,le<=0&&B.next(),le>=0&&d.next()}}function Yi(B,h){if(B.length!=h.length)return!1;for(let d=0;d<B.length;d++)if(B[d]!=h[d]&&!B[d].eq(h[d]))return!1;return!0}function Ei(B,h){for(let d=h,y=B.length-1;d<y;d++)B[d]=B[d+1];B.pop()}function Ri(B,h,d){for(let y=B.length-1;y>=h;y--)B[y+1]=B[y];B[h]=d}function Ii(B,h){let d=-1,y=1e9;for(let v=0;v<h.length;v++)(h[v]-y||B[v].endSide-B[d].endSide)<0&&(d=v,y=h[v]);return d}function _i(B,h,d=B.length){let y=0;for(let v=0;v<d&&v<B.length;)B.charCodeAt(v)==9?(y+=h-y%h,v++):(y++,v=wt(B,v));return y}function zn(B,h,d,y){for(let v=0,D=0;;){if(D>=h)return v;if(v==B.length)break;D+=B.charCodeAt(v)==9?d-D%d:1,v=wt(B,v)}return y===!0?-1:B.length}},69561:(hn,ni,Qe)=>{Qe.d(ni,{o:()=>ae});var z=["true","false","on","off","yes","no"],Be=new RegExp("\\b(("+z.join(")|(")+"))$","i");const ae={name:"yaml",token:function(R,J){var Ae=R.peek(),ze=J.escaped;if(J.escaped=!1,Ae=="#"&&(R.pos==0||/\s/.test(R.string.charAt(R.pos-1))))return R.skipToEnd(),"comment";if(R.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(J.literal&&R.indentation()>J.keyCol)return R.skipToEnd(),"string";if(J.literal&&(J.literal=!1),R.sol()){if(J.keyCol=0,J.pair=!1,J.pairStart=!1,R.match("---")||R.match("..."))return"def";if(R.match(/^\s*-\s+/))return"meta"}if(R.match(/^(\{|\}|\[|\])/))return Ae=="{"?J.inlinePairs++:Ae=="}"?J.inlinePairs--:Ae=="["?J.inlineList++:J.inlineList--,"meta";if(J.inlineList>0&&!ze&&Ae==",")return R.next(),"meta";if(J.inlinePairs>0&&!ze&&Ae==",")return J.keyCol=0,J.pair=!1,J.pairStart=!1,R.next(),"meta";if(J.pairStart){if(R.match(/^\s*(\||\>)\s*/))return J.literal=!0,"meta";if(R.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(J.inlinePairs==0&&R.match(/^\s*-?[0-9\.\,]+\s?$/)||J.inlinePairs>0&&R.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(R.match(Be))return"keyword"}return!J.pair&&R.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(J.pair=!0,J.keyCol=R.indentation(),"atom"):J.pair&&R.match(/^:\s*/)?(J.pairStart=!0,"meta"):(J.pairStart=!1,J.escaped=Ae=="\\",R.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}}},70339:(hn,ni,Qe)=>{Qe.d(ni,{v:()=>$e});var z=Qe(14041);function Be(we=!1){const Pe=(0,z.useRef)(we),Ee=(0,z.useCallback)(()=>Pe.current,[]);return(0,z.useEffect)(()=>(Pe.current=!0,()=>{Pe.current=!1}),[]),Ee}var ae=Qe(16261),R=Qe(71039);function J(we,...Pe){const Ee=Be(),Se=(0,ae.J)(Pe[1]),Ne=(0,z.useMemo)(()=>function(...qe){Ee()&&(typeof Se.current=="function"?Se.current.apply(this,qe):typeof Se.current.handleEvent=="function"&&Se.current.handleEvent.apply(this,qe))},[]);(0,z.useEffect)(()=>{const qe=Ae(we)?we.current:we;if(!qe)return;const he=Pe.slice(2);return(0,R.on)(qe,Pe[0],Ne,...he),()=>{(0,R.AU)(qe,Pe[0],Ne,...he)}},[we,Pe[0]])}function Ae(we){return we!==null&&typeof we=="object"&&(0,R.mQ)(we,"current")}var ze=Qe(99416);const Qt=we=>typeof we=="function"?we:typeof we=="string"?Pe=>Pe.key===we:we?R.ud:R.HD,it=ze.Bd?window:null;function $e(we,Pe,Ee=[],Se={}){const{event:Ne="keydown",target:qe=it,eventOptions:he}=Se,je=(0,ae.J)(Pe),ut=(0,z.useMemo)(()=>{const Ot=Qt(we);return function(Rt){Ot(Rt)&&je.current.call(this,Rt)}},Ee);J(qe,Ne,ut,he)}},79066:(hn,ni,Qe)=>{Qe.d(ni,{PH:()=>Pe,Qj:()=>we,Z6:()=>ze,fI:()=>Qt,iX:()=>Ke,rr:()=>Pt,uY:()=>R});const z=1024;let Be=0;class ae{constructor(k,O){this.from=k,this.to=O}}class R{constructor(k={}){this.id=Be++,this.perNode=!!k.perNode,this.deserialize=k.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(k){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof k!="function"&&(k=ze.match(k)),O=>{let N=k(O);return N===void 0?null:[this,N]}}}R.closedBy=new R({deserialize:X=>X.split(" ")}),R.openedBy=new R({deserialize:X=>X.split(" ")}),R.group=new R({deserialize:X=>X.split(" ")}),R.isolate=new R({deserialize:X=>{if(X&&X!="rtl"&&X!="ltr"&&X!="auto")throw new RangeError("Invalid value for isolate: "+X);return X||"auto"}}),R.contextHash=new R({perNode:!0}),R.lookAhead=new R({perNode:!0}),R.mounted=new R({perNode:!0});class J{constructor(k,O,N){this.tree=k,this.overlay=O,this.parser=N}static get(k){return k&&k.props&&k.props[R.mounted.id]}}const Ae=Object.create(null);class ze{constructor(k,O,N,L=0){this.name=k,this.props=O,this.id=N,this.flags=L}static define(k){let O=k.props&&k.props.length?Object.create(null):Ae,N=(k.top?1:0)|(k.skipped?2:0)|(k.error?4:0)|(k.name==null?8:0),L=new ze(k.name||"",O,k.id,N);if(k.props){for(let $ of k.props)if(Array.isArray($)||($=$(L)),$){if($[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");O[$[0].id]=$[1]}}return L}prop(k){return this.props[k.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(k){if(typeof k=="string"){if(this.name==k)return!0;let O=this.prop(R.group);return O?O.indexOf(k)>-1:!1}return this.id==k}static match(k){let O=Object.create(null);for(let N in k)for(let L of N.split(" "))O[L]=k[N];return N=>{for(let L=N.prop(R.group),$=-1;$<(L?L.length:0);$++){let G=O[$<0?N.name:L[$]];if(G)return G}}}}ze.none=new ze("",Object.create(null),0,8);class Qt{constructor(k){this.types=k;for(let O=0;O<k.length;O++)if(k[O].id!=O)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...k){let O=[];for(let N of this.types){let L=null;for(let $ of k){let G=$(N);G&&(L||(L=Object.assign({},N.props)),L[G[0].id]=G[1])}O.push(L?new ze(N.name,L,N.id,N.flags):N)}return new Qt(O)}}const it=new WeakMap,$e=new WeakMap;var we;(function(X){X[X.ExcludeBuffers=1]="ExcludeBuffers",X[X.IncludeAnonymous=2]="IncludeAnonymous",X[X.IgnoreMounts=4]="IgnoreMounts",X[X.IgnoreOverlays=8]="IgnoreOverlays"})(we||(we={}));class Pe{constructor(k,O,N,L,$){if(this.type=k,this.children=O,this.positions=N,this.length=L,this.props=null,$&&$.length){this.props=Object.create(null);for(let[G,Q]of $)this.props[typeof G=="number"?G:G.id]=Q}}toString(){let k=J.get(this);if(k&&!k.overlay)return k.tree.toString();let O="";for(let N of this.children){let L=N.toString();L&&(O&&(O+=","),O+=L)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(O.length?"("+O+")":""):O}cursor(k=0){return new Ct(this.topNode,k)}cursorAt(k,O=0,N=0){let L=it.get(this)||this.topNode,$=new Ct(L);return $.moveTo(k,O),it.set(this,$._tree),$}get topNode(){return new je(this,0,0,null)}resolve(k,O=0){let N=qe(it.get(this)||this.topNode,k,O,!1);return it.set(this,N),N}resolveInner(k,O=0){let N=qe($e.get(this)||this.topNode,k,O,!0);return $e.set(this,N),N}resolveStack(k,O=0){return wt(this,k,O)}iterate(k){let{enter:O,leave:N,from:L=0,to:$=this.length}=k,G=k.mode||0,Q=(G&we.IncludeAnonymous)>0;for(let me=this.cursor(G|we.IncludeAnonymous);;){let be=!1;if(me.from<=$&&me.to>=L&&(!Q&&me.type.isAnonymous||O(me)!==!1)){if(me.firstChild())continue;be=!0}for(;be&&N&&(Q||!me.type.isAnonymous)&&N(me),!me.nextSibling();){if(!me.parent())return;be=!0}}}prop(k){return k.perNode?this.props?this.props[k.id]:void 0:this.type.prop(k)}get propValues(){let k=[];if(this.props)for(let O in this.props)k.push([+O,this.props[O]]);return k}balance(k={}){return this.children.length<=8?this:qt(ze.none,this.children,this.positions,0,this.children.length,0,this.length,(O,N,L)=>new Pe(this.type,O,N,L,this.propValues),k.makeTree||((O,N,L)=>new Pe(ze.none,O,N,L)))}static build(k){return Tt(k)}}Pe.empty=new Pe(ze.none,[],[],0);class Ee{constructor(k,O){this.buffer=k,this.index=O}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ee(this.buffer,this.index)}}class Se{constructor(k,O,N){this.buffer=k,this.length=O,this.set=N}get type(){return ze.none}toString(){let k=[];for(let O=0;O<this.buffer.length;)k.push(this.childString(O)),O=this.buffer[O+3];return k.join(",")}childString(k){let O=this.buffer[k],N=this.buffer[k+3],L=this.set.types[O],$=L.name;if(/\W/.test($)&&!L.isError&&($=JSON.stringify($)),k+=4,N==k)return $;let G=[];for(;k<N;)G.push(this.childString(k)),k=this.buffer[k+3];return $+"("+G.join(",")+")"}findChild(k,O,N,L,$){let{buffer:G}=this,Q=-1;for(let me=k;me!=O&&!(Ne($,L,G[me+1],G[me+2])&&(Q=me,N>0));me=G[me+3]);return Q}slice(k,O,N){let L=this.buffer,$=new Uint16Array(O-k),G=0;for(let Q=k,me=0;Q<O;){$[me++]=L[Q++],$[me++]=L[Q++]-N;let be=$[me++]=L[Q++]-N;$[me++]=L[Q++]-k,G=Math.max(G,be)}return new Se($,G,this.set)}}function Ne(X,k,O,N){switch(X){case-2:return O<k;case-1:return N>=k&&O<k;case 0:return O<k&&N>k;case 1:return O<=k&&N>k;case 2:return N>k;case 4:return!0}}function qe(X,k,O,N){for(var L;X.from==X.to||(O<1?X.from>=k:X.from>k)||(O>-1?X.to<=k:X.to<k);){let G=!N&&X instanceof je&&X.index<0?null:X.parent;if(!G)return X;X=G}let $=N?0:we.IgnoreOverlays;if(N)for(let G=X,Q=G.parent;Q;G=Q,Q=G.parent)G instanceof je&&G.index<0&&((L=Q.enter(k,O,$))===null||L===void 0?void 0:L.from)!=G.from&&(X=Q);for(;;){let G=X.enter(k,O,$);if(!G)return X;X=G}}class he{cursor(k=0){return new Ct(this,k)}getChild(k,O=null,N=null){let L=ut(this,k,O,N);return L.length?L[0]:null}getChildren(k,O=null,N=null){return ut(this,k,O,N)}resolve(k,O=0){return qe(this,k,O,!1)}resolveInner(k,O=0){return qe(this,k,O,!0)}matchContext(k){return Ot(this.parent,k)}enterUnfinishedNodesBefore(k){let O=this.childBefore(k),N=this;for(;O;){let L=O.lastChild;if(!L||L.to!=O.to)break;L.type.isError&&L.from==L.to?(N=O,O=L.prevSibling):O=L}return N}get node(){return this}get next(){return this.parent}}class je extends he{constructor(k,O,N,L){super(),this._tree=k,this.from=O,this.index=N,this._parent=L}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(k,O,N,L,$=0){for(let G=this;;){for(let{children:Q,positions:me}=G._tree,be=O>0?Q.length:-1;k!=be;k+=O){let xe=Q[k],Ie=me[k]+G.from;if(Ne(L,N,Ie,Ie+xe.length)){if(xe instanceof Se){if($&we.ExcludeBuffers)continue;let _e=xe.findChild(0,xe.buffer.length,O,N-Ie,L);if(_e>-1)return new at(new Rt(G,xe,k,Ie),null,_e)}else if($&we.IncludeAnonymous||!xe.type.isAnonymous||$t(xe)){let _e;if(!($&we.IgnoreMounts)&&(_e=J.get(xe))&&!_e.overlay)return new je(_e.tree,Ie,k,G);let ot=new je(xe,Ie,k,G);return $&we.IncludeAnonymous||!ot.type.isAnonymous?ot:ot.nextChild(O<0?xe.children.length-1:0,O,N,L)}}}if($&we.IncludeAnonymous||!G.type.isAnonymous||(G.index>=0?k=G.index+O:k=O<0?-1:G._parent._tree.children.length,G=G._parent,!G))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(k){return this.nextChild(0,1,k,2)}childBefore(k){return this.nextChild(this._tree.children.length-1,-1,k,-2)}enter(k,O,N=0){let L;if(!(N&we.IgnoreOverlays)&&(L=J.get(this._tree))&&L.overlay){let $=k-this.from;for(let{from:G,to:Q}of L.overlay)if((O>0?G<=$:G<$)&&(O<0?Q>=$:Q>$))return new je(L.tree,L.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,k,O,N)}nextSignificantParent(){let k=this;for(;k.type.isAnonymous&&k._parent;)k=k._parent;return k}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function ut(X,k,O,N){let L=X.cursor(),$=[];if(!L.firstChild())return $;if(O!=null){for(let G=!1;!G;)if(G=L.type.is(O),!L.nextSibling())return $}for(;;){if(N!=null&&L.type.is(N))return $;if(L.type.is(k)&&$.push(L.node),!L.nextSibling())return N==null?$:[]}}function Ot(X,k,O=k.length-1){for(let N=X;O>=0;N=N.parent){if(!N)return!1;if(!N.type.isAnonymous){if(k[O]&&k[O]!=N.name)return!1;O--}}return!0}class Rt{constructor(k,O,N,L){this.parent=k,this.buffer=O,this.index=N,this.start=L}}class at extends he{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(k,O,N){super(),this.context=k,this._parent=O,this.index=N,this.type=k.buffer.set.types[k.buffer.buffer[N]]}child(k,O,N){let{buffer:L}=this.context,$=L.findChild(this.index+4,L.buffer[this.index+3],k,O-this.context.start,N);return $<0?null:new at(this.context,this,$)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(k){return this.child(1,k,2)}childBefore(k){return this.child(-1,k,-2)}enter(k,O,N=0){if(N&we.ExcludeBuffers)return null;let{buffer:L}=this.context,$=L.findChild(this.index+4,L.buffer[this.index+3],O>0?1:-1,k-this.context.start,O);return $<0?null:new at(this.context,this,$)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(k){return this._parent?null:this.context.parent.nextChild(this.context.index+k,k,0,4)}get nextSibling(){let{buffer:k}=this.context,O=k.buffer[this.index+3];return O<(this._parent?k.buffer[this._parent.index+3]:k.buffer.length)?new at(this.context,this._parent,O):this.externalSibling(1)}get prevSibling(){let{buffer:k}=this.context,O=this._parent?this._parent.index+4:0;return this.index==O?this.externalSibling(-1):new at(this.context,this._parent,k.findChild(O,this.index,-1,0,4))}get tree(){return null}toTree(){let k=[],O=[],{buffer:N}=this.context,L=this.index+4,$=N.buffer[this.index+3];if($>L){let G=N.buffer[this.index+1];k.push(N.slice(L,$,G)),O.push(0)}return new Pe(this.type,k,O,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function jt(X){if(!X.length)return null;let k=0,O=X[0];for(let $=1;$<X.length;$++){let G=X[$];(G.from>O.from||G.to<O.to)&&(O=G,k=$)}let N=O instanceof je&&O.index<0?null:O.parent,L=X.slice();return N?L[k]=N:L.splice(k,1),new Kt(L,O)}class Kt{constructor(k,O){this.heads=k,this.node=O}get next(){return jt(this.heads)}}function wt(X,k,O){let N=X.resolveInner(k,O),L=null;for(let $=N instanceof je?N:N.context.parent;$;$=$.parent)if($.index<0){let G=$.parent;(L||(L=[N])).push(G.resolve(k,O)),$=G}else{let G=J.get($.tree);if(G&&G.overlay&&G.overlay[0].from<=k&&G.overlay[G.overlay.length-1].to>=k){let Q=new je(G.tree,G.overlay[0].from+$.from,-1,$);(L||(L=[N])).push(qe(Q,k,O,!1))}}return L?jt(L):N}class Ct{get name(){return this.type.name}constructor(k,O=0){if(this.mode=O,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,k instanceof je)this.yieldNode(k);else{this._tree=k.context.parent,this.buffer=k.context;for(let N=k._parent;N;N=N._parent)this.stack.unshift(N.index);this.bufferNode=k,this.yieldBuf(k.index)}}yieldNode(k){return k?(this._tree=k,this.type=k.type,this.from=k.from,this.to=k.to,!0):!1}yieldBuf(k,O){this.index=k;let{start:N,buffer:L}=this.buffer;return this.type=O||L.set.types[L.buffer[k]],this.from=N+L.buffer[k+1],this.to=N+L.buffer[k+2],!0}yield(k){return k?k instanceof je?(this.buffer=null,this.yieldNode(k)):(this.buffer=k.context,this.yieldBuf(k.index,k.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(k,O,N){if(!this.buffer)return this.yield(this._tree.nextChild(k<0?this._tree._tree.children.length-1:0,k,O,N,this.mode));let{buffer:L}=this.buffer,$=L.findChild(this.index+4,L.buffer[this.index+3],k,O-this.buffer.start,N);return $<0?!1:(this.stack.push(this.index),this.yieldBuf($))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(k){return this.enterChild(1,k,2)}childBefore(k){return this.enterChild(-1,k,-2)}enter(k,O,N=this.mode){return this.buffer?N&we.ExcludeBuffers?!1:this.enterChild(1,k,O):this.yield(this._tree.enter(k,O,N))}parent(){if(!this.buffer)return this.yieldNode(this.mode&we.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let k=this.mode&we.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(k)}sibling(k){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+k,k,0,4,this.mode)):!1;let{buffer:O}=this.buffer,N=this.stack.length-1;if(k<0){let L=N<0?0:this.stack[N]+4;if(this.index!=L)return this.yieldBuf(O.findChild(L,this.index,-1,0,4))}else{let L=O.buffer[this.index+3];if(L<(N<0?O.buffer.length:O.buffer[this.stack[N]+3]))return this.yieldBuf(L)}return N<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+k,k,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(k){let O,N,{buffer:L}=this;if(L){if(k>0){if(this.index<L.buffer.buffer.length)return!1}else for(let $=0;$<this.index;$++)if(L.buffer.buffer[$+3]<this.index)return!1;({index:O,parent:N}=L)}else({index:O,_parent:N}=this._tree);for(;N;{index:O,_parent:N}=N)if(O>-1)for(let $=O+k,G=k<0?-1:N._tree.children.length;$!=G;$+=k){let Q=N._tree.children[$];if(this.mode&we.IncludeAnonymous||Q instanceof Se||!Q.type.isAnonymous||$t(Q))return!1}return!0}move(k,O){if(O&&this.enterChild(k,0,4))return!0;for(;;){if(this.sibling(k))return!0;if(this.atLastNode(k)||!this.parent())return!1}}next(k=!0){return this.move(1,k)}prev(k=!0){return this.move(-1,k)}moveTo(k,O=0){for(;(this.from==this.to||(O<1?this.from>=k:this.from>k)||(O>-1?this.to<=k:this.to<k))&&this.parent(););for(;this.enterChild(1,k,O););return this}get node(){if(!this.buffer)return this._tree;let k=this.bufferNode,O=null,N=0;if(k&&k.context==this.buffer)e:for(let L=this.index,$=this.stack.length;$>=0;){for(let G=k;G;G=G._parent)if(G.index==L){if(L==this.index)return G;O=G,N=$+1;break e}L=this.stack[--$]}for(let L=N;L<this.stack.length;L++)O=new at(this.buffer,O,this.stack[L]);return this.bufferNode=new at(this.buffer,O,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(k,O){for(let N=0;;){let L=!1;if(this.type.isAnonymous||k(this)!==!1){if(this.firstChild()){N++;continue}this.type.isAnonymous||(L=!0)}for(;;){if(L&&O&&O(this),L=this.type.isAnonymous,!N)return;if(this.nextSibling())break;this.parent(),N--,L=!0}}}matchContext(k){if(!this.buffer)return Ot(this.node.parent,k);let{buffer:O}=this.buffer,{types:N}=O.set;for(let L=k.length-1,$=this.stack.length-1;L>=0;$--){if($<0)return Ot(this._tree,k,L);let G=N[O.buffer[this.stack[$]]];if(!G.isAnonymous){if(k[L]&&k[L]!=G.name)return!1;L--}}return!0}}function $t(X){return X.children.some(k=>k instanceof Se||!k.type.isAnonymous||$t(k))}function Tt(X){var k;let{buffer:O,nodeSet:N,maxBufferLength:L=z,reused:$=[],minRepeatType:G=N.types.length}=X,Q=Array.isArray(O)?new Ee(O,O.length):O,me=N.types,be=0,xe=0;function Ie(st,tt,ue,Ue,lt,ct){let{id:Xe,start:Fe,end:ft,size:Ge}=Q,pt=xe,Ut=be;for(;Ge<0;)if(Q.next(),Ge==-1){let Bt=$[Xe];ue.push(Bt),Ue.push(Fe-st);return}else if(Ge==-3){be=Xe;return}else if(Ge==-4){xe=Xe;return}else throw new RangeError(`Unrecognized record size: ${Ge}`);let Nt=me[Xe],si,zt,yt=Fe-st;if(ft-Fe<=L&&(zt=Wt(Q.pos-tt,lt))){let Bt=new Uint16Array(zt.size-zt.skip),Ze=Q.pos-zt.size,Vt=Bt.length;for(;Q.pos>Ze;)Vt=ei(zt.start,Bt,Vt);si=new Se(Bt,ft-zt.start,N),yt=zt.start-st}else{let Bt=Q.pos-Ge;Q.next();let Ze=[],Vt=[],ai=Xe>=G?Xe:-1,pi=0,wi=ft;for(;Q.pos>Bt;)ai>=0&&Q.id==ai&&Q.size>=0?(Q.end<=wi-L&&(vt(Ze,Vt,Fe,pi,Q.end,wi,ai,pt,Ut),pi=Ze.length,wi=Q.end),Q.next()):ct>2500?_e(Fe,Bt,Ze,Vt):Ie(Fe,Bt,Ze,Vt,ai,ct+1);if(ai>=0&&pi>0&&pi<Ze.length&&vt(Ze,Vt,Fe,pi,Fe,wi,ai,pt,Ut),Ze.reverse(),Vt.reverse(),ai>-1&&pi>0){let ii=ot(Nt,Ut);si=qt(Nt,Ze,Vt,0,Ze.length,0,ft-Fe,ii,ii)}else si=It(Nt,Ze,Vt,ft-Fe,pt-ft,Ut)}ue.push(si),Ue.push(yt)}function _e(st,tt,ue,Ue){let lt=[],ct=0,Xe=-1;for(;Q.pos>tt;){let{id:Fe,start:ft,end:Ge,size:pt}=Q;if(pt>4)Q.next();else{if(Xe>-1&&ft<Xe)break;Xe<0&&(Xe=Ge-L),lt.push(Fe,ft,Ge),ct++,Q.next()}}if(ct){let Fe=new Uint16Array(ct*4),ft=lt[lt.length-2];for(let Ge=lt.length-3,pt=0;Ge>=0;Ge-=3)Fe[pt++]=lt[Ge],Fe[pt++]=lt[Ge+1]-ft,Fe[pt++]=lt[Ge+2]-ft,Fe[pt++]=pt;ue.push(new Se(Fe,lt[2]-ft,N)),Ue.push(ft-st)}}function ot(st,tt){return(ue,Ue,lt)=>{let ct=0,Xe=ue.length-1,Fe,ft;if(Xe>=0&&(Fe=ue[Xe])instanceof Pe){if(!Xe&&Fe.type==st&&Fe.length==lt)return Fe;(ft=Fe.prop(R.lookAhead))&&(ct=Ue[Xe]+Fe.length+ft)}return It(st,ue,Ue,lt,ct,tt)}}function vt(st,tt,ue,Ue,lt,ct,Xe,Fe,ft){let Ge=[],pt=[];for(;st.length>Ue;)Ge.push(st.pop()),pt.push(tt.pop()+ue-lt);st.push(It(N.types[Xe],Ge,pt,ct-lt,Fe-ct,ft)),tt.push(lt-ue)}function It(st,tt,ue,Ue,lt,ct,Xe){if(ct){let Fe=[R.contextHash,ct];Xe=Xe?[Fe].concat(Xe):[Fe]}if(lt>25){let Fe=[R.lookAhead,lt];Xe=Xe?[Fe].concat(Xe):[Fe]}return new Pe(st,tt,ue,Ue,Xe)}function Wt(st,tt){let ue=Q.fork(),Ue=0,lt=0,ct=0,Xe=ue.end-L,Fe={size:0,start:0,skip:0};e:for(let ft=ue.pos-st;ue.pos>ft;){let Ge=ue.size;if(ue.id==tt&&Ge>=0){Fe.size=Ue,Fe.start=lt,Fe.skip=ct,ct+=4,Ue+=4,ue.next();continue}let pt=ue.pos-Ge;if(Ge<0||pt<ft||ue.start<Xe)break;let Ut=ue.id>=G?4:0,Nt=ue.start;for(ue.next();ue.pos>pt;){if(ue.size<0)if(ue.size==-3)Ut+=4;else break e;else ue.id>=G&&(Ut+=4);ue.next()}lt=Nt,Ue+=Ge,ct+=Ut}return(tt<0||Ue==st)&&(Fe.size=Ue,Fe.start=lt,Fe.skip=ct),Fe.size>4?Fe:void 0}function ei(st,tt,ue){let{id:Ue,start:lt,end:ct,size:Xe}=Q;if(Q.next(),Xe>=0&&Ue<G){let Fe=ue;if(Xe>4){let ft=Q.pos-(Xe-4);for(;Q.pos>ft;)ue=ei(st,tt,ue)}tt[--ue]=Fe,tt[--ue]=ct-st,tt[--ue]=lt-st,tt[--ue]=Ue}else Xe==-3?be=Ue:Xe==-4&&(xe=Ue);return ue}let Lt=[],kt=[];for(;Q.pos>0;)Ie(X.start||0,X.bufferStart||0,Lt,kt,-1,0);let ti=(k=X.length)!==null&&k!==void 0?k:Lt.length?kt[0]+Lt[0].length:0;return new Pe(me[X.topID],Lt.reverse(),kt.reverse(),ti)}const di=new WeakMap;function Yt(X,k){if(!X.isAnonymous||k instanceof Se||k.type!=X)return 1;let O=di.get(k);if(O==null){O=1;for(let N of k.children){if(N.type!=X||!(N instanceof Pe)){O=1;break}O+=Yt(X,N)}di.set(k,O)}return O}function qt(X,k,O,N,L,$,G,Q,me){let be=0;for(let vt=N;vt<L;vt++)be+=Yt(X,k[vt]);let xe=Math.ceil(be*1.5/8),Ie=[],_e=[];function ot(vt,It,Wt,ei,Lt){for(let kt=Wt;kt<ei;){let ti=kt,st=It[kt],tt=Yt(X,vt[kt]);for(kt++;kt<ei;kt++){let ue=Yt(X,vt[kt]);if(tt+ue>=xe)break;tt+=ue}if(kt==ti+1){if(tt>xe){let ue=vt[ti];ot(ue.children,ue.positions,0,ue.children.length,It[ti]+Lt);continue}Ie.push(vt[ti])}else{let ue=It[kt-1]+vt[kt-1].length-st;Ie.push(qt(X,vt,It,ti,kt,st,ue,null,me))}_e.push(st+Lt-$)}}return ot(k,O,N,L,0),(Q||me)(Ie,_e,G)}class Me{constructor(){this.map=new WeakMap}setBuffer(k,O,N){let L=this.map.get(k);L||this.map.set(k,L=new Map),L.set(O,N)}getBuffer(k,O){let N=this.map.get(k);return N&&N.get(O)}set(k,O){k instanceof at?this.setBuffer(k.context.buffer,k.index,O):k instanceof je&&this.map.set(k.tree,O)}get(k){return k instanceof at?this.getBuffer(k.context.buffer,k.index):k instanceof je?this.map.get(k.tree):void 0}cursorSet(k,O){k.buffer?this.setBuffer(k.buffer.buffer,k.index,O):this.map.set(k.tree,O)}cursorGet(k){return k.buffer?this.getBuffer(k.buffer.buffer,k.index):this.map.get(k.tree)}}class Pt{constructor(k,O,N,L,$=!1,G=!1){this.from=k,this.to=O,this.tree=N,this.offset=L,this.open=($?1:0)|(G?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(k,O=[],N=!1){let L=[new Pt(0,k.length,k,0,!1,N)];for(let $ of O)$.to>k.length&&L.push($);return L}static applyChanges(k,O,N=128){if(!O.length)return k;let L=[],$=1,G=k.length?k[0]:null;for(let Q=0,me=0,be=0;;Q++){let xe=Q<O.length?O[Q]:null,Ie=xe?xe.fromA:1e9;if(Ie-me>=N)for(;G&&G.from<Ie;){let _e=G;if(me>=_e.from||Ie<=_e.to||be){let ot=Math.max(_e.from,me)-be,vt=Math.min(_e.to,Ie)-be;_e=ot>=vt?null:new Pt(ot,vt,_e.tree,_e.offset+be,Q>0,!!xe)}if(_e&&L.push(_e),G.to>Ie)break;G=$<k.length?k[$++]:null}if(!xe)break;me=xe.toA,be=xe.toA-xe.toB}return L}}class Ke{startParse(k,O,N){return typeof k=="string"&&(k=new oe(k)),N=N?N.length?N.map(L=>new ae(L.from,L.to)):[new ae(0,0)]:[new ae(0,k.length)],this.createParse(k,O||[],N)}parse(k,O,N){let L=this.startParse(k,O,N);for(;;){let $=L.advance();if($)return $}}}class oe{constructor(k){this.string=k}get length(){return this.string.length}chunk(k){return this.string.slice(k)}get lineChunks(){return!1}read(k,O){return this.string.slice(k,O)}}function pe(X){return(k,O,N,L)=>new nt(k,X,O,N,L)}class Oe{constructor(k,O,N,L,$){this.parser=k,this.parse=O,this.overlay=N,this.target=L,this.from=$}}function fe(X){if(!X.length||X.some(k=>k.from>=k.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(X))}class Je{constructor(k,O,N,L,$,G,Q){this.parser=k,this.predicate=O,this.mounts=N,this.index=L,this.start=$,this.target=G,this.prev=Q,this.depth=0,this.ranges=[]}}const dt=new R({perNode:!0});class nt{constructor(k,O,N,L,$){this.nest=O,this.input=N,this.fragments=L,this.ranges=$,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=k}advance(){if(this.baseParse){let N=this.baseParse.advance();if(!N)return null;if(this.baseParse=null,this.baseTree=N,this.startInner(),this.stoppedAt!=null)for(let L of this.inner)L.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let N=this.baseTree;return this.stoppedAt!=null&&(N=new Pe(N.type,N.children,N.positions,N.length,N.propValues.concat([[dt,this.stoppedAt]]))),N}let k=this.inner[this.innerDone],O=k.parse.advance();if(O){this.innerDone++;let N=Object.assign(Object.create(null),k.target.props);N[R.mounted.id]=new J(O,k.overlay,k.parser),k.target.props=N}return null}get parsedPos(){if(this.baseParse)return 0;let k=this.input.length;for(let O=this.innerDone;O<this.inner.length;O++)this.inner[O].from<k&&(k=Math.min(k,this.inner[O].parse.parsedPos));return k}stopAt(k){if(this.stoppedAt=k,this.baseParse)this.baseParse.stopAt(k);else for(let O=this.innerDone;O<this.inner.length;O++)this.inner[O].parse.stopAt(k)}startInner(){let k=new gt(this.fragments),O=null,N=null,L=new Ct(new je(this.baseTree,this.ranges[0].from,0,null),we.IncludeAnonymous|we.IgnoreMounts);e:for(let $,G;;){let Q=!0,me;if(this.stoppedAt!=null&&L.from>=this.stoppedAt)Q=!1;else if(k.hasNode(L)){if(O){let be=O.mounts.find(xe=>xe.frag.from<=L.from&&xe.frag.to>=L.to&&xe.mount.overlay);if(be)for(let xe of be.mount.overlay){let Ie=xe.from+be.pos,_e=xe.to+be.pos;Ie>=L.from&&_e<=L.to&&!O.ranges.some(ot=>ot.from<_e&&ot.to>Ie)&&O.ranges.push({from:Ie,to:_e})}}Q=!1}else if(N&&(G=Ve(N.ranges,L.from,L.to)))Q=G!=2;else if(!L.type.isAnonymous&&($=this.nest(L,this.input))&&(L.from<L.to||!$.overlay)){L.tree||Jt(L);let be=k.findMounts(L.from,$.parser);if(typeof $.overlay=="function")O=new Je($.parser,$.overlay,be,this.inner.length,L.from,L.tree,O);else{let xe=At(this.ranges,$.overlay||(L.from<L.to?[new ae(L.from,L.to)]:[]));xe.length&&fe(xe),(xe.length||!$.overlay)&&this.inner.push(new Oe($.parser,xe.length?$.parser.startParse(this.input,xi(be,xe),xe):$.parser.startParse(""),$.overlay?$.overlay.map(Ie=>new ae(Ie.from-L.from,Ie.to-L.from)):null,L.tree,xe.length?xe[0].from:L.from)),$.overlay?xe.length&&(N={ranges:xe,depth:0,prev:N}):Q=!1}}else if(O&&(me=O.predicate(L))&&(me===!0&&(me=new ae(L.from,L.to)),me.from<me.to)){let be=O.ranges.length-1;be>=0&&O.ranges[be].to==me.from?O.ranges[be]={from:O.ranges[be].from,to:me.to}:O.ranges.push(me)}if(Q&&L.firstChild())O&&O.depth++,N&&N.depth++;else for(;!L.nextSibling();){if(!L.parent())break e;if(O&&!--O.depth){let be=At(this.ranges,O.ranges);be.length&&(fe(be),this.inner.splice(O.index,0,new Oe(O.parser,O.parser.startParse(this.input,xi(O.mounts,be),be),O.ranges.map(xe=>new ae(xe.from-O.start,xe.to-O.start)),O.target,be[0].from))),O=O.prev}N&&!--N.depth&&(N=N.prev)}}}}function Ve(X,k,O){for(let N of X){if(N.from>=O)break;if(N.to>k)return N.from<=k&&N.to>=O?2:1}return 0}function Re(X,k,O,N,L,$){if(k<O){let G=X.buffer[k+1];N.push(X.slice(k,O,G)),L.push(G-$)}}function Jt(X){let{node:k}=X,O=[],N=k.context.buffer;do O.push(X.index),X.parent();while(!X.tree);let L=X.tree,$=L.children.indexOf(N),G=L.children[$],Q=G.buffer,me=[$];function be(xe,Ie,_e,ot,vt,It){let Wt=O[It],ei=[],Lt=[];Re(G,xe,Wt,ei,Lt,ot);let kt=Q[Wt+1],ti=Q[Wt+2];me.push(ei.length);let st=It?be(Wt+4,Q[Wt+3],G.set.types[Q[Wt]],kt,ti-kt,It-1):k.toTree();return ei.push(st),Lt.push(kt-ot),Re(G,Q[Wt+3],Ie,ei,Lt,ot),new Pe(_e,ei,Lt,vt)}L.children[$]=be(0,Q.length,ze.none,0,G.length,O.length-1);for(let xe of me){let Ie=X.tree.children[xe],_e=X.tree.positions[xe];X.yield(new je(Ie,_e+X.from,xe,X._tree))}}class et{constructor(k,O){this.offset=O,this.done=!1,this.cursor=k.cursor(we.IncludeAnonymous|we.IgnoreMounts)}moveTo(k){let{cursor:O}=this,N=k-this.offset;for(;!this.done&&O.from<N;)O.to>=k&&O.enter(N,1,we.IgnoreOverlays|we.ExcludeBuffers)||O.next(!1)||(this.done=!0)}hasNode(k){if(this.moveTo(k.from),!this.done&&this.cursor.from+this.offset==k.from&&this.cursor.tree)for(let O=this.cursor.tree;;){if(O==k.tree)return!0;if(O.children.length&&O.positions[0]==0&&O.children[0]instanceof Pe)O=O.children[0];else break}return!1}}class gt{constructor(k){var O;if(this.fragments=k,this.curTo=0,this.fragI=0,k.length){let N=this.curFrag=k[0];this.curTo=(O=N.tree.prop(dt))!==null&&O!==void 0?O:N.to,this.inner=new et(N.tree,-N.offset)}else this.curFrag=this.inner=null}hasNode(k){for(;this.curFrag&&k.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=k.from&&this.curTo>=k.to&&this.inner.hasNode(k)}nextFrag(){var k;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let O=this.curFrag=this.fragments[this.fragI];this.curTo=(k=O.tree.prop(dt))!==null&&k!==void 0?k:O.to,this.inner=new et(O.tree,-O.offset)}}findMounts(k,O){var N;let L=[];if(this.inner){this.inner.cursor.moveTo(k,1);for(let $=this.inner.cursor.node;$;$=$.parent){let G=(N=$.tree)===null||N===void 0?void 0:N.prop(R.mounted);if(G&&G.parser==O)for(let Q=this.fragI;Q<this.fragments.length;Q++){let me=this.fragments[Q];if(me.from>=$.to)break;me.tree==this.curFrag.tree&&L.push({frag:me,pos:$.from-me.offset,mount:G})}}}return L}}function At(X,k){let O=null,N=k;for(let L=1,$=0;L<X.length;L++){let G=X[L-1].to,Q=X[L].from;for(;$<N.length;$++){let me=N[$];if(me.from>=Q)break;me.to<=G||(O||(N=O=k.slice()),me.from<G?(O[$]=new ae(me.from,G),me.to>Q&&O.splice($+1,0,new ae(Q,me.to))):me.to>Q?O[$--]=new ae(Q,me.to):O.splice($--,1))}}return N}function bi(X,k,O,N){let L=0,$=0,G=!1,Q=!1,me=-1e9,be=[];for(;;){let xe=L==X.length?1e9:G?X[L].to:X[L].from,Ie=$==k.length?1e9:Q?k[$].to:k[$].from;if(G!=Q){let _e=Math.max(me,O),ot=Math.min(xe,Ie,N);_e<ot&&be.push(new ae(_e,ot))}if(me=Math.min(xe,Ie),me==1e9)break;xe==me&&(G?(G=!1,L++):G=!0),Ie==me&&(Q?(Q=!1,$++):Q=!0)}return be}function xi(X,k){let O=[];for(let{pos:N,mount:L,frag:$}of X){let G=N+(L.overlay?L.overlay[0].from:0),Q=G+L.tree.length,me=Math.max($.from,G),be=Math.min($.to,Q);if(L.overlay){let xe=L.overlay.map(_e=>new ae(_e.from+N,_e.to+N)),Ie=bi(k,xe,me,be);for(let _e=0,ot=me;;_e++){let vt=_e==Ie.length,It=vt?be:Ie[_e].from;if(It>ot&&O.push(new Pt(ot,It,L.tree,-G,$.from>=ot||$.openStart,$.to<=It||$.openEnd)),vt)break;ot=Ie[_e].to}}else O.push(new Pt(me,be,L.tree,-G,$.from>=G||$.openStart,$.to<=Q||$.openEnd))}return O}},83173:(hn,ni,Qe)=>{Qe.d(ni,{NZ:()=>ue,OP:()=>yt,Lz:()=>ht,wJ:()=>qi,Z9:()=>Xt,xO:()=>st,HJ:()=>rr,VH:()=>sl,A:()=>nr,ld:()=>sn,Eg:()=>_l,cU:()=>Kl,dz:()=>pl,Wu:()=>Bl,N$:()=>fl,Ux:()=>kl,w4:()=>Qn,$K:()=>Do,c_:()=>Et,qf:()=>gl,D4:()=>sr,TS:()=>tl,S7:()=>fr,DK:()=>hr});for(var z=Qe(57195),Be=Qe(98104),ae={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},R={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},J=typeof navigator<"u"&&/Mac/.test(navigator.platform),Ae=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),ze=0;ze<10;ze++)ae[48+ze]=ae[96+ze]=String(ze);for(var ze=1;ze<=24;ze++)ae[ze+111]="F"+ze;for(var ze=65;ze<=90;ze++)ae[ze]=String.fromCharCode(ze+32),R[ze]=String.fromCharCode(ze);for(var Qt in ae)R.hasOwnProperty(Qt)||(R[Qt]=ae[Qt]);function it(o){var e=J&&o.metaKey&&o.shiftKey&&!o.ctrlKey&&!o.altKey||Ae&&o.shiftKey&&o.key&&o.key.length==1||o.key=="Unidentified",t=!e&&o.key||(o.shiftKey?R:ae)[o.keyCode]||o.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function $e(o){let e;return o.nodeType==11?e=o.getSelection?o:o.ownerDocument:e=o,e.getSelection()}function we(o,e){return e?o==e||o.contains(e.nodeType!=1?e.parentNode:e):!1}function Pe(o,e){if(!e.anchorNode)return!1;try{return we(o,e.anchorNode)}catch{return!1}}function Ee(o){return o.nodeType==3?Tt(o,0,o.nodeValue.length).getClientRects():o.nodeType==1?o.getClientRects():[]}function Se(o,e,t,i){return t?he(o,e,t,i,-1)||he(o,e,t,i,1):!1}function Ne(o){for(var e=0;;e++)if(o=o.previousSibling,!o)return e}function qe(o){return o.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(o.nodeName)}function he(o,e,t,i,s){for(;;){if(o==t&&e==i)return!0;if(e==(s<0?0:je(o))){if(o.nodeName=="DIV")return!1;let a=o.parentNode;if(!a||a.nodeType!=1)return!1;e=Ne(o)+(s<0?0:1),o=a}else if(o.nodeType==1){if(o=o.childNodes[e+(s<0?-1:0)],o.nodeType==1&&o.contentEditable=="false")return!1;e=s<0?je(o):0}else return!1}}function je(o){return o.nodeType==3?o.nodeValue.length:o.childNodes.length}function ut(o,e){let t=e?o.left:o.right;return{left:t,right:t,top:o.top,bottom:o.bottom}}function Ot(o){let e=o.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:o.innerWidth,top:0,bottom:o.innerHeight}}function Rt(o,e){let t=e.width/o.offsetWidth,i=e.height/o.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-o.offsetWidth)<1)&&(t=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-o.offsetHeight)<1)&&(i=1),{scaleX:t,scaleY:i}}function at(o,e,t,i,s,a,u,m){let b=o.ownerDocument,C=b.defaultView||window;for(let S=o,I=!1;S&&!I;)if(S.nodeType==1){let W,U=S==b.body,Y=1,ee=1;if(U)W=Ot(C);else{if(/^(fixed|sticky)$/.test(getComputedStyle(S).position)&&(I=!0),S.scrollHeight<=S.clientHeight&&S.scrollWidth<=S.clientWidth){S=S.assignedSlot||S.parentNode;continue}let Ce=S.getBoundingClientRect();({scaleX:Y,scaleY:ee}=Rt(S,Ce)),W={left:Ce.left,right:Ce.left+S.clientWidth*Y,top:Ce.top,bottom:Ce.top+S.clientHeight*ee}}let re=0,se=0;if(s=="nearest")e.top<W.top?(se=e.top-(W.top+u),t>0&&e.bottom>W.bottom+se&&(se=e.bottom-W.bottom+u)):e.bottom>W.bottom&&(se=e.bottom-W.bottom+u,t<0&&e.top-se<W.top&&(se=e.top-(W.top+u)));else{let Ce=e.bottom-e.top,Le=W.bottom-W.top;se=(s=="center"&&Ce<=Le?e.top+Ce/2-Le/2:s=="start"||s=="center"&&t<0?e.top-u:e.bottom-Le+u)-W.top}if(i=="nearest"?e.left<W.left?(re=e.left-(W.left+a),t>0&&e.right>W.right+re&&(re=e.right-W.right+a)):e.right>W.right&&(re=e.right-W.right+a,t<0&&e.left<W.left+re&&(re=e.left-(W.left+a))):re=(i=="center"?e.left+(e.right-e.left)/2-(W.right-W.left)/2:i=="start"==m?e.left-a:e.right-(W.right-W.left)+a)-W.left,re||se)if(U)C.scrollBy(re,se);else{let Ce=0,Le=0;if(se){let De=S.scrollTop;S.scrollTop+=se/ee,Le=(S.scrollTop-De)*ee}if(re){let De=S.scrollLeft;S.scrollLeft+=re/Y,Ce=(S.scrollLeft-De)*Y}e={left:e.left-Ce,top:e.top-Le,right:e.right-Ce,bottom:e.bottom-Le},Ce&&Math.abs(Ce-re)<1&&(i="nearest"),Le&&Math.abs(Le-se)<1&&(s="nearest")}if(U)break;(e.top<W.top||e.bottom>W.bottom||e.left<W.left||e.right>W.right)&&(e={left:Math.max(e.left,W.left),right:Math.min(e.right,W.right),top:Math.max(e.top,W.top),bottom:Math.min(e.bottom,W.bottom)}),S=S.assignedSlot||S.parentNode}else if(S.nodeType==11)S=S.host;else break}function jt(o){let e=o.ownerDocument,t,i;for(let s=o.parentNode;s&&!(s==e.body||t&&i);)if(s.nodeType==1)!i&&s.scrollHeight>s.clientHeight&&(i=s),!t&&s.scrollWidth>s.clientWidth&&(t=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:t,y:i}}class Kt{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:i}=e;this.set(t,Math.min(e.anchorOffset,t?je(t):0),i,Math.min(e.focusOffset,i?je(i):0))}set(e,t,i,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=s}}let wt=null;function Ct(o){if(o.setActive)return o.setActive();if(wt)return o.focus(wt);let e=[];for(let t=o;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(o.focus(wt==null?{get preventScroll(){return wt={preventScroll:!0},!0}}:void 0),!wt){wt=!1;for(let t=0;t<e.length;){let i=e[t++],s=e[t++],a=e[t++];i.scrollTop!=s&&(i.scrollTop=s),i.scrollLeft!=a&&(i.scrollLeft=a)}}}let $t;function Tt(o,e,t=e){let i=$t||($t=document.createRange());return i.setEnd(o,t),i.setStart(o,e),i}function di(o,e,t,i){let s={key:e,code:e,keyCode:t,which:t,cancelable:!0};i&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=i);let a=new KeyboardEvent("keydown",s);a.synthetic=!0,o.dispatchEvent(a);let u=new KeyboardEvent("keyup",s);return u.synthetic=!0,o.dispatchEvent(u),a.defaultPrevented||u.defaultPrevented}function Yt(o){for(;o;){if(o&&(o.nodeType==9||o.nodeType==11&&o.host))return o;o=o.assignedSlot||o.parentNode}return null}function qt(o){for(;o.attributes.length;)o.removeAttributeNode(o.attributes[0])}function Me(o,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(i=Math.min(i,je(t));;)if(i){if(t.nodeType!=1)return!1;let s=t.childNodes[i-1];s.contentEditable=="false"?i--:(t=s,i=je(t))}else{if(t==o)return!0;i=Ne(t),t=t.parentNode}}function Pt(o){return o.scrollTop>Math.max(1,o.scrollHeight-o.clientHeight-4)}function Ke(o,e){for(let t=o,i=e;;){if(t.nodeType==3&&i>0)return{node:t,offset:i};if(t.nodeType==1&&i>0){if(t.contentEditable=="false")return null;t=t.childNodes[i-1],i=je(t)}else if(t.parentNode&&!qe(t))i=Ne(t),t=t.parentNode;else return null}}function oe(o,e){for(let t=o,i=e;;){if(t.nodeType==3&&i<t.nodeValue.length)return{node:t,offset:i};if(t.nodeType==1&&i<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[i],i=0}else if(t.parentNode&&!qe(t))i=Ne(t)+1,t=t.parentNode;else return null}}class pe{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new pe(e.parentNode,Ne(e),t)}static after(e,t){return new pe(e.parentNode,Ne(e)+1,t)}}const Oe=[];class fe{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let i=this.dom,s=null,a;for(let u of this.children){if(u.flags&7){if(!u.dom&&(a=s?s.nextSibling:i.firstChild)){let m=fe.get(a);(!m||!m.parent&&m.canReuseDOM(u))&&u.reuseDOM(a)}u.sync(e,t),u.flags&=-8}if(a=s?s.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&a!=u.dom&&(t.written=!0),u.dom.parentNode==i)for(;a&&a!=u.dom;)a=Je(a);else i.insertBefore(u.dom,a);s=u.dom}for(a=s?s.nextSibling:i.firstChild,a&&t&&t.node==i&&(t.written=!0);a;)a=Je(a)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,t),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let s=je(e)==0?0:t==0?-1:1;for(;;){let a=e.parentNode;if(a==this.dom)break;s==0&&a.firstChild!=a.lastChild&&(e==a.firstChild?s=-1:s=1),e=a}s<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!fe.get(i);)i=i.nextSibling;if(!i)return this.length;for(let s=0,a=0;;s++){let u=this.children[s];if(u.dom==i)return a;a+=u.length+u.breakAfter}}domBoundsAround(e,t,i=0){let s=-1,a=-1,u=-1,m=-1;for(let b=0,C=i,S=i;b<this.children.length;b++){let I=this.children[b],W=C+I.length;if(C<e&&W>t)return I.domBoundsAround(e,t,C);if(W>=e&&s==-1&&(s=b,a=C),C>t&&I.dom.parentNode==this.dom){u=b,m=S;break}S=W,C=W+I.breakAfter}return{from:a,to:m<0?i+this.length:m,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:u<this.children.length&&u>=0?this.children[u].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=Oe){this.markDirty();for(let s=e;s<t;s++){let a=this.children[s];a.parent==this&&i.indexOf(a)<0&&a.destroy()}i.length<250?this.children.splice(e,t-e,...i):this.children=[].concat(this.children.slice(0,e),i,this.children.slice(t));for(let s=0;s<i.length;s++)i[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new dt(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,i,s,a,u){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}fe.prototype.breakAfter=0;function Je(o){let e=o.nextSibling;return o.parentNode.removeChild(o),e}class dt{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function nt(o,e,t,i,s,a,u,m,b){let{children:C}=o,S=C.length?C[e]:null,I=a.length?a[a.length-1]:null,W=I?I.breakAfter:u;if(!(e==i&&S&&!u&&!W&&a.length<2&&S.merge(t,s,a.length?I:null,t==0,m,b))){if(i<C.length){let U=C[i];U&&(s<U.length||U.breakAfter&&I?.breakAfter)?(e==i&&(U=U.split(s),s=0),!W&&I&&U.merge(0,s,I,!0,0,b)?a[a.length-1]=U:((s||U.children.length&&!U.children[0].length)&&U.merge(0,s,null,!1,0,b),a.push(U))):U?.breakAfter&&(I?I.breakAfter=1:u=1),i++}for(S&&(S.breakAfter=u,t>0&&(!u&&a.length&&S.merge(t,S.length,a[0],!1,m,0)?S.breakAfter=a.shift().breakAfter:(t<S.length||S.children.length&&S.children[S.children.length-1].length==0)&&S.merge(t,S.length,null,!1,m,0),e++));e<i&&a.length;)if(C[i-1].become(a[a.length-1]))i--,a.pop(),b=a.length?0:m;else if(C[e].become(a[0]))e++,a.shift(),m=a.length?0:b;else break;!a.length&&e&&i<C.length&&!C[e-1].breakAfter&&C[i].merge(0,0,C[e-1],!1,m,b)&&e--,(e<i||a.length)&&o.replaceChildren(e,i,a)}}function Ve(o,e,t,i,s,a){let u=o.childCursor(),{i:m,off:b}=u.findPos(t,1),{i:C,off:S}=u.findPos(e,-1),I=e-t;for(let W of i)I+=W.length;o.length+=I,nt(o,C,S,m,b,i,0,s,a)}let Re=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Jt=typeof document<"u"?document:{documentElement:{style:{}}};const et=/Edge\/(\d+)/.exec(Re.userAgent),gt=/MSIE \d/.test(Re.userAgent),At=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Re.userAgent),bi=!!(gt||At||et),xi=!bi&&/gecko\/(\d+)/i.test(Re.userAgent),X=!bi&&/Chrome\/(\d+)/.exec(Re.userAgent),k="webkitFontSmoothing"in Jt.documentElement.style,O=!bi&&/Apple Computer/.test(Re.vendor),N=O&&(/Mobile\/\w+/.test(Re.userAgent)||Re.maxTouchPoints>2);var L={mac:N||/Mac/.test(Re.platform),windows:/Win/.test(Re.platform),linux:/Linux|X11/.test(Re.platform),ie:bi,ie_version:gt?Jt.documentMode||6:At?+At[1]:et?+et[1]:0,gecko:xi,gecko_version:xi?+(/Firefox\/(\d+)/.exec(Re.userAgent)||[0,0])[1]:0,chrome:!!X,chrome_version:X?+X[1]:0,ios:N,android:/Android\b/.test(Re.userAgent),webkit:k,safari:O,webkit_version:k?+(/\bAppleWebKit\/(\d+)/.exec(Re.userAgent)||[0,0])[1]:0,tabSize:Jt.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const $=256;class G extends fe{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return this.flags&8||i&&(!(i instanceof G)||this.length-(t-e)+i.length>$||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new G(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new pe(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return me(this.dom,e,t)}}class Q extends fe{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let s of t)s.setParent(this)}setAttrs(e){if(qt(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,i,s,a,u){return i&&(!(i instanceof Q&&i.mark.eq(this.mark))||e&&a<=0||t<this.length&&u<=0)?!1:(Ve(this,e,t,i?i.children.slice():[],a-1,u-1),this.markDirty(),!0)}split(e){let t=[],i=0,s=-1,a=0;for(let m of this.children){let b=i+m.length;b>e&&t.push(i<e?m.split(e-i):m),s<0&&i>=e&&(s=a),i=b,a++}let u=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new Q(this.mark,t,u)}domAtPos(e){return Ie(this,e)}coordsAt(e,t){return ot(this,e,t)}}function me(o,e,t){let i=o.nodeValue.length;e>i&&(e=i);let s=e,a=e,u=0;e==0&&t<0||e==i&&t>=0?L.chrome||L.gecko||(e?(s--,u=1):a<i&&(a++,u=-1)):t<0?s--:a<i&&a++;let m=Tt(o,s,a).getClientRects();if(!m.length)return null;let b=m[(u?u<0:t>=0)?0:m.length-1];return L.safari&&!u&&b.width==0&&(b=Array.prototype.find.call(m,C=>C.width)||b),u?ut(b,u<0):b||null}class be extends fe{static create(e,t,i){return new be(e,t,i)}constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}split(e){let t=be.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,i,s,a,u){return i&&(!(i instanceof be)||!this.widget.compare(i.widget)||e>0&&a<=0||t<this.length&&u<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e instanceof be&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return z.EY.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,i=t&&t.state.doc,s=this.posAtStart;return i?i.slice(s,s+this.length):z.EY.empty}domAtPos(e){return(this.length?e==0:this.side>0)?pe.before(this.dom):pe.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);if(i)return i;let s=this.dom.getClientRects(),a=null;if(!s.length)return null;let u=this.side?this.side<0:e>0;for(let m=u?s.length-1:0;a=s[m],!(e>0?m==0:m==s.length-1||a.top<a.bottom);m+=u?-1:1);return ut(a,!u)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class xe extends fe{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof xe&&e.side==this.side}split(){return new xe(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?pe.before(this.dom):pe.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return z.EY.empty}get isHidden(){return!0}}G.prototype.children=be.prototype.children=xe.prototype.children=Oe;function Ie(o,e){let t=o.dom,{children:i}=o,s=0;for(let a=0;s<i.length;s++){let u=i[s],m=a+u.length;if(!(m==a&&u.getSide()<=0)){if(e>a&&e<m&&u.dom.parentNode==t)return u.domAtPos(e-a);if(e<=a)break;a=m}}for(let a=s;a>0;a--){let u=i[a-1];if(u.dom.parentNode==t)return u.domAtPos(u.length)}for(let a=s;a<i.length;a++){let u=i[a];if(u.dom.parentNode==t)return u.domAtPos(0)}return new pe(t,0)}function _e(o,e,t){let i,{children:s}=o;t>0&&e instanceof Q&&s.length&&(i=s[s.length-1])instanceof Q&&i.mark.eq(e.mark)?_e(i,e.children[0],t-1):(s.push(e),e.setParent(o)),o.length+=e.length}function ot(o,e,t){let i=null,s=-1,a=null,u=-1;function m(C,S){for(let I=0,W=0;I<C.children.length&&W<=S;I++){let U=C.children[I],Y=W+U.length;Y>=S&&(U.children.length?m(U,S-W):(!a||a.isHidden&&(t>0||It(a,U)))&&(Y>S||W==Y&&U.getSide()>0)?(a=U,u=S-W):(W<S||W==Y&&U.getSide()<0&&!U.isHidden)&&(i=U,s=S-W)),W=Y}}m(o,e);let b=(t<0?i:a)||i||a;return b?b.coordsAt(Math.max(0,b==i?s:u),t):vt(o)}function vt(o){let e=o.dom.lastChild;if(!e)return o.dom.getBoundingClientRect();let t=Ee(e);return t[t.length-1]||null}function It(o,e){let t=o.coordsAt(0,1),i=e.coordsAt(0,1);return t&&i&&i.top<t.bottom}function Wt(o,e){for(let t in o)t=="class"&&e.class?e.class+=" "+o.class:t=="style"&&e.style?e.style+=";"+o.style:e[t]=o[t];return e}const ei=Object.create(null);function Lt(o,e,t){if(o==e)return!0;o||(o=ei),e||(e=ei);let i=Object.keys(o),s=Object.keys(e);if(i.length-(t&&i.indexOf(t)>-1?1:0)!=s.length-(t&&s.indexOf(t)>-1?1:0))return!1;for(let a of i)if(a!=t&&(s.indexOf(a)==-1||o[a]!==e[a]))return!1;return!0}function kt(o,e,t){let i=!1;if(e)for(let s in e)t&&s in t||(i=!0,s=="style"?o.style.cssText="":o.removeAttribute(s));if(t)for(let s in t)e&&e[s]==t[s]||(i=!0,s=="style"?o.style.cssText=t[s]:o.setAttribute(s,t[s]));return i}function ti(o){let e=Object.create(null);for(let t=0;t<o.attributes.length;t++){let i=o.attributes[t];e[i.name]=i.value}return e}class st{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var tt=function(o){return o[o.Text=0]="Text",o[o.WidgetBefore=1]="WidgetBefore",o[o.WidgetAfter=2]="WidgetAfter",o[o.WidgetRange=3]="WidgetRange",o}(tt||(tt={}));class ue extends z.FB{constructor(e,t,i,s){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=s}get heightRelevant(){return!1}static mark(e){return new Ue(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return t+=i&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new ct(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,s;if(e.isBlockGap)i=-5e8,s=4e8;else{let{start:a,end:u}=Xe(e,t);i=(a?t?-3e8:-1:5e8)-1,s=(u?t?2e8:1:-6e8)+1}return new ct(e,i,s,t,e.widget||null,!0)}static line(e){return new lt(e)}static set(e,t=!1){return z.om.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ue.none=z.om.empty;class Ue extends ue{constructor(e){let{start:t,end:i}=Xe(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,i;return this==e||e instanceof Ue&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&Lt(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Ue.prototype.point=!1;class lt extends ue{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof lt&&this.spec.class==e.spec.class&&Lt(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}lt.prototype.mapMode=z.iR.TrackBefore,lt.prototype.point=!0;class ct extends ue{constructor(e,t,i,s,a,u){super(t,i,a,e),this.block=s,this.isReplace=u,this.mapMode=s?t<=0?z.iR.TrackBefore:z.iR.TrackAfter:z.iR.TrackDel}get type(){return this.startSide!=this.endSide?tt.WidgetRange:this.startSide<=0?tt.WidgetBefore:tt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof ct&&Fe(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}ct.prototype.point=!0;function Xe(o,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=o;return t==null&&(t=o.inclusive),i==null&&(i=o.inclusive),{start:t??e,end:i??e}}function Fe(o,e){return o==e||!!(o&&e&&o.compare(e))}function ft(o,e,t,i=0){let s=t.length-1;s>=0&&t[s]+i>=o?t[s]=Math.max(t[s],e):t.push(o,e)}class Ge extends fe{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,s,a,u){if(i){if(!(i instanceof Ge))return!1;this.dom||i.transferDOM(this)}return s&&this.setDeco(i?i.attrs:null),Ve(this,e,t,i?i.children.slice():[],a,u),!0}split(e){let t=new Ge;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:s}=this.childPos(e);s&&(t.append(this.children[i].split(s),0),this.children[i].merge(s,this.children[i].length,null,!1,0,0),i++);for(let a=i;a<this.children.length;a++)t.append(this.children[a],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Lt(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){_e(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=Wt(t,this.attrs||{})),i&&(this.attrs=Wt({class:i},this.attrs||{}))}domAtPos(e){return Ie(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var i;this.dom?this.flags&4&&(qt(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(kt(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let s=this.dom.lastChild;for(;s&&fe.get(s)instanceof Q;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((i=fe.get(s))===null||i===void 0?void 0:i.isEditable)==!1&&(!L.ios||!this.children.some(a=>a instanceof G))){let a=document.createElement("BR");a.cmIgnore=!0,this.dom.appendChild(a)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let i of this.children){if(!(i instanceof G)||/[^ -~]/.test(i.text))return null;let s=Ee(i.dom);if(s.length!=1)return null;e+=s[0].width,t=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let i=ot(this,e,t);if(!this.children.length&&i&&this.parent){let{heightOracle:s}=this.parent.view.viewState,a=i.bottom-i.top;if(Math.abs(a-s.lineHeight)<2&&s.textHeight<a){let u=(a-s.textHeight)/2;return{top:i.top+u,bottom:i.bottom-u,left:i.left,right:i.left}}}return i}become(e){return e instanceof Ge&&this.children.length==0&&e.children.length==0&&Lt(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let i=0,s=0;i<e.children.length;i++){let a=e.children[i],u=s+a.length;if(u>=t){if(a instanceof Ge)return a;if(u>t)break}s=u+a.breakAfter}return null}}class pt extends fe{constructor(e,t,i){super(),this.widget=e,this.length=t,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,s,a,u){return i&&(!(i instanceof pt)||!this.widget.compare(i.widget)||e>0&&a<=0||t<this.length&&u<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?pe.before(this.dom):pe.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new pt(this.widget,t,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return Oe}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):z.EY.empty}domBoundsAround(){return null}become(e){return e instanceof pt&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);return i||(this.widget instanceof Ut?null:ut(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:i}=this.deco;return t==i?!1:e<0?t<0:i>0}}class Ut extends st{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Nt{constructor(e,t,i,s){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof pt&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ge),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(si(new xe(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof pt)&&this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:a,lineBreak:u,done:m}=this.cursor.next(this.skip);if(this.skip=0,m)throw new Error("Ran out of text content when drawing inline views");if(u){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=a,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-i)),this.getLine().append(si(new G(this.text.slice(this.textOff,this.textOff+s)),t),i),this.atCursorPos=!0,this.textOff+=s,e-=s,i=0}}span(e,t,i,s){this.buildText(t-e,i,s),this.pos=t,this.openStart<0&&(this.openStart=s)}point(e,t,i,s,a,u){if(this.disallowBlockEffectsFor[u]&&i instanceof ct){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let m=t-e;if(i instanceof ct)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new pt(i.widget||zt.block,m,i));else{let b=be.create(i.widget||zt.inline,m,m?0:i.startSide),C=this.atCursorPos&&!b.isEditable&&a<=s.length&&(e<t||i.startSide>0),S=!b.isEditable&&(e<t||a>s.length||i.startSide<=0),I=this.getLine();this.pendingBuffer==2&&!C&&!b.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),C&&(I.append(si(new xe(1),s),a),a=s.length+Math.max(0,a-s.length)),I.append(si(b,s),a),this.atCursorPos=S,this.pendingBuffer=S?e<t||a>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);m&&(this.textOff+m<=this.text.length?this.textOff+=m:(this.skip+=m-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=a)}static build(e,t,i,s,a){let u=new Nt(e,t,i,a);return u.openEnd=z.om.spans(s,t,i,u),u.openStart<0&&(u.openStart=u.openEnd),u.finish(u.openEnd),u}}function si(o,e){for(let t of e)o=new Q(t,[o],o.length);return o}class zt extends st{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}zt.inline=new zt("span"),zt.block=new zt("div");var yt=function(o){return o[o.LTR=0]="LTR",o[o.RTL=1]="RTL",o}(yt||(yt={}));const Bt=yt.LTR,Ze=yt.RTL;function Vt(o){let e=[];for(let t=0;t<o.length;t++)e.push(1<<+o[t]);return e}const ai=Vt("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),pi=Vt("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),wi=Object.create(null),ii=[];for(let o of["()","[]","{}"]){let e=o.charCodeAt(0),t=o.charCodeAt(1);wi[e]=t,wi[t]=-e}function Gt(o){return o<=247?ai[o]:1424<=o&&o<=1524?2:1536<=o&&o<=1785?pi[o-1536]:1774<=o&&o<=2220?4:8192<=o&&o<=8204?256:64336<=o&&o<=65023?4:1}const Tn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ri{get dir(){return this.level%2?Ze:Bt}constructor(e,t,i){this.from=e,this.to=t,this.level=i}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,i,s){let a=-1;for(let u=0;u<e.length;u++){let m=e[u];if(m.from<=t&&m.to>=t){if(m.level==i)return u;(a<0||(s!=0?s<0?m.from<t:m.to>t:e[a].level>m.level))&&(a=u)}}if(a<0)throw new RangeError("Index out of range");return a}}function cn(o,e){if(o.length!=e.length)return!1;for(let t=0;t<o.length;t++){let i=o[t],s=e[t];if(i.from!=s.from||i.to!=s.to||i.direction!=s.direction||!cn(i.inner,s.inner))return!1}return!0}const bt=[];function Ft(o,e,t,i,s){for(let a=0;a<=i.length;a++){let u=a?i[a-1].to:e,m=a<i.length?i[a].from:t,b=a?256:s;for(let C=u,S=b,I=b;C<m;C++){let W=Gt(o.charCodeAt(C));W==512?W=S:W==8&&I==4&&(W=16),bt[C]=W==4?2:W,W&7&&(I=W),S=W}for(let C=u,S=b,I=b;C<m;C++){let W=bt[C];if(W==128)C<m-1&&S==bt[C+1]&&S&24?W=bt[C]=S:bt[C]=256;else if(W==64){let U=C+1;for(;U<m&&bt[U]==64;)U++;let Y=C&&S==8||U<t&&bt[U]==8?I==1?1:8:256;for(let ee=C;ee<U;ee++)bt[ee]=Y;C=U-1}else W==8&&I==1&&(bt[C]=1);S=W,W&7&&(I=W)}}}function zi(o,e,t,i,s){let a=s==1?2:1;for(let u=0,m=0,b=0;u<=i.length;u++){let C=u?i[u-1].to:e,S=u<i.length?i[u].from:t;for(let I=C,W,U,Y;I<S;I++)if(U=wi[W=o.charCodeAt(I)])if(U<0){for(let ee=m-3;ee>=0;ee-=3)if(ii[ee+1]==-U){let re=ii[ee+2],se=re&2?s:re&4?re&1?a:s:0;se&&(bt[I]=bt[ii[ee]]=se),m=ee;break}}else{if(ii.length==189)break;ii[m++]=I,ii[m++]=W,ii[m++]=b}else if((Y=bt[I])==2||Y==1){let ee=Y==s;b=ee?0:1;for(let re=m-3;re>=0;re-=3){let se=ii[re+2];if(se&2)break;if(ee)ii[re+2]|=2;else{if(se&4)break;ii[re+2]|=4}}}}}function Bi(o,e,t,i){for(let s=0,a=i;s<=t.length;s++){let u=s?t[s-1].to:o,m=s<t.length?t[s].from:e;for(let b=u;b<m;){let C=bt[b];if(C==256){let S=b+1;for(;;)if(S==m){if(s==t.length)break;S=t[s++].to,m=s<t.length?t[s].from:e}else if(bt[S]==256)S++;else break;let I=a==1,W=(S<e?bt[S]:i)==1,U=I==W?I?1:2:i;for(let Y=S,ee=s,re=ee?t[ee-1].to:o;Y>b;)Y==re&&(Y=t[--ee].from,re=ee?t[ee-1].to:o),bt[--Y]=U;b=S}else a=C,b++}}}function Vi(o,e,t,i,s,a,u){let m=i%2?2:1;if(i%2==s%2)for(let b=e,C=0;b<t;){let S=!0,I=!1;if(C==a.length||b<a[C].from){let ee=bt[b];ee!=m&&(S=!1,I=ee==16)}let W=!S&&m==1?[]:null,U=S?i:i+1,Y=b;e:for(;;)if(C<a.length&&Y==a[C].from){if(I)break e;let ee=a[C];if(!S)for(let re=ee.to,se=C+1;;){if(re==t)break e;if(se<a.length&&a[se].from==re)re=a[se++].to;else{if(bt[re]==m)break e;break}}if(C++,W)W.push(ee);else{ee.from>b&&u.push(new ri(b,ee.from,U));let re=ee.direction==Bt!=!(U%2);Yi(o,re?i+1:i,s,ee.inner,ee.from,ee.to,u),b=ee.to}Y=ee.to}else{if(Y==t||(S?bt[Y]!=m:bt[Y]==m))break;Y++}W?Vi(o,b,Y,i+1,s,W,u):b<Y&&u.push(new ri(b,Y,U)),b=Y}else for(let b=t,C=a.length;b>e;){let S=!0,I=!1;if(!C||b>a[C-1].to){let ee=bt[b-1];ee!=m&&(S=!1,I=ee==16)}let W=!S&&m==1?[]:null,U=S?i:i+1,Y=b;e:for(;;)if(C&&Y==a[C-1].to){if(I)break e;let ee=a[--C];if(!S)for(let re=ee.from,se=C;;){if(re==e)break e;if(se&&a[se-1].to==re)re=a[--se].from;else{if(bt[re-1]==m)break e;break}}if(W)W.push(ee);else{ee.to<b&&u.push(new ri(ee.to,b,U));let re=ee.direction==Bt!=!(U%2);Yi(o,re?i+1:i,s,ee.inner,ee.from,ee.to,u),b=ee.from}Y=ee.from}else{if(Y==e||(S?bt[Y-1]!=m:bt[Y-1]==m))break;Y--}W?Vi(o,Y,b,i+1,s,W,u):Y<b&&u.push(new ri(Y,b,U)),b=Y}}function Yi(o,e,t,i,s,a,u){let m=e%2?2:1;Ft(o,s,a,i,m),zi(o,s,a,i,m),Bi(s,a,i,m),Vi(o,s,a,e,t,i,u)}function Ei(o,e,t){if(!o)return[new ri(0,0,e==Ze?1:0)];if(e==Bt&&!t.length&&!Tn.test(o))return Ri(o.length);if(t.length)for(;o.length>bt.length;)bt[bt.length]=256;let i=[],s=e==Bt?0:1;return Yi(o,s,s,t,0,o.length,i),i}function Ri(o){return[new ri(0,o,0)]}let Ii="";function _i(o,e,t,i,s){var a;let u=i.head-o.from,m=ri.find(e,u,(a=i.bidiLevel)!==null&&a!==void 0?a:-1,i.assoc),b=e[m],C=b.side(s,t);if(u==C){let W=m+=s?1:-1;if(W<0||W>=e.length)return null;b=e[m=W],u=b.side(!s,t),C=b.side(s,t)}let S=(0,z.zK)(o.text,u,b.forward(s,t));(S<b.from||S>b.to)&&(S=C),Ii=o.text.slice(Math.min(u,S),Math.max(u,S));let I=m==(s?e.length-1:0)?null:e[m+(s?1:-1)];return I&&S==C&&I.level+(s?0:1)<b.level?z.OF.cursor(I.side(!s,t)+o.from,I.forward(s,t)?1:-1,I.level):z.OF.cursor(S+o.from,b.forward(s,t)?-1:1,b.level)}function zn(o,e,t){for(let i=e;i<t;i++){let s=Gt(o.charCodeAt(i));if(s==1)return Bt;if(s==2||s==4)return Ze}return Bt}const B=z.sj.define(),h=z.sj.define(),d=z.sj.define(),y=z.sj.define(),v=z.sj.define(),D=z.sj.define(),T=z.sj.define(),H=z.sj.define(),_=z.sj.define(),Z=z.sj.define({combine:o=>o.some(e=>e)}),le=z.sj.define({combine:o=>o.some(e=>e)}),ce=z.sj.define();class ye{constructor(e,t="nearest",i="nearest",s=5,a=5,u=!1){this.range=e,this.y=t,this.x=i,this.yMargin=s,this.xMargin=a,this.isSnapshot=u}map(e){return e.empty?this:new ye(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new ye(z.OF.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const ve=z.Pe.define({map:(o,e)=>o.map(e)}),xt=z.Pe.define();function Et(o,e,t){let i=o.facet(y);i.length?i[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const mt=z.sj.define({combine:o=>o.length?o[0]:!0});let Ji=0;const Xi=z.sj.define({combine(o){return o.filter((e,t)=>{for(let i=0;i<t;i++)if(o[i].plugin==e.plugin)return!1;return!0})}});class Xt{constructor(e,t,i,s,a){this.id=e,this.create=t,this.domEventHandlers=i,this.domEventObservers=s,this.baseExtensions=a(this),this.extension=this.baseExtensions.concat(Xi.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(Xi.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:i,eventObservers:s,provide:a,decorations:u}=t||{};return new Xt(Ji++,e,i,s,m=>{let b=[];return u&&b.push(ji.of(C=>{let S=C.plugin(m);return S?u(S):ue.none})),a&&b.push(a(m)),b})}static fromClass(e,t){return Xt.define((i,s)=>new e(i,s),t)}}class Pn{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(Et(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){Et(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){Et(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Vn=z.sj.define(),Zi=z.sj.define(),ji=z.sj.define(),_n=z.sj.define(),fn=z.sj.define(),Hs=z.sj.define();function us(o,e){let t=o.state.facet(Hs);if(!t.length)return t;let i=t.map(a=>a instanceof Function?a(o):a),s=[];return z.om.spans(i,e.from,e.to,{point(){},span(a,u,m,b){let C=a-e.from,S=u-e.from,I=s;for(let W=m.length-1;W>=0;W--,b--){let U=m[W].spec.bidiIsolate,Y;if(U==null&&(U=zn(e.text,C,S)),b>0&&I.length&&(Y=I[I.length-1]).to==C&&Y.direction==U)Y.to=S,I=Y.inner;else{let ee={from:C,to:S,direction:U,inner:[]};I.push(ee),I=ee.inner}}}}),s}const jn=z.sj.define();function Ni(o){let e=0,t=0,i=0,s=0;for(let a of o.state.facet(jn)){let u=a(o);u&&(u.left!=null&&(e=Math.max(e,u.left)),u.right!=null&&(t=Math.max(t,u.right)),u.top!=null&&(i=Math.max(i,u.top)),u.bottom!=null&&(s=Math.max(s,u.bottom)))}return{left:e,right:t,top:i,bottom:s}}const Fi=z.sj.define();class A{constructor(e,t,i,s){this.fromA=e,this.toA=t,this.fromB=i,this.toB=s}join(e){return new A(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>i.toA)){if(s.toA<i.fromA)break;i=i.join(s),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let s=0,a=0,u=0,m=0;;s++){let b=s==e.length?null:e[s],C=u-m,S=b?b.fromB:1e9;for(;a<t.length&&t[a]<S;){let I=t[a],W=t[a+1],U=Math.max(m,I),Y=Math.min(S,W);if(U<=Y&&new A(U+C,Y+C,U,Y).addToSet(i),W>S)break;a+=2}if(!b)return i;new A(b.fromA,b.toA,b.fromB,b.toB).addToSet(i),u=b.toA,m=b.toB}}}class g{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=z.VR.empty(this.startState.doc.length);for(let a of i)this.changes=this.changes.compose(a.changes);let s=[];this.changes.iterChangedRanges((a,u,m,b)=>s.push(new A(a,u,m,b))),this.changedRanges=s}static create(e,t,i){return new g(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class w extends fe{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ue.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Ge],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new A(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:C,toA:S})=>S<this.minWidthFrom||C>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?s=this.domChanged.newSel.head:!Te(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let a=s>-1?V(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:C,to:S}=this.hasComposition;i=new A(C,S,e.changes.mapPos(C,-1),e.changes.mapPos(S,1)).addToSet(i.slice())}this.hasComposition=a?{from:a.range.fromB,to:a.range.toB}:null,(L.ie||L.chrome)&&!a&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let u=this.decorations,m=this.updateDeco(),b=ie(u,m,e.changes);return i=A.extendWithRanges(i,b),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,a),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,i);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let u=L.chrome||L.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,u),this.flags&=-8,u&&(u.written||s.selectionRange.focusNode!=u.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(u=>u.flags&=-9);let a=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let u of this.children)u instanceof pt&&u.widget instanceof Ut&&a.push(u.dom);s.updateGaps(a)}updateChildren(e,t,i){let s=i?i.range.addToSet(e.slice()):e,a=this.childCursor(t);for(let u=s.length-1;;u--){let m=u>=0?s[u]:null;if(!m)break;let{fromA:b,toA:C,fromB:S,toB:I}=m,W,U,Y,ee;if(i&&i.range.fromB<I&&i.range.toB>S){let De=Nt.build(this.view.state.doc,S,i.range.fromB,this.decorations,this.dynamicDecorationMap),He=Nt.build(this.view.state.doc,i.range.toB,I,this.decorations,this.dynamicDecorationMap);U=De.breakAtStart,Y=De.openStart,ee=He.openEnd;let We=this.compositionView(i);He.breakAtStart?We.breakAfter=1:He.content.length&&We.merge(We.length,We.length,He.content[0],!1,He.openStart,0)&&(We.breakAfter=He.content[0].breakAfter,He.content.shift()),De.content.length&&We.merge(0,0,De.content[De.content.length-1],!0,0,De.openEnd)&&De.content.pop(),W=De.content.concat(We).concat(He.content)}else({content:W,breakAtStart:U,openStart:Y,openEnd:ee}=Nt.build(this.view.state.doc,S,I,this.decorations,this.dynamicDecorationMap));let{i:re,off:se}=a.findPos(C,1),{i:Ce,off:Le}=a.findPos(b,-1);nt(this,Ce,Le,re,se,W,U,Y,ee)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let i of t.effects)i.is(xt)&&(this.editContextFormatting=i.value)}compositionView(e){let t=new G(e.text.nodeValue);t.flags|=8;for(let{deco:s}of e.marks)t=new Q(s,[t],t.length);let i=new Ge;return i.append(t,0),i}fixCompositionDOM(e){let t=(a,u)=>{u.flags|=8|(u.children.some(b=>b.flags&7)?1:0),this.markedForComposition.add(u);let m=fe.get(a);m&&m!=u&&(m.dom=null),u.setDOM(a)},i=this.childPos(e.range.fromB,1),s=this.children[i.i];t(e.line,s);for(let a=e.marks.length-1;a>=-1;a--)i=s.childPos(i.off,1),s=s.children[i.i],t(a>=0?e.marks[a].node:e.text,s)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,s=i==this.dom,a=!s&&!(this.view.state.facet(mt)||this.dom.tabIndex>-1)&&Pe(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(s||t||a))return;let u=this.forceSelection;this.forceSelection=!1;let m=this.view.state.selection.main,b=this.moveToLine(this.domAtPos(m.anchor)),C=m.empty?b:this.moveToLine(this.domAtPos(m.head));if(L.gecko&&m.empty&&!this.hasComposition&&P(b)){let I=document.createTextNode("");this.view.observer.ignore(()=>b.node.insertBefore(I,b.node.childNodes[b.offset]||null)),b=C=new pe(I,0),u=!0}let S=this.view.observer.selectionRange;(u||!S.focusNode||(!Se(b.node,b.offset,S.anchorNode,S.anchorOffset)||!Se(C.node,C.offset,S.focusNode,S.focusOffset))&&!this.suppressWidgetCursorChange(S,m))&&(this.view.observer.ignore(()=>{L.android&&L.chrome&&this.dom.contains(S.focusNode)&&ge(S.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let I=$e(this.view.root);if(I)if(m.empty){if(L.gecko){let W=j(b.node,b.offset);if(W&&W!=3){let U=(W==1?Ke:oe)(b.node,b.offset);U&&(b=new pe(U.node,U.offset))}}I.collapse(b.node,b.offset),m.bidiLevel!=null&&I.caretBidiLevel!==void 0&&(I.caretBidiLevel=m.bidiLevel)}else if(I.extend){I.collapse(b.node,b.offset);try{I.extend(C.node,C.offset)}catch{}}else{let W=document.createRange();m.anchor>m.head&&([b,C]=[C,b]),W.setEnd(C.node,C.offset),W.setStart(b.node,b.offset),I.removeAllRanges(),I.addRange(W)}a&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(b,C)),this.impreciseAnchor=b.precise?null:new pe(S.anchorNode,S.anchorOffset),this.impreciseHead=C.precise?null:new pe(S.focusNode,S.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&Se(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,i=$e(e.root),{anchorNode:s,anchorOffset:a}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let u=Ge.find(this,t.head);if(!u)return;let m=u.posAtStart;if(t.head==m||t.head==m+u.length)return;let b=this.coordsAt(t.head,-1),C=this.coordsAt(t.head,1);if(!b||!C||b.bottom>C.top)return;let S=this.domAtPos(t.head+t.assoc);i.collapse(S.node,S.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let I=e.observer.selectionRange;e.docView.posFromDOM(I.anchorNode,I.anchorOffset)!=t.from&&i.collapse(s,a)}moveToLine(e){let t=this.dom,i;if(e.node!=t)return e;for(let s=e.offset;!i&&s<t.childNodes.length;s++){let a=fe.get(t.childNodes[s]);a instanceof Ge&&(i=a.domAtPos(0))}for(let s=e.offset-1;!i&&s>=0;s--){let a=fe.get(t.childNodes[s]);a instanceof Ge&&(i=a.domAtPos(a.length))}return i?new pe(i.node,i.offset,!0):e}nearest(e){for(let t=e;t;){let i=fe.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let s=this.children[t];if(i<s.length||s instanceof Ge)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){let i=null,s=0;for(let a=this.length,u=this.children.length-1;u>=0;u--){let m=this.children[u],b=a-m.breakAfter,C=b-m.length;if(b<e)break;if(C<=e&&(C<e||m.covers(-1))&&(b>e||m.covers(1))&&(!i||m instanceof Ge&&!(i instanceof Ge&&t>=0)))i=m,s=C;else if(i&&C==e&&b==e&&m instanceof pt&&Math.abs(t)<2){if(m.deco.startSide<0)break;u&&(i=null)}a=C}return i?i.coordsAt(e-s,t):null}coordsForChar(e){let{i:t,off:i}=this.childPos(e,1),s=this.children[t];if(!(s instanceof Ge))return null;for(;s.children.length;){let{i:m,off:b}=s.childPos(i,1);for(;;m++){if(m==s.children.length)return null;if((s=s.children[m]).length)break}i=b}if(!(s instanceof G))return null;let a=(0,z.zK)(s.text,i);if(a==i)return null;let u=Tt(s.dom,i,a).getClientRects();for(let m=0;m<u.length;m++){let b=u[m];if(m==u.length-1||b.top<b.bottom&&b.left<b.right)return b}return null}measureVisibleLineHeights(e){let t=[],{from:i,to:s}=e,a=this.view.contentDOM.clientWidth,u=a>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,m=-1,b=this.view.textDirection==yt.LTR;for(let C=0,S=0;S<this.children.length;S++){let I=this.children[S],W=C+I.length;if(W>s)break;if(C>=i){let U=I.dom.getBoundingClientRect();if(t.push(U.height),u){let Y=I.dom.lastChild,ee=Y?Ee(Y):[];if(ee.length){let re=ee[ee.length-1],se=b?re.right-U.left:U.right-re.left;se>m&&(m=se,this.minWidth=a,this.minWidthFrom=C,this.minWidthTo=W)}}}C=W+I.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?yt.RTL:yt.LTR}measureTextSize(){for(let a of this.children)if(a instanceof Ge){let u=a.measureTextSize();if(u)return u}let e=document.createElement("div"),t,i,s;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let a=Ee(e.firstChild)[0];t=e.getBoundingClientRect().height,i=a?a.width/27:7,s=a?a.height:t,e.remove()}),{lineHeight:t,charWidth:i,textHeight:s}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new dt(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,s=0;;s++){let a=s==t.viewports.length?null:t.viewports[s],u=a?a.from-1:this.length;if(u>i){let m=(t.lineBlockAt(u).bottom-t.lineBlockAt(i).top)/this.view.scaleY;e.push(ue.replace({widget:new Ut(m),block:!0,inclusive:!0,isBlockGap:!0}).range(i,u))}if(!a)break;i=a.to+1}return ue.set(e)}updateDeco(){let e=1,t=this.view.state.facet(ji).map(a=>(this.dynamicDecorationMap[e++]=typeof a=="function")?a(this.view):a),i=!1,s=this.view.state.facet(_n).map((a,u)=>{let m=typeof a=="function";return m&&(i=!0),m?a(this.view):a});for(s.length&&(this.dynamicDecorationMap[e++]=i,t.push(z.om.join(s))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let C=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=C.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let C of this.view.state.facet(ce))try{if(C(this.view,e.range,e))return!0}catch(S){Et(this.view.state,S,"scroll handler")}let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!i)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,s.left),top:Math.min(i.top,s.top),right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)});let a=Ni(this.view),u={left:i.left-a.left,top:i.top-a.top,right:i.right+a.right,bottom:i.bottom+a.bottom},{offsetWidth:m,offsetHeight:b}=this.view.scrollDOM;at(this.view.scrollDOM,u,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,m),-m),Math.max(Math.min(e.yMargin,b),-b),this.view.textDirection==yt.LTR)}}function P(o){return o.node.nodeType==1&&o.node.firstChild&&(o.offset==0||o.node.childNodes[o.offset-1].contentEditable=="false")&&(o.offset==o.node.childNodes.length||o.node.childNodes[o.offset].contentEditable=="false")}function F(o,e){let t=o.observer.selectionRange;if(!t.focusNode)return null;let i=Ke(t.focusNode,t.focusOffset),s=oe(t.focusNode,t.focusOffset),a=i||s;if(s&&i&&s.node!=i.node){let m=fe.get(s.node);if(!m||m instanceof G&&m.text!=s.node.nodeValue)a=s;else if(o.docView.lastCompositionAfterCursor){let b=fe.get(i.node);!b||b instanceof G&&b.text!=i.node.nodeValue||(a=s)}}if(o.docView.lastCompositionAfterCursor=a!=i,!a)return null;let u=e-a.offset;return{from:u,to:u+a.node.nodeValue.length,node:a.node}}function V(o,e,t){let i=F(o,t);if(!i)return null;let{node:s,from:a,to:u}=i,m=s.nodeValue;if(/[\n\r]/.test(m)||o.state.doc.sliceString(i.from,i.to)!=m)return null;let b=e.invertedDesc,C=new A(b.mapPos(a),b.mapPos(u),a,u),S=[];for(let I=s.parentNode;;I=I.parentNode){let W=fe.get(I);if(W instanceof Q)S.push({node:I,deco:W.mark});else{if(W instanceof Ge||I.nodeName=="DIV"&&I.parentNode==o.contentDOM)return{range:C,text:s,marks:S,line:I};if(I!=o.contentDOM)S.push({node:I,deco:new Ue({inclusive:!0,attributes:ti(I),tagName:I.tagName.toLowerCase()})});else return null}}}function j(o,e){return o.nodeType!=1?0:(e&&o.childNodes[e-1].contentEditable=="false"?1:0)|(e<o.childNodes.length&&o.childNodes[e].contentEditable=="false"?2:0)}let ne=class{constructor(){this.changes=[]}compareRange(e,t){ft(e,t,this.changes)}comparePoint(e,t){ft(e,t,this.changes)}boundChange(e){ft(e,e,this.changes)}};function ie(o,e,t){let i=new ne;return z.om.compare(o,e,t,i),i.changes}function ge(o,e){for(let t=o;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function Te(o,e){let t=!1;return e&&o.iterChangedRanges((i,s)=>{i<e.to&&s>e.from&&(t=!0)}),t}function St(o,e,t=1){let i=o.charCategorizer(e),s=o.doc.lineAt(e),a=e-s.from;if(s.length==0)return z.OF.cursor(e);a==0?t=1:a==s.length&&(t=-1);let u=a,m=a;t<0?u=(0,z.zK)(s.text,a,!1):m=(0,z.zK)(s.text,a);let b=i(s.text.slice(u,m));for(;u>0;){let C=(0,z.zK)(s.text,u,!1);if(i(s.text.slice(C,u))!=b)break;u=C}for(;m<s.length;){let C=(0,z.zK)(s.text,m);if(i(s.text.slice(m,C))!=b)break;m=C}return z.OF.range(u+s.from,m+s.from)}function Si(o,e){return e.left>o?e.left-o:Math.max(0,o-e.right)}function vi(o,e){return e.top>o?e.top-o:Math.max(0,o-e.bottom)}function Ci(o,e){return o.top<e.bottom-1&&o.bottom>e.top+1}function Hi(o,e){return e<o.top?{top:e,left:o.left,right:o.right,bottom:o.bottom}:o}function ds(o,e){return e>o.bottom?{top:o.top,left:o.left,right:o.right,bottom:e}:o}function un(o,e,t){let i,s,a,u,m=!1,b,C,S,I;for(let Y=o.firstChild;Y;Y=Y.nextSibling){let ee=Ee(Y);for(let re=0;re<ee.length;re++){let se=ee[re];s&&Ci(s,se)&&(se=Hi(ds(se,s.bottom),s.top));let Ce=Si(e,se),Le=vi(t,se);if(Ce==0&&Le==0)return Y.nodeType==3?Ws(Y,e,t):un(Y,e,t);if(!i||u>Le||u==Le&&a>Ce){i=Y,s=se,a=Ce,u=Le;let De=Le?t<se.top?-1:1:Ce?e<se.left?-1:1:0;m=!De||(De>0?re<ee.length-1:re>0)}Ce==0?t>se.bottom&&(!S||S.bottom<se.bottom)?(b=Y,S=se):t<se.top&&(!I||I.top>se.top)&&(C=Y,I=se):S&&Ci(S,se)?S=ds(S,se.bottom):I&&Ci(I,se)&&(I=Hi(I,se.top))}}if(S&&S.bottom>=t?(i=b,s=S):I&&I.top<=t&&(i=C,s=I),!i)return{node:o,offset:0};let W=Math.max(s.left,Math.min(s.right,e));if(i.nodeType==3)return Ws(i,W,t);if(m&&i.contentEditable!="false")return un(i,W,t);let U=Array.prototype.indexOf.call(o.childNodes,i)+(e>=(s.left+s.right)/2?1:0);return{node:o,offset:U}}function Ws(o,e,t){let i=o.nodeValue.length,s=-1,a=1e9,u=0;for(let m=0;m<i;m++){let b=Tt(o,m,m+1).getClientRects();for(let C=0;C<b.length;C++){let S=b[C];if(S.top==S.bottom)continue;u||(u=e-S.left);let I=(S.top>t?S.top-t:t-S.bottom)-1;if(S.left-1<=e&&S.right+1>=e&&I<a){let W=e>=(S.left+S.right)/2,U=W;if((L.chrome||L.gecko)&&Tt(o,m).getBoundingClientRect().left==S.right&&(U=!W),I<=0)return{node:o,offset:m+(U?1:0)};s=m+(U?1:0),a=I}}}return{node:o,offset:s>-1?s:u>0?o.nodeValue.length:0}}function Cr(o,e,t,i=-1){var s,a;let u=o.contentDOM.getBoundingClientRect(),m=u.top+o.viewState.paddingTop,b,{docHeight:C}=o.viewState,{x:S,y:I}=e,W=I-m;if(W<0)return 0;if(W>C)return o.state.doc.length;for(let De=o.viewState.heightOracle.textHeight/2,He=!1;b=o.elementAtHeight(W),b.type!=tt.Text;)for(;W=i>0?b.bottom+De:b.top-De,!(W>=0&&W<=C);){if(He)return t?null:0;He=!0,i=-i}I=m+W;let U=b.from;if(U<o.viewport.from)return o.viewport.from==0?0:t?null:Ar(o,u,b,S,I);if(U>o.viewport.to)return o.viewport.to==o.state.doc.length?o.state.doc.length:t?null:Ar(o,u,b,S,I);let Y=o.dom.ownerDocument,ee=o.root.elementFromPoint?o.root:Y,re=ee.elementFromPoint(S,I);re&&!o.contentDOM.contains(re)&&(re=null),re||(S=Math.max(u.left+1,Math.min(u.right-1,S)),re=ee.elementFromPoint(S,I),re&&!o.contentDOM.contains(re)&&(re=null));let se,Ce=-1;if(re&&((s=o.docView.nearest(re))===null||s===void 0?void 0:s.isEditable)!=!1){if(Y.caretPositionFromPoint){let De=Y.caretPositionFromPoint(S,I);De&&({offsetNode:se,offset:Ce}=De)}else if(Y.caretRangeFromPoint){let De=Y.caretRangeFromPoint(S,I);De&&({startContainer:se,startOffset:Ce}=De,(!o.contentDOM.contains(se)||L.safari&&Io(se,Ce,S)||L.chrome&&Il(se,Ce,S))&&(se=void 0))}se&&(Ce=Math.min(je(se),Ce))}if(!se||!o.docView.dom.contains(se)){let De=Ge.find(o.docView,U);if(!De)return W>b.top+b.height/2?b.to:b.from;({node:se,offset:Ce}=un(De.dom,S,I))}let Le=o.docView.nearest(se);if(!Le)return null;if(Le.isWidget&&((a=Le.dom)===null||a===void 0?void 0:a.nodeType)==1){let De=Le.dom.getBoundingClientRect();return e.y<De.top||e.y<=De.bottom&&e.x<=(De.left+De.right)/2?Le.posAtStart:Le.posAtEnd}else return Le.localPosFromDOM(se,Ce)+Le.posAtStart}function Ar(o,e,t,i,s){let a=Math.round((i-e.left)*o.defaultCharacterWidth);if(o.lineWrapping&&t.height>o.defaultLineHeight*1.5){let m=o.viewState.heightOracle.textHeight,b=Math.floor((s-t.top-(o.defaultLineHeight-m)*.5)/m);a+=b*o.viewState.heightOracle.lineLength}let u=o.state.sliceDoc(t.from,t.to);return t.from+(0,z.kn)(u,a,o.state.tabSize)}function Io(o,e,t){let i;if(o.nodeType!=3||e!=(i=o.nodeValue.length))return!1;for(let s=o.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return Tt(o,i-1,i).getBoundingClientRect().left>t}function Il(o,e,t){if(e!=0)return!1;for(let s=o;;){let a=s.parentNode;if(!a||a.nodeType!=1||a.firstChild!=s)return!1;if(a.classList.contains("cm-line"))break;s=a}let i=o.nodeType==1?o.getBoundingClientRect():Tt(o,0,Math.max(o.nodeValue.length,1)).getBoundingClientRect();return t-i.left>5}function Mr(o,e,t){let i=o.lineBlockAt(e);if(Array.isArray(i.type)){let s;for(let a of i.type){if(a.from>e)break;if(!(a.to<e)){if(a.from<e&&a.to>e)return a;(!s||a.type==tt.Text&&(s.type!=a.type||(t<0?a.from<e:a.to>e)))&&(s=a)}}return s||i}return i}function No(o,e,t,i){let s=Mr(o,e.head,e.assoc||-1),a=!i||s.type!=tt.Text||!(o.lineWrapping||s.widgetLineBreaks)?null:o.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(a){let u=o.dom.getBoundingClientRect(),m=o.textDirectionAt(s.from),b=o.posAtCoords({x:t==(m==yt.LTR)?u.right-1:u.left+1,y:(a.top+a.bottom)/2});if(b!=null)return z.OF.cursor(b,t?-1:1)}return z.OF.cursor(t?s.to:s.from,t?-1:1)}function zs(o,e,t,i){let s=o.state.doc.lineAt(e.head),a=o.bidiSpans(s),u=o.textDirectionAt(s.from);for(let m=e,b=null;;){let C=_i(s,a,u,m,t),S=Ii;if(!C){if(s.number==(t?o.state.doc.lines:1))return m;S=`
`,s=o.state.doc.line(s.number+(t?1:-1)),a=o.bidiSpans(s),C=o.visualLineSide(s,!t)}if(b){if(!b(S))return m}else{if(!i)return C;b=i(S)}m=C}}function Fo(o,e,t){let i=o.state.charCategorizer(e),s=i(t);return a=>{let u=i(a);return s==z.Je.Space&&(s=u),s==u}}function Or(o,e,t,i){let s=e.head,a=t?1:-1;if(s==(t?o.state.doc.length:0))return z.OF.cursor(s,e.assoc);let u=e.goalColumn,m,b=o.contentDOM.getBoundingClientRect(),C=o.coordsAtPos(s,e.assoc||-1),S=o.documentTop;if(C)u==null&&(u=C.left-b.left),m=a<0?C.top:C.bottom;else{let U=o.viewState.lineBlockAt(s);u==null&&(u=Math.min(b.right-b.left,o.defaultCharacterWidth*(s-U.from))),m=(a<0?U.top:U.bottom)+S}let I=b.left+u,W=i??o.viewState.heightOracle.textHeight>>1;for(let U=0;;U+=10){let Y=m+(W+U)*a,ee=Cr(o,{x:I,y:Y},!1,a);if(Y<b.top||Y>b.bottom||(a<0?ee<s:ee>s)){let re=o.docView.coordsForChar(ee),se=!re||Y<re.top?-1:1;return z.OF.cursor(ee,se,void 0,u)}}}function Ln(o,e,t){for(;;){let i=0;for(let s of o)s.between(e-1,e+1,(a,u,m)=>{if(e>a&&e<u){let b=i||t||(e-a<u-e?-1:1);e=b<0?a:u,i=b}});if(!i)return e}}function Vs(o,e,t){let i=Ln(o.state.facet(fn).map(s=>s(o)),t.from,e.head>t.from?-1:1);return i==t.from?t:z.OF.cursor(i,i<t.from?1:-1)}const dn="\uFFFF";class Dr{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(z.$t.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=dn}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let s=e;;){this.findPointBefore(i,s);let a=this.text.length;this.readNode(s);let u=s.nextSibling;if(u==t)break;let m=fe.get(s),b=fe.get(u);(m&&b?m.breakAfter:(m?m.breakAfter:qe(s))||qe(u)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>a)&&this.lineBreak(),s=u}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let a=-1,u=1,m;if(this.lineSeparator?(a=t.indexOf(this.lineSeparator,i),u=this.lineSeparator.length):(m=s.exec(t))&&(a=m.index,u=m[0].length),this.append(t.slice(i,a<0?t.length:a)),a<0)break;if(this.lineBreak(),u>1)for(let b of this.points)b.node==e&&b.pos>this.text.length&&(b.pos-=u-1);i=a+u}}readNode(e){if(e.cmIgnore)return;let t=fe.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let s=i.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(Ho(e,i.node,i.offset)?t:0))}}function Ho(o,e,t){for(;;){if(!e||t<je(e))return!1;if(e==o)return!0;t=Ne(e)+1,e=e.parentNode}}class Wo{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class Nl{constructor(e,t,i,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:a,impreciseAnchor:u}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,i,0))){let m=a||u?[]:Mt(e),b=new Dr(m,e.state);b.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=b.text,this.newSel=Pr(m,this.bounds.from)}else{let m=e.observer.selectionRange,b=a&&a.node==m.focusNode&&a.offset==m.focusOffset||!we(e.contentDOM,m.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(m.focusNode,m.focusOffset),C=u&&u.node==m.anchorNode&&u.offset==m.anchorOffset||!we(e.contentDOM,m.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(m.anchorNode,m.anchorOffset),S=e.viewport;if((L.ios||L.chrome)&&e.state.selection.main.empty&&b!=C&&(S.from>0||S.to<e.state.doc.length)){let I=Math.min(b,C),W=Math.max(b,C),U=S.from-I,Y=S.to-W;(U==0||U==1||I==0)&&(Y==0||Y==-1||W==e.state.doc.length)&&(b=0,C=e.state.doc.length)}this.newSel=z.OF.single(C,b)}}}function Tr(o,e){let t,{newSel:i}=e,s=o.state.selection.main,a=o.inputState.lastKeyTime>Date.now()-100?o.inputState.lastKeyCode:-1;if(e.bounds){let{from:u,to:m}=e.bounds,b=s.from,C=null;(a===8||L.android&&e.text.length<m-u)&&(b=s.to,C="end");let S=Vo(o.state.doc.sliceString(u,m,dn),e.text,b-u,C);S&&(L.chrome&&a==13&&S.toB==S.from+2&&e.text.slice(S.from,S.toB)==dn+dn&&S.toB--,t={from:u+S.from,to:u+S.toA,insert:z.EY.of(e.text.slice(S.from,S.toB).split(dn))})}else i&&(!o.hasFocus&&o.state.facet(mt)||i.main.eq(s))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!s.empty&&i&&i.main.empty?t={from:s.from,to:s.to,insert:o.state.doc.slice(s.from,s.to)}:(L.mac||L.android)&&t&&t.from==t.to&&t.from==s.head-1&&/^\. ?$/.test(t.insert.toString())&&o.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=z.OF.single(i.main.anchor-1,i.main.head-1)),t={from:t.from,to:t.to,insert:z.EY.of([t.insert.toString().replace("."," ")])}):t&&t.from>=s.from&&t.to<=s.to&&(t.from!=s.from||t.to!=s.to)&&s.to-s.from-(t.to-t.from)<=4?t={from:s.from,to:s.to,insert:o.state.doc.slice(s.from,t.from).append(t.insert).append(o.state.doc.slice(t.to,s.to))}:L.chrome&&t&&t.from==t.to&&t.from==s.head&&t.insert.toString()==`
 `&&o.lineWrapping&&(i&&(i=z.OF.single(i.main.anchor-1,i.main.head-1)),t={from:s.from,to:s.to,insert:z.EY.of([" "])}),t)return _s(o,t,i,a);if(i&&!i.main.eq(s)){let u=!1,m="select";return o.inputState.lastSelectionTime>Date.now()-50&&(o.inputState.lastSelectionOrigin=="select"&&(u=!0),m=o.inputState.lastSelectionOrigin),o.dispatch({selection:i,scrollIntoView:u,userEvent:m}),!0}else return!1}function _s(o,e,t,i=-1){if(L.ios&&o.inputState.flushIOSKey(e))return!0;let s=o.state.selection.main;if(L.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&o.state.sliceDoc(e.from,s.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&di(o.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>s.head)&&di(o.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&e.insert.length==0&&di(o.contentDOM,"Delete",46)))return!0;let a=e.insert.toString();o.inputState.composing>=0&&o.inputState.composing++;let u,m=()=>u||(u=zo(o,e,t));return o.state.facet(D).some(b=>b(o,e.from,e.to,a,m))||o.dispatch(m()),!0}function zo(o,e,t){let i,s=o.state,a=s.selection.main;if(e.from>=a.from&&e.to<=a.to&&e.to-e.from>=(a.to-a.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&o.inputState.composing<0){let m=a.from<e.from?s.sliceDoc(a.from,e.from):"",b=a.to>e.to?s.sliceDoc(e.to,a.to):"";i=s.replaceSelection(o.state.toText(m+e.insert.sliceString(0,void 0,o.state.lineBreak)+b))}else{let m=s.changes(e),b=t&&t.main.to<=m.newLength?t.main:void 0;if(s.selection.ranges.length>1&&o.inputState.composing>=0&&e.to<=a.to&&e.to>=a.to-10){let C=o.state.sliceDoc(e.from,e.to),S,I=t&&F(o,t.main.head);if(I){let Y=e.insert.length-(e.to-e.from);S={from:I.from,to:I.to-Y}}else S=o.state.doc.lineAt(a.head);let W=a.to-e.to,U=a.to-a.from;i=s.changeByRange(Y=>{if(Y.from==a.from&&Y.to==a.to)return{changes:m,range:b||Y.map(m)};let ee=Y.to-W,re=ee-C.length;if(Y.to-Y.from!=U||o.state.sliceDoc(re,ee)!=C||Y.to>=S.from&&Y.from<=S.to)return{range:Y};let se=s.changes({from:re,to:ee,insert:e.insert}),Ce=Y.to-a.to;return{changes:se,range:b?z.OF.range(Math.max(0,b.anchor+Ce),Math.max(0,b.head+Ce)):Y.map(se)}})}else i={changes:m,selection:b&&s.selection.replaceRange(b)}}let u="input.type";return(o.composing||o.inputState.compositionPendingChange&&o.inputState.compositionEndedAt>Date.now()-50)&&(o.inputState.compositionPendingChange=!1,u+=".compose",o.inputState.compositionFirstChange&&(u+=".start",o.inputState.compositionFirstChange=!1)),s.update(i,{userEvent:u,scrollIntoView:!0})}function Vo(o,e,t,i){let s=Math.min(o.length,e.length),a=0;for(;a<s&&o.charCodeAt(a)==e.charCodeAt(a);)a++;if(a==s&&o.length==e.length)return null;let u=o.length,m=e.length;for(;u>0&&m>0&&o.charCodeAt(u-1)==e.charCodeAt(m-1);)u--,m--;if(i=="end"){let b=Math.max(0,a-Math.min(u,m));t-=u+b-a}if(u<a&&o.length<e.length){let b=t<=a&&t>=u?a-t:0;a-=b,m=a+(m-u),u=a}else if(m<a){let b=t<=a&&t>=m?a-t:0;a-=b,u=a+(u-m),m=a}return{from:a,toA:u,toB:m}}function Mt(o){let e=[];if(o.root.activeElement!=o.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:a}=o.observer.selectionRange;return t&&(e.push(new Wo(t,i)),(s!=t||a!=i)&&e.push(new Wo(s,a))),e}function Pr(o,e){if(o.length==0)return null;let t=o[0].pos,i=o.length==2?o[1].pos:t;return t>-1&&i>-1?z.OF.single(t+e,i+e):null}class Lr{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,L.safari&&e.contentDOM.addEventListener("input",()=>null),L.gecko&&Gn(e.contentDOM.ownerDocument)}handleEvent(e){!jo(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let i=this.handlers[e];if(i){for(let s of i.observers)s(this.view,t);for(let s of i.handlers){if(t.defaultPrevented)break;if(s(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=Br(e),i=this.handlers,s=this.view.contentDOM;for(let a in t)if(a!="scroll"){let u=!t[a].handlers.length,m=i[a];m&&u!=!m.handlers.length&&(s.removeEventListener(a,this.handleEvent),m=null),m||s.addEventListener(a,this.handleEvent,{passive:u})}for(let a in i)a!="scroll"&&!t[a]&&s.removeEventListener(a,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&ms.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),L.android&&L.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return L.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=ps.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||Er.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,di(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:L.safari&&!L.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function pn(o,e){return(t,i)=>{try{return e.call(o,i,t)}catch(s){Et(t.state,s)}}}function Br(o){let e=Object.create(null);function t(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of o){let s=i.spec,a=s&&s.plugin.domEventHandlers,u=s&&s.plugin.domEventObservers;if(a)for(let m in a){let b=a[m];b&&t(m).handlers.push(pn(i.value,b))}if(u)for(let m in u){let b=u[m];b&&t(m).observers.push(pn(i.value,b))}}for(let i in Pi)t(i).handlers.push(Pi[i]);for(let i in Oi)t(i).observers.push(Oi[i]);return e}const ps=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Er="dthko",ms=[16,17,18,20,91,92,224,225],Ki=6;function Kn(o){return Math.max(0,o)*.7+8}function _o(o,e){return Math.max(Math.abs(o.clientX-e.clientX),Math.abs(o.clientY-e.clientY))}class gs{constructor(e,t,i,s){this.view=e,this.startEvent=t,this.style=i,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=jt(e.contentDOM),this.atoms=e.state.facet(fn).map(u=>u(e));let a=e.contentDOM.ownerDocument;a.addEventListener("mousemove",this.move=this.move.bind(this)),a.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(z.$t.allowMultipleSelections)&&js(e,t),this.dragging=Rr(e,t)&&Uo(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&_o(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,i=0,s=0,a=0,u=this.view.win.innerWidth,m=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:u}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:a,bottom:m}=this.scrollParents.y.getBoundingClientRect());let b=Ni(this.view);e.clientX-b.left<=s+Ki?t=-Kn(s-e.clientX):e.clientX+b.right>=u-Ki&&(t=Kn(e.clientX-u)),e.clientY-b.top<=a+Ki?i=-Kn(a-e.clientY):e.clientY+b.bottom>=m-Ki&&(i=Kn(e.clientY-m)),this.setScrollSpeed(t,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let i=0;i<e.ranges.length;i++){let s=e.ranges[i],a=null;if(s.empty){let u=Ln(this.atoms,s.from,0);u!=s.from&&(a=z.OF.cursor(u,-1))}else{let u=Ln(this.atoms,s.from,-1),m=Ln(this.atoms,s.to,1);(u!=s.from||m!=s.to)&&(a=z.OF.range(s.from==s.anchor?u:m,s.from==s.head?u:m))}a&&(t||(t=e.ranges.slice()),t[i]=a)}return t?z.OF.create(t,e.mainIndex):e}select(e){let{view:t}=this,i=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function js(o,e){let t=o.state.facet(B);return t.length?t[0](e):L.mac?e.metaKey:e.ctrlKey}function $n(o,e){let t=o.state.facet(h);return t.length?t[0](e):L.mac?!e.altKey:!e.ctrlKey}function Rr(o,e){let{main:t}=o.state.selection;if(t.empty)return!1;let i=$e(o.root);if(!i||i.rangeCount==0)return!0;let s=i.getRangeAt(0).getClientRects();for(let a=0;a<s.length;a++){let u=s[a];if(u.left<=e.clientX&&u.right>=e.clientX&&u.top<=e.clientY&&u.bottom>=e.clientY)return!0}return!1}function jo(o,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=o.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=fe.get(t))&&i.ignoreEvent(e))return!1;return!0}const Pi=Object.create(null),Oi=Object.create(null),Ks=L.ie&&L.ie_version<15||L.ios&&L.webkit_version<604;function Ko(o){let e=o.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{o.focus(),t.remove(),Ir(o,t.value)},50)}function ys(o,e,t){for(let i of o.facet(e))t=i(t,o);return t}function Ir(o,e){e=ys(o.state,H,e);let{state:t}=o,i,s=1,a=t.toText(e),u=a.lines==t.selection.ranges.length;if(en!=null&&t.selection.ranges.every(b=>b.empty)&&en==a.toString()){let b=-1;i=t.changeByRange(C=>{let S=t.doc.lineAt(C.from);if(S.from==b)return{range:C};b=S.from;let I=t.toText((u?a.line(s++).text:e)+t.lineBreak);return{changes:{from:S.from,insert:I},range:z.OF.cursor(C.from+I.length)}})}else u?i=t.changeByRange(b=>{let C=a.line(s++);return{changes:{from:b.from,to:b.to,insert:C.text},range:z.OF.cursor(b.from+C.length)}}):i=t.replaceSelection(a);o.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Oi.scroll=o=>{o.inputState.lastScrollTop=o.scrollDOM.scrollTop,o.inputState.lastScrollLeft=o.scrollDOM.scrollLeft},Pi.keydown=(o,e)=>(o.inputState.setSelectionOrigin("select"),e.keyCode==27&&o.inputState.tabFocusMode!=0&&(o.inputState.tabFocusMode=Date.now()+2e3),!1),Oi.touchstart=(o,e)=>{o.inputState.lastTouchTime=Date.now(),o.inputState.setSelectionOrigin("select.pointer")},Oi.touchmove=o=>{o.inputState.setSelectionOrigin("select.pointer")},Pi.mousedown=(o,e)=>{if(o.observer.flush(),o.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let i of o.state.facet(d))if(t=i(o,e),t)break;if(!t&&e.button==0&&(t=zr(o,e)),t){let i=!o.hasFocus;o.inputState.startMouseSelection(new gs(o,e,t,i)),i&&o.observer.ignore(()=>{Ct(o.contentDOM);let a=o.root.activeElement;a&&!a.contains(o.contentDOM)&&a.blur()});let s=o.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}return!1};function $s(o,e,t,i){if(i==1)return z.OF.cursor(e,t);if(i==2)return St(o.state,e,t);{let s=Ge.find(o.docView,e),a=o.state.doc.lineAt(s?s.posAtEnd:e),u=s?s.posAtStart:a.from,m=s?s.posAtEnd:a.to;return m<o.state.doc.length&&m==a.to&&m++,z.OF.range(u,m)}}let Nr=(o,e,t)=>e>=t.top&&e<=t.bottom&&o>=t.left&&o<=t.right;function $o(o,e,t,i){let s=Ge.find(o.docView,e);if(!s)return 1;let a=e-s.posAtStart;if(a==0)return 1;if(a==s.length)return-1;let u=s.coordsAt(a,-1);if(u&&Nr(t,i,u))return-1;let m=s.coordsAt(a,1);return m&&Nr(t,i,m)?1:u&&u.bottom>=i?-1:1}function Fr(o,e){let t=o.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:$o(o,t,e.clientX,e.clientY)}}const qo=L.ie&&L.ie_version<=11;let Hr=null,Wr=0,Qi=0;function Uo(o){if(!qo)return o.detail;let e=Hr,t=Qi;return Hr=o,Qi=Date.now(),Wr=!e||t>Date.now()-400&&Math.abs(e.clientX-o.clientX)<2&&Math.abs(e.clientY-o.clientY)<2?(Wr+1)%3:1}function zr(o,e){let t=Fr(o,e),i=Uo(e),s=o.state.selection;return{update(a){a.docChanged&&(t.pos=a.changes.mapPos(t.pos),s=s.map(a.changes))},get(a,u,m){let b=Fr(o,a),C,S=$s(o,b.pos,b.bias,i);if(t.pos!=b.pos&&!u){let I=$s(o,t.pos,t.bias,i),W=Math.min(I.from,S.from),U=Math.max(I.to,S.to);S=W<S.from?z.OF.range(W,U):z.OF.range(U,W)}return u?s.replaceRange(s.main.extend(S.from,S.to)):m&&i==1&&s.ranges.length>1&&(C=Vr(s,b.pos))?C:m?s.addRange(S):z.OF.create([S])}}}function Vr(o,e){for(let t=0;t<o.ranges.length;t++){let{from:i,to:s}=o.ranges[t];if(i<=e&&s>=e)return z.OF.create(o.ranges.slice(0,t).concat(o.ranges.slice(t+1)),o.mainIndex==t?0:o.mainIndex-(o.mainIndex>t?1:0))}return null}Pi.dragstart=(o,e)=>{let{selection:{main:t}}=o.state;if(e.target.draggable){let s=o.docView.nearest(e.target);if(s&&s.isWidget){let a=s.posAtStart,u=a+s.length;(a>=t.to||u<=t.from)&&(t=z.OF.range(a,u))}}let{inputState:i}=o;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",ys(o.state,_,o.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1},Pi.dragend=o=>(o.inputState.draggedContent=null,!1);function mn(o,e,t,i){if(t=ys(o.state,H,t),!t)return;let s=o.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:a}=o.inputState,u=i&&a&&$n(o,e)?{from:a.from,to:a.to}:null,m={from:s,insert:t},b=o.state.changes(u?[u,m]:m);o.focus(),o.dispatch({changes:b,selection:{anchor:b.mapPos(s,-1),head:b.mapPos(s,1)},userEvent:u?"move.drop":"input.drop"}),o.inputState.draggedContent=null}Pi.drop=(o,e)=>{if(!e.dataTransfer)return!1;if(o.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let i=Array(t.length),s=0,a=()=>{++s==t.length&&mn(o,e,i.filter(u=>u!=null).join(o.state.lineBreak),!1)};for(let u=0;u<t.length;u++){let m=new FileReader;m.onerror=a,m.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(m.result)||(i[u]=m.result),a()},m.readAsText(t[u])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return mn(o,e,i,!0),!0}return!1},Pi.paste=(o,e)=>{if(o.state.readOnly)return!0;o.observer.flush();let t=Ks?null:e.clipboardData;return t?(Ir(o,t.getData("text/plain")||t.getData("text/uri-list")),!0):(Ko(o),!1)};function Go(o,e){let t=o.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),o.focus()},50)}function Yo(o){let e=[],t=[],i=!1;for(let s of o.selection.ranges)s.empty||(e.push(o.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:a}of o.selection.ranges){let u=o.doc.lineAt(a);u.number>s&&(e.push(u.text),t.push({from:u.from,to:Math.min(o.doc.length,u.to+1)})),s=u.number}i=!0}return{text:ys(o,_,e.join(o.lineBreak)),ranges:t,linewise:i}}let en=null;Pi.copy=Pi.cut=(o,e)=>{let{text:t,ranges:i,linewise:s}=Yo(o.state);if(!t&&!s)return!1;en=s?t:null,e.type=="cut"&&!o.state.readOnly&&o.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let a=Ks?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",t),!0):(Go(o,t),!1)};const qn=z.YH.define();function Un(o,e){let t=[];for(let i of o.facet(T)){let s=i(o,e);s&&t.push(s)}return t.length?o.update({effects:t,annotations:qn.of(!0)}):null}function _r(o){setTimeout(()=>{let e=o.hasFocus;if(e!=o.inputState.notifiedFocused){let t=Un(o.state,e);t?o.dispatch(t):o.update([])}},10)}Oi.focus=o=>{o.inputState.lastFocusTime=Date.now(),!o.scrollDOM.scrollTop&&(o.inputState.lastScrollTop||o.inputState.lastScrollLeft)&&(o.scrollDOM.scrollTop=o.inputState.lastScrollTop,o.scrollDOM.scrollLeft=o.inputState.lastScrollLeft),_r(o)},Oi.blur=o=>{o.observer.clearSelectionRange(),_r(o)},Oi.compositionstart=Oi.compositionupdate=o=>{o.observer.editContext||(o.inputState.compositionFirstChange==null&&(o.inputState.compositionFirstChange=!0),o.inputState.composing<0&&(o.inputState.composing=0))},Oi.compositionend=o=>{o.observer.editContext||(o.inputState.composing=-1,o.inputState.compositionEndedAt=Date.now(),o.inputState.compositionPendingKey=!0,o.inputState.compositionPendingChange=o.observer.pendingRecords().length>0,o.inputState.compositionFirstChange=null,L.chrome&&L.android?o.observer.flushSoon():o.inputState.compositionPendingChange?Promise.resolve().then(()=>o.observer.flush()):setTimeout(()=>{o.inputState.composing<0&&o.docView.hasComposition&&o.update([])},50))},Oi.contextmenu=o=>{o.inputState.lastContextMenu=Date.now()},Pi.beforeinput=(o,e)=>{var t,i;if(e.inputType=="insertReplacementText"&&o.observer.editContext){let a=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),u=e.getTargetRanges();if(a&&u.length){let m=u[0],b=o.posAtDOM(m.startContainer,m.startOffset),C=o.posAtDOM(m.endContainer,m.endOffset);return _s(o,{from:b,to:C,insert:o.state.toText(a)},null),!0}}let s;if(L.chrome&&L.android&&(s=ps.find(a=>a.inputType==e.inputType))&&(o.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let a=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var u;(((u=window.visualViewport)===null||u===void 0?void 0:u.height)||0)>a+10&&o.hasFocus&&(o.contentDOM.blur(),o.focus())},100)}return L.ios&&e.inputType=="deleteContentForward"&&o.observer.flushSoon(),L.safari&&e.inputType=="insertText"&&o.inputState.composing>=0&&setTimeout(()=>Oi.compositionend(o,e),20),!1};const jr=new Set;function Gn(o){jr.has(o)||(jr.add(o),o.addEventListener("copy",()=>{}),o.addEventListener("cut",()=>{}))}const bs=["pre-wrap","normal","pre-line","break-spaces"];let mi=!1;function Kr(){mi=!1}class Jo{constructor(e){this.lineWrapping=e,this.doc=z.EY.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return bs.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let s=e[i];s<0?i++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,i,s,a,u){let m=bs.indexOf(e)>-1,b=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=m;if(this.lineWrapping=m,this.lineHeight=t,this.charWidth=i,this.textHeight=s,this.lineLength=a,b){this.heightSamples={};for(let C=0;C<u.length;C++){let S=u[C];S<0?C++:this.heightSamples[Math.floor(S*10)]=!0}}return b}}class xs{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Wi{constructor(e,t,i,s,a){this.from=e,this.length=t,this.top=i,this.height=s,this._content=a}get type(){return typeof this._content=="number"?tt.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ct?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Wi(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Dt=function(o){return o[o.ByPos=0]="ByPos",o[o.ByHeight=1]="ByHeight",o[o.ByPosNoHeight=2]="ByPosNoHeight",o}(Dt||(Dt={}));const ws=.001;class Zt{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>ws&&(mi=!0),this.height=e)}replace(e,t,i){return Zt.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,s){let a=this,u=i.doc;for(let m=s.length-1;m>=0;m--){let{fromA:b,toA:C,fromB:S,toB:I}=s[m],W=a.lineAt(b,Dt.ByPosNoHeight,i.setDoc(t),0,0),U=W.to>=C?W:a.lineAt(C,Dt.ByPosNoHeight,i,0,0);for(I+=U.to-C,C=U.to;m>0&&W.from<=s[m-1].toA;)b=s[m-1].fromA,S=s[m-1].fromB,m--,b<W.from&&(W=a.lineAt(b,Dt.ByPosNoHeight,i,0,0));S+=W.from-b,b=W.from;let Y=Bn.build(i.setDoc(u),e,S,I);a=gn(a,a.replace(b,C,Y))}return a.updateHeight(i,0)}static empty(){return new Ai(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,s=0,a=0;for(;;)if(t==i)if(s>a*2){let m=e[t-1];m.break?e.splice(--t,1,m.left,null,m.right):e.splice(--t,1,m.left,m.right),i+=1+m.break,s-=m.size}else if(a>s*2){let m=e[i];m.break?e.splice(i,1,m.left,null,m.right):e.splice(i,1,m.left,m.right),i+=2+m.break,a-=m.size}else break;else if(s<a){let m=e[t++];m&&(s+=m.size)}else{let m=e[--i];m&&(a+=m.size)}let u=0;return e[t-1]==null?(u=1,t--):e[t]==null&&(u=1,i++),new $r(Zt.of(e.slice(0,t)),u,Zt.of(e.slice(i)))}}function gn(o,e){return o==e?o:(o.constructor!=e.constructor&&(mi=!0),e)}Zt.prototype.size=1;class Yn extends Zt{constructor(e,t,i){super(e,t),this.deco=i}blockAt(e,t,i,s){return new Wi(s,this.length,i,this.height,this.deco||0)}lineAt(e,t,i,s,a){return this.blockAt(0,i,s,a)}forEachLine(e,t,i,s,a,u){e<=a+this.length&&t>=a&&u(this.blockAt(0,i,s,a))}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Ai extends Yn{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,i,s){return new Wi(s,this.length,i,this.height,this.breaks)}replace(e,t,i){let s=i[0];return i.length==1&&(s instanceof Ai||s instanceof hi&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof hi?s=new Ai(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):Zt.of(i)}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more?this.setHeight(s.heights[s.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class hi extends Zt{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,s=e.doc.lineAt(t+this.length).number,a=s-i+1,u,m=0;if(e.lineWrapping){let b=Math.min(this.height,e.lineHeight*a);u=b/a,this.length>a+1&&(m=(this.height-b)/(this.length-a-1))}else u=this.height/a;return{firstLine:i,lastLine:s,perLine:u,perChar:m}}blockAt(e,t,i,s){let{firstLine:a,lastLine:u,perLine:m,perChar:b}=this.heightMetrics(t,s);if(t.lineWrapping){let C=s+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),S=t.doc.lineAt(C),I=m+S.length*b,W=Math.max(i,e-I/2);return new Wi(S.from,S.length,W,I,0)}else{let C=Math.max(0,Math.min(u-a,Math.floor((e-i)/m))),{from:S,length:I}=t.doc.line(a+C);return new Wi(S,I,i+m*C,m,0)}}lineAt(e,t,i,s,a){if(t==Dt.ByHeight)return this.blockAt(e,i,s,a);if(t==Dt.ByPosNoHeight){let{from:U,to:Y}=i.doc.lineAt(e);return new Wi(U,Y-U,0,0,0)}let{firstLine:u,perLine:m,perChar:b}=this.heightMetrics(i,a),C=i.doc.lineAt(e),S=m+C.length*b,I=C.number-u,W=s+m*I+b*(C.from-a-I);return new Wi(C.from,C.length,Math.max(s,Math.min(W,s+this.height-S)),S,0)}forEachLine(e,t,i,s,a,u){e=Math.max(e,a),t=Math.min(t,a+this.length);let{firstLine:m,perLine:b,perChar:C}=this.heightMetrics(i,a);for(let S=e,I=s;S<=t;){let W=i.doc.lineAt(S);if(S==e){let Y=W.number-m;I+=b*Y+C*(e-a-Y)}let U=b+C*W.length;u(new Wi(W.from,W.length,I,U,0)),I+=U,S=W.to+1}}replace(e,t,i){let s=this.length-t;if(s>0){let a=i[i.length-1];a instanceof hi?i[i.length-1]=new hi(a.length+s):i.push(null,new hi(s-1))}if(e>0){let a=i[0];a instanceof hi?i[0]=new hi(e+a.length):i.unshift(new hi(e-1),null)}return Zt.of(i)}decomposeLeft(e,t){t.push(new hi(e-1),null)}decomposeRight(e,t){t.push(null,new hi(this.length-e-1))}updateHeight(e,t=0,i=!1,s){let a=t+this.length;if(s&&s.from<=t+this.length&&s.more){let u=[],m=Math.max(t,s.from),b=-1;for(s.from>t&&u.push(new hi(s.from-t-1).updateHeight(e,t));m<=a&&s.more;){let S=e.doc.lineAt(m).length;u.length&&u.push(null);let I=s.heights[s.index++];b==-1?b=I:Math.abs(I-b)>=ws&&(b=-2);let W=new Ai(S,I);W.outdated=!1,u.push(W),m+=S+1}m<=a&&u.push(null,new hi(a-m).updateHeight(e,m));let C=Zt.of(u);return(b<0||Math.abs(C.height-this.height)>=ws||Math.abs(b-this.heightMetrics(e,t).perLine)>=ws)&&(mi=!0),gn(this,C)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class $r extends Zt{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,s){let a=i+this.left.height;return e<a?this.left.blockAt(e,t,i,s):this.right.blockAt(e,t,a,s+this.left.length+this.break)}lineAt(e,t,i,s,a){let u=s+this.left.height,m=a+this.left.length+this.break,b=t==Dt.ByHeight?e<u:e<m,C=b?this.left.lineAt(e,t,i,s,a):this.right.lineAt(e,t,i,u,m);if(this.break||(b?C.to<m:C.from>m))return C;let S=t==Dt.ByPosNoHeight?Dt.ByPosNoHeight:Dt.ByPos;return b?C.join(this.right.lineAt(m,S,i,u,m)):this.left.lineAt(m,S,i,s,a).join(C)}forEachLine(e,t,i,s,a,u){let m=s+this.left.height,b=a+this.left.length+this.break;if(this.break)e<b&&this.left.forEachLine(e,t,i,s,a,u),t>=b&&this.right.forEachLine(e,t,i,m,b,u);else{let C=this.lineAt(b,Dt.ByPos,i,s,a);e<C.from&&this.left.forEachLine(e,C.from-1,i,s,a,u),C.to>=e&&C.from<=t&&u(C),t>C.to&&this.right.forEachLine(C.to+1,t,i,m,b,u)}}replace(e,t,i){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,i));let a=[];e>0&&this.decomposeLeft(e,a);let u=a.length;for(let m of i)a.push(m);if(e>0&&qr(a,u-1),t<this.length){let m=a.length;this.decomposeRight(t,a),qr(a,m)}return Zt.of(a)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,s=i+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Zt.of(this.break?[e,null,t]:[e,t]):(this.left=gn(this.left,e),this.right=gn(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,s){let{left:a,right:u}=this,m=t+a.length+this.break,b=null;return s&&s.from<=t+a.length&&s.more?b=a=a.updateHeight(e,t,i,s):a.updateHeight(e,t,i),s&&s.from<=m+u.length&&s.more?b=u=u.updateHeight(e,m,i,s):u.updateHeight(e,m,i),b?this.balanced(a,u):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function qr(o,e){let t,i;o[e]==null&&(t=o[e-1])instanceof hi&&(i=o[e+1])instanceof hi&&o.splice(e-1,3,new hi(t.length+1+i.length))}const qs=5;class Bn{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Ai?s.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Ai(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let s=i.widget?i.widget.estimatedHeight:0,a=i.widget?i.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let u=t-e;i.block?this.addBlock(new Yn(u,s,i)):(u||a||s>=qs)&&this.addLineDeco(s,a,u)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ai(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new hi(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ai)return e;let t=new Ai(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,i){let s=this.ensureLine();s.length+=i,s.collapsed+=i,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=t,this.writtenTo=this.pos=this.pos+i}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Ai)&&!this.isCovered?this.nodes.push(new Ai(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let s of this.nodes)s instanceof Ai&&s.updateHeight(this.oracle,i),i+=s?s.length:1;return this.nodes}static build(e,t,i,s){let a=new Bn(i,e);return z.om.spans(t,i,s,a,0),a.finish(i)}}function Ur(o,e,t){let i=new Gr;return z.om.compare(o,e,t,i,0),i.changes}class Gr{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,s){(e<t||i&&i.heightRelevant||s&&s.heightRelevant)&&ft(e,t,this.changes,5)}}function Yr(o,e){let t=o.getBoundingClientRect(),i=o.ownerDocument,s=i.defaultView||window,a=Math.max(0,t.left),u=Math.min(s.innerWidth,t.right),m=Math.max(0,t.top),b=Math.min(s.innerHeight,t.bottom);for(let C=o.parentNode;C&&C!=i.body;)if(C.nodeType==1){let S=C,I=window.getComputedStyle(S);if((S.scrollHeight>S.clientHeight||S.scrollWidth>S.clientWidth)&&I.overflow!="visible"){let W=S.getBoundingClientRect();a=Math.max(a,W.left),u=Math.min(u,W.right),m=Math.max(m,W.top),b=Math.min(C==o.parentNode?s.innerHeight:b,W.bottom)}C=I.position=="absolute"||I.position=="fixed"?S.offsetParent:S.parentNode}else if(C.nodeType==11)C=C.host;else break;return{left:a-t.left,right:Math.max(a,u)-t.left,top:m-(t.top+e),bottom:Math.max(m,b)-(t.top+e)}}function Jr(o){let e=o.getBoundingClientRect(),t=o.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function Xo(o,e){let t=o.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Us{constructor(e,t,i,s){this.from=e,this.to=t,this.size=i,this.displaySize=s}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let s=e[i],a=t[i];if(s.from!=a.from||s.to!=a.to||s.size!=a.size)return!1}return!0}draw(e,t){return ue.replace({widget:new Mi(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Mi extends st{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Jn{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Ys,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=yt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(Zi).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new Jo(t),this.stateDeco=e.facet(ji).filter(i=>typeof i!="function"),this.heightMap=Zt.empty().applyChanges(this.stateDeco,z.EY.empty,this.heightOracle.setDoc(e.doc),[new A(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ue.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let s=i?t.head:t.anchor;if(!e.some(({from:a,to:u})=>s>=a&&s<=u)){let{from:a,to:u}=this.lineBlockAt(s);e.push(new yn(a,u))}}return this.viewports=e.sort((i,s)=>i.from-s.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Ys:new Js(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Xn(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(ji).filter(S=>typeof S!="function");let s=e.changedRanges,a=A.extendWithRanges(s,Ur(i,this.stateDeco,e?e.changes:z.VR.empty(this.state.doc.length))),u=this.heightMap.height,m=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Kr(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),a),(this.heightMap.height!=u||mi)&&(e.flags|=2),m?(this.scrollAnchorPos=e.changes.mapPos(m.from,-1),this.scrollAnchorHeight=m.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=u);let b=a.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<b.from||t.range.head>b.to)||!this.viewportIsAppropriate(b))&&(b=this.getViewport(0,t));let C=b.from!=this.viewport.from||b.to!=this.viewport.to;this.viewport=b,e.flags|=this.updateForViewport(),(C||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(le)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),s=this.heightOracle,a=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?yt.RTL:yt.LTR;let u=this.heightOracle.mustRefreshForWrapping(a),m=t.getBoundingClientRect(),b=u||this.mustMeasureContent||this.contentDOMHeight!=m.height;this.contentDOMHeight=m.height,this.mustMeasureContent=!1;let C=0,S=0;if(m.width&&m.height){let{scaleX:De,scaleY:He}=Rt(t,m);(De>.005&&Math.abs(this.scaleX-De)>.005||He>.005&&Math.abs(this.scaleY-He)>.005)&&(this.scaleX=De,this.scaleY=He,C|=16,u=b=!0)}let I=(parseInt(i.paddingTop)||0)*this.scaleY,W=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=I||this.paddingBottom!=W)&&(this.paddingTop=I,this.paddingBottom=W,C|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(b=!0),this.editorWidth=e.scrollDOM.clientWidth,C|=16);let U=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=U&&(this.scrollAnchorHeight=-1,this.scrollTop=U),this.scrolledToBottom=Pt(e.scrollDOM);let Y=(this.printing?Xo:Yr)(t,this.paddingTop),ee=Y.top-this.pixelViewport.top,re=Y.bottom-this.pixelViewport.bottom;this.pixelViewport=Y;let se=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(se!=this.inView&&(this.inView=se,se&&(b=!0)),!this.inView&&!this.scrollTarget&&!Jr(e.dom))return 0;let Ce=m.width;if((this.contentDOMWidth!=Ce||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=m.width,this.editorHeight=e.scrollDOM.clientHeight,C|=16),b){let De=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(De)&&(u=!0),u||s.lineWrapping&&Math.abs(Ce-this.contentDOMWidth)>s.charWidth){let{lineHeight:He,charWidth:We,textHeight:Ht}=e.docView.measureTextSize();u=He>0&&s.refresh(a,He,We,Ht,Ce/We,De),u&&(e.docView.minWidth=0,C|=16)}ee>0&&re>0?S=Math.max(ee,re):ee<0&&re<0&&(S=Math.min(ee,re)),Kr();for(let He of this.viewports){let We=He.from==this.viewport.from?De:e.docView.measureVisibleLineHeights(He);this.heightMap=(u?Zt.empty().applyChanges(this.stateDeco,z.EY.empty,this.heightOracle,[new A(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,u,new xs(He.from,We))}mi&&(C|=2)}let Le=!this.viewportIsAppropriate(this.viewport,S)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return Le&&(C&2&&(C|=this.updateScaler()),this.viewport=this.getViewport(S,this.scrollTarget),C|=this.updateForViewport()),(C&2||Le)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(u?[]:this.lineGaps,e)),C|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),C}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,a=this.heightOracle,{visibleTop:u,visibleBottom:m}=this,b=new yn(s.lineAt(u-i*1e3,Dt.ByHeight,a,0,0).from,s.lineAt(m+(1-i)*1e3,Dt.ByHeight,a,0,0).to);if(t){let{head:C}=t.range;if(C<b.from||C>b.to){let S=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),I=s.lineAt(C,Dt.ByPos,a,0,0),W;t.y=="center"?W=(I.top+I.bottom)/2-S/2:t.y=="start"||t.y=="nearest"&&C<b.from?W=I.top:W=I.bottom-S,b=new yn(s.lineAt(W-1e3/2,Dt.ByHeight,a,0,0).from,s.lineAt(W+S+1e3/2,Dt.ByHeight,a,0,0).to)}}return b}mapViewport(e,t){let i=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new yn(this.heightMap.lineAt(i,Dt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,Dt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,Dt.ByPos,this.heightOracle,0,0),{bottom:a}=this.heightMap.lineAt(t,Dt.ByPos,this.heightOracle,0,0),{visibleTop:u,visibleBottom:m}=this;return(e==0||s<=u-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||a>=m+Math.max(10,Math.min(i,250)))&&s>u-2*1e3&&a<m+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let s of e)t.touchesRange(s.from,s.to)||i.push(new Us(t.mapPos(s.from),t.mapPos(s.to),s.size,s.displaySize));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,s=i?1e4:2e3,a=s>>1,u=s<<1;if(this.defaultTextDirection!=yt.LTR&&!i)return[];let m=[],b=(S,I,W,U)=>{if(I-S<a)return;let Y=this.state.selection.main,ee=[Y.from];Y.empty||ee.push(Y.to);for(let se of ee)if(se>S&&se<I){b(S,se-10,W,U),b(se+10,I,W,U);return}let re=Xr(e,se=>se.from>=W.from&&se.to<=W.to&&Math.abs(se.from-S)<a&&Math.abs(se.to-I)<a&&!ee.some(Ce=>se.from<Ce&&se.to>Ce));if(!re){if(I<W.to&&t&&i&&t.visibleRanges.some(Le=>Le.from<=I&&Le.to>=I)){let Le=t.moveToLineBoundary(z.OF.cursor(I),!1,!0).head;Le>S&&(I=Le)}let se=this.gapSize(W,S,I,U),Ce=i||se<2e6?se:2e6;re=new Us(S,I,se,Ce)}m.push(re)},C=S=>{if(S.length<u||S.type!=tt.Text)return;let I=Gs(S.from,S.to,this.stateDeco);if(I.total<u)return;let W=this.scrollTarget?this.scrollTarget.range.head:null,U,Y;if(i){let ee=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,re,se;if(W!=null){let Ce=En(I,W),Le=((this.visibleBottom-this.visibleTop)/2+ee)/S.height;re=Ce-Le,se=Ce+Le}else re=(this.visibleTop-S.top-ee)/S.height,se=(this.visibleBottom-S.top+ee)/S.height;U=vs(I,re),Y=vs(I,se)}else{let ee=I.total*this.heightOracle.charWidth,re=s*this.heightOracle.charWidth,se=0;if(ee>2e6)for(let We of e)We.from>=S.from&&We.from<S.to&&We.size!=We.displaySize&&We.from*this.heightOracle.charWidth+se<this.pixelViewport.left&&(se=We.size-We.displaySize);let Ce=this.pixelViewport.left+se,Le=this.pixelViewport.right+se,De,He;if(W!=null){let We=En(I,W),Ht=((Le-Ce)/2+re)/ee;De=We-Ht,He=We+Ht}else De=(Ce-re)/ee,He=(Le+re)/ee;U=vs(I,De),Y=vs(I,He)}U>S.from&&b(S.from,U,S,I),Y<S.to&&b(Y,S.to,S,I)};for(let S of this.viewportLines)Array.isArray(S.type)?S.type.forEach(C):C(S);return m}gapSize(e,t,i,s){let a=En(s,i)-En(s,t);return this.heightOracle.lineWrapping?e.height*a:s.total*this.heightOracle.charWidth*a}updateLineGaps(e){Us.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ue.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let i=[];z.om.spans(t,this.viewport.from,this.viewport.to,{span(a,u){i.push({from:a,to:u})},point(){}},20);let s=0;if(i.length!=this.visibleRanges.length)s=12;else for(let a=0;a<i.length&&!(s&8);a++){let u=this.visibleRanges[a],m=i[a];(u.from!=m.from||u.to!=m.to)&&(s|=4,e&&e.mapPos(u.from,-1)==m.from&&e.mapPos(u.to,1)==m.to||(s|=8))}return this.visibleRanges=i,s}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Xn(this.heightMap.lineAt(e,Dt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Xn(this.heightMap.lineAt(this.scaler.fromDOM(e),Dt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Xn(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class yn{constructor(e,t){this.from=e,this.to=t}}function Gs(o,e,t){let i=[],s=o,a=0;return z.om.spans(t,o,e,{span(){},point(u,m){u>s&&(i.push({from:s,to:u}),a+=u-s),s=m}},20),s<e&&(i.push({from:s,to:e}),a+=e-s),{total:a,ranges:i}}function vs({total:o,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(o*t);for(let s=0;;s++){let{from:a,to:u}=e[s],m=u-a;if(i<=m)return a+i;i-=m}}function En(o,e){let t=0;for(let{from:i,to:s}of o.ranges){if(e<=s){t+=e-i;break}t+=s-i}return t/o.total}function Xr(o,e){for(let t of o)if(e(t))return t}const Ys={toDOM(o){return o},fromDOM(o){return o},scale:1,eq(o){return o==this}};class Js{constructor(e,t,i){let s=0,a=0,u=0;this.viewports=i.map(({from:m,to:b})=>{let C=t.lineAt(m,Dt.ByPos,e,0,0).top,S=t.lineAt(b,Dt.ByPos,e,0,0).bottom;return s+=S-C,{from:m,to:b,top:C,bottom:S,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let m of this.viewports)m.domTop=u+(m.top-a)*this.scale,u=m.domBottom=m.domTop+(m.bottom-m.top),a=m.bottom}toDOM(e){for(let t=0,i=0,s=0;;t++){let a=t<this.viewports.length?this.viewports[t]:null;if(!a||e<a.top)return s+(e-i)*this.scale;if(e<=a.bottom)return a.domTop+(e-a.top);i=a.bottom,s=a.domBottom}}fromDOM(e){for(let t=0,i=0,s=0;;t++){let a=t<this.viewports.length?this.viewports[t]:null;if(!a||e<a.domTop)return i+(e-s)/this.scale;if(e<=a.domBottom)return a.top+(e-a.domTop);i=a.bottom,s=a.domBottom}}eq(e){return e instanceof Js?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,i)=>t.from==e.viewports[i].from&&t.to==e.viewports[i].to):!1}}function Xn(o,e){if(e.scale==1)return o;let t=e.toDOM(o.top),i=e.toDOM(o.bottom);return new Wi(o.from,o.length,t,i-t,Array.isArray(o._content)?o._content.map(s=>Xn(s,e)):o._content)}const Xs=z.sj.define({combine:o=>o.join(" ")}),Zr=z.sj.define({combine:o=>o.indexOf(!0)>-1}),ks=Be.G.newName(),tn=Be.G.newName(),Zs=Be.G.newName(),Ss={"&light":"."+tn,"&dark":"."+Zs};function Qs(o,e,t){return new Be.G(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,s=>{if(s=="&")return o;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):o+" "+i}})}const Qr=Qs("."+ks,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Ss),Zo={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Rn=L.ie&&L.ie_version<=11;class Zn{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new Kt,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(L.ie&&L.ie_version<=11||L.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(L.chrome&&L.chrome_version<126)&&(this.editContext=new io(e),e.state.facet(mt)&&(e.contentDOM.editContext=this.editContext.editContext)),Rn&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,s=this.selectionRange;if(i.state.facet(mt)?i.root.activeElement!=this.dom:!Pe(this.dom,s))return;let a=s.anchorNode&&i.docView.nearest(s.anchorNode);if(a&&a.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(L.ie&&L.ie_version<=11||L.android&&L.chrome)&&!i.state.selection.main.empty&&s.focusNode&&Se(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=$e(e.root);if(!t)return!1;let i=L.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&oi(this.view,t)||t;if(!i||this.selectionRange.eq(i))return!1;let s=Pe(this.dom,i);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Me(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Zo),Rn&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Rn&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let s=()=>{let a=this.delayedAndroidKey;a&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=a.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&a.force&&di(this.dom,a.key,a.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,i=-1,s=!1;for(let a of e){let u=this.readMutation(a);u&&(u.typeOver&&(s=!0),t==-1?{from:t,to:i}=u:(t=Math.min(u.from,t),i=Math.max(u.to,i)))}return{from:t,to:i,typeOver:s}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),s=this.selectionChanged&&Pe(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let a=new Nl(this.view,e,t,i);return this.view.docView.domChanged={newSel:a.newSel?a.newSel.main:null},a}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let i=this.view.state,s=Tr(this.view,t);return this.view.state==i&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let i=eo(t,e.previousSibling||e.target.previousSibling,-1),s=eo(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(mt)!=e.state.facet(mt)&&(e.view.contentDOM.editContext=e.state.facet(mt)?this.editContext.editContext:null))}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function eo(o,e,t){for(;e;){let i=fe.get(e);if(i&&i.parent==o)return i;let s=e.parentNode;e=s!=o.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function to(o,e){let t=e.startContainer,i=e.startOffset,s=e.endContainer,a=e.endOffset,u=o.docView.domAtPos(o.state.selection.main.anchor);return Se(u.node,u.offset,s,a)&&([t,i,s,a]=[s,a,t,i]),{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:a}}function oi(o,e){if(e.getComposedRanges){let s=e.getComposedRanges(o.root)[0];if(s)return to(o,s)}let t=null;function i(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return o.contentDOM.addEventListener("beforeinput",i,!0),o.dom.ownerDocument.execCommand("indent"),o.contentDOM.removeEventListener("beforeinput",i,!0),t?to(o,t):null}class io{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let s=e.state.selection.main,{anchor:a,head:u}=s,m=this.toEditorPos(i.updateRangeStart),b=this.toEditorPos(i.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:m,drifted:!1});let C={from:m,to:b,insert:z.EY.of(i.text.split(`
`))};if(C.from==this.from&&a<this.from?C.from=a:C.to==this.to&&a>this.to&&(C.to=a),C.from==C.to&&!C.insert.length){let S=z.OF.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));S.main.eq(s)||e.dispatch({selection:S,userEvent:"select"});return}if((L.mac||L.android)&&C.from==u-1&&/^\. ?$/.test(i.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(C={from:m,to:b,insert:z.EY.of([i.text.replace("."," ")])}),this.pendingContextChange=C,!e.state.readOnly){let S=this.to-this.from+(C.to-C.from+C.insert.length);_s(e,C,z.OF.single(this.toEditorPos(i.selectionStart,S),this.toEditorPos(i.selectionEnd,S)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=i=>{let s=[],a=null;for(let u=this.toEditorPos(i.rangeStart),m=this.toEditorPos(i.rangeEnd);u<m;u++){let b=e.coordsForChar(u);a=b&&new DOMRect(b.left,b.top,b.right-b.left,b.bottom-b.top)||a||new DOMRect,s.push(a)}t.updateCharacterBounds(i.rangeStart,s)},this.handlers.textformatupdate=i=>{let s=[];for(let a of i.getTextFormats()){let u=a.underlineStyle,m=a.underlineThickness;if(u!="None"&&m!="None"){let b=this.toEditorPos(a.rangeStart),C=this.toEditorPos(a.rangeEnd);if(b<C){let S=`text-decoration: underline ${u=="Dashed"?"dashed ":u=="Squiggle"?"wavy ":""}${m=="Thin"?1:2}px`;s.push(ue.mark({attributes:{style:S}}).range(b,C))}}}e.dispatch({effects:xt.of(ue.set(s))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(e.state)}};for(let i in this.handlers)t.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let s=$e(i.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,i=!1,s=this.pendingContextChange;return e.changes.iterChanges((a,u,m,b,C)=>{if(i)return;let S=C.length-(u-a);if(s&&u>=s.to)if(s.from==a&&s.to==u&&s.insert.eq(C)){s=this.pendingContextChange=null,t+=S,this.to+=S;return}else s=null,this.revertPending(e.state);if(a+=t,u+=t,u<=this.from)this.from+=S,this.to+=S;else if(a<this.to){if(a<this.from||u>this.to||this.to-this.from+C.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(a),this.toContextPos(u),C.toString()),this.to+=S}t+=S}),s&&!i&&this.revertPending(e.state),!i}update(e){let t=this.pendingContextChange,i=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(i.from,i.to)&&e.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),s=this.toContextPos(t.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(i,s)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let i=this.composing;return i&&i.drifted?i.editorBase+(e-i.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class ht{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(s=>s.forEach(a=>i(a,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=e.root||Yt(e.parent)||document,this.viewState=new Jn(e.state||z.$t.create(e)),e.scrollTo&&e.scrollTo.is(ve)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Xi).map(s=>new Pn(s));for(let s of this.plugins)s.update(this);this.observer=new Zn(this),this.inputState=new Lr(this),this.inputState.ensureHandlers(this.plugins),this.docView=new w(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof z.ZX?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,s,a=this.state;for(let W of e){if(W.startState!=a)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");a=W.state}if(this.destroyed){this.viewState.state=a;return}let u=this.hasFocus,m=0,b=null;e.some(W=>W.annotation(qn))?(this.inputState.notifiedFocused=u,m=1):u!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=u,b=Un(a,u),b||(m=1));let C=this.observer.delayedAndroidKey,S=null;if(C?(this.observer.clearDelayedAndroidKey(),S=this.observer.readChange(),(S&&!this.state.doc.eq(a.doc)||!this.state.selection.eq(a.selection))&&(S=null)):this.observer.clear(),a.facet(z.$t.phrases)!=this.state.facet(z.$t.phrases))return this.setState(a);s=g.create(this,a,e),s.flags|=m;let I=this.viewState.scrollTarget;try{this.updateState=2;for(let W of e){if(I&&(I=I.map(W.changes)),W.scrollIntoView){let{main:U}=W.state.selection;I=new ye(U.empty?U:z.OF.cursor(U.head,U.head>U.anchor?-1:1))}for(let U of W.effects)U.is(ve)&&(I=U.value.clip(this.state))}this.viewState.update(s,I),this.bidiCache=As.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(Fi)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(W=>W.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(Xs)!=s.state.facet(Xs)&&(this.viewState.mustMeasureContent=!0),(t||i||I||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!s.empty)for(let W of this.state.facet(v))try{W(s)}catch(U){Et(this.state,U,"update listener")}(b||S)&&Promise.resolve().then(()=>{b&&this.state==b.startState&&this.dispatch(b),S&&!Tr(this,S)&&C.force&&di(this.contentDOM,C.key,C.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Jn(e),this.plugins=e.facet(Xi).map(i=>new Pn(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new w(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Xi),i=e.state.facet(Xi);if(t!=i){let s=[];for(let a of i){let u=t.indexOf(a);if(u<0)s.push(new Pn(a));else{let m=this.plugins[u];m.mustUpdate=e,s.push(m)}}for(let a of this.plugins)a.mustUpdate!=e&&a.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);t!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(i){Et(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,i=this.scrollDOM,s=i.scrollTop*this.scaleY,{scrollAnchorPos:a,scrollAnchorHeight:u}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(u=-1),this.viewState.scrollAnchorHeight=-1;try{for(let m=0;;m++){if(u<0)if(Pt(i))a=-1,u=this.viewState.heightMap.height;else{let U=this.viewState.scrollAnchorAt(s);a=U.from,u=U.top}this.updateState=1;let b=this.viewState.measure(this);if(!b&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(m>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let C=[];b&4||([this.measureRequests,C]=[C,this.measureRequests]);let S=C.map(U=>{try{return U.read(this)}catch(Y){return Et(this.state,Y),Cs}}),I=g.create(this,this.state,[]),W=!1;I.flags|=b,t?t.flags|=b:t=I,this.updateState=2,I.empty||(this.updatePlugins(I),this.inputState.update(I),this.updateAttrs(),W=this.docView.update(I),W&&this.docViewUpdate());for(let U=0;U<C.length;U++)if(S[U]!=Cs)try{let Y=C[U];Y.write&&Y.write(S[U],this)}catch(Y){Et(this.state,Y)}if(W&&this.docView.updateSelection(!0),!I.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,u=-1;continue}else{let Y=(a<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(a).top)-u;if(Y>1||Y<-1){s=s+Y,i.scrollTop=s/this.scaleY,u=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let m of this.state.facet(v))m(t)}get themeClasses(){return ks+" "+(this.state.facet(Zr)?Zs:tn)+" "+this.state.facet(Xs)}updateAttrs(){let e=no(this,Vn,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(mt)?"true":"false",class:"cm-content",style:`${L.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),no(this,Zi,t);let i=this.observer.ignore(()=>{let s=kt(this.contentDOM,this.contentAttrs,t),a=kt(this.dom,this.editorAttrs,e);return s||a});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let s of i.effects)if(s.is(ht.announce)){t&&(this.announceDOM.textContent=""),t=!1;let a=this.announceDOM.appendChild(document.createElement("div"));a.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Fi);let e=this.state.facet(ht.cspNonce);Be.G.mount(this.root,this.styleModules.concat(Qr).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return Vs(this,e,zs(this,e,t,i))}moveByGroup(e,t){return Vs(this,e,zs(this,e,t,i=>Fo(this,e.head,i)))}visualLineSide(e,t){let i=this.bidiSpans(e),s=this.textDirectionAt(e.from),a=i[t?i.length-1:0];return z.OF.cursor(a.side(t,s)+e.from,a.forward(!t,s)?1:-1)}moveToLineBoundary(e,t,i=!0){return No(this,e,t,i)}moveVertically(e,t,i){return Vs(this,e,Or(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Cr(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(e),a=this.bidiSpans(s),u=a[ri.find(a,e-s.from,-1,t)];return ut(i,u.dir==yt.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(Z)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Qo)return Ri(e.length);let t=this.textDirectionAt(e.from),i;for(let a of this.bidiCache)if(a.from==e.from&&a.dir==t&&(a.fresh||cn(a.isolates,i=us(this,e))))return a.order;i||(i=us(this,e));let s=Ei(e.text,t,i);return this.bidiCache.push(new As(e.from,e.to,t,i,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||L.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Ct(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return ve.of(new ye(typeof e=="number"?z.OF.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return ve.of(new ye(z.OF.cursor(i.from),"start","start",i.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Xt.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Xt.define(()=>({}),{eventObservers:e})}static theme(e,t){let i=Be.G.newName(),s=[Xs.of(i),Fi.of(Qs(`.${i}`,e))];return t&&t.dark&&s.push(Zr.of(!0)),s}static baseTheme(e){return z.Nb.lowest(Fi.of(Qs("."+ks,e,Ss)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),s=i&&fe.get(i)||fe.get(e);return((t=s?.rootView)===null||t===void 0?void 0:t.view)||null}}ht.styleModule=Fi,ht.inputHandler=D,ht.clipboardInputFilter=H,ht.clipboardOutputFilter=_,ht.scrollHandler=ce,ht.focusChangeEffect=T,ht.perLineTextDirection=Z,ht.exceptionSink=y,ht.updateListener=v,ht.editable=mt,ht.mouseSelectionStyle=d,ht.dragMovesSelection=h,ht.clickAddsSelectionRange=B,ht.decorations=ji,ht.outerDecorations=_n,ht.atomicRanges=fn,ht.bidiIsolatedRanges=Hs,ht.scrollMargins=jn,ht.darkTheme=Zr,ht.cspNonce=z.sj.define({combine:o=>o.length?o[0]:""}),ht.contentAttributes=Zi,ht.editorAttributes=Vn,ht.lineWrapping=ht.contentAttributes.of({class:"cm-lineWrapping"}),ht.announce=z.Pe.define();const Qo=4096,Cs={};class As{constructor(e,t,i,s,a,u){this.from=e,this.to=t,this.dir=i,this.isolates=s,this.fresh=a,this.order=u}static update(e,t){if(t.empty&&!e.some(a=>a.fresh))return e;let i=[],s=e.length?e[e.length-1].dir:yt.LTR;for(let a=Math.max(0,e.length-10);a<e.length;a++){let u=e[a];u.dir==s&&!t.touchesRange(u.from,u.to)&&i.push(new As(t.mapPos(u.from,1),t.mapPos(u.to,-1),u.dir,u.isolates,!1,u.order))}return i}}function no(o,e,t){for(let i=o.state.facet(e),s=i.length-1;s>=0;s--){let a=i[s],u=typeof a=="function"?a(o):a;u&&Wt(u,t)}return t}const el=L.mac?"mac":L.windows?"win":L.linux?"linux":"key";function so(o,e){const t=o.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let s,a,u,m;for(let b=0;b<t.length-1;++b){const C=t[b];if(/^(cmd|meta|m)$/i.test(C))m=!0;else if(/^a(lt)?$/i.test(C))s=!0;else if(/^(c|ctrl|control)$/i.test(C))a=!0;else if(/^s(hift)?$/i.test(C))u=!0;else if(/^mod$/i.test(C))e=="mac"?m=!0:a=!0;else throw new Error("Unrecognized modifier name: "+C)}return s&&(i="Alt-"+i),a&&(i="Ctrl-"+i),m&&(i="Meta-"+i),u&&(i="Shift-"+i),i}function Ms(o,e,t){return e.altKey&&(o="Alt-"+o),e.ctrlKey&&(o="Ctrl-"+o),e.metaKey&&(o="Meta-"+o),t!==!1&&e.shiftKey&&(o="Shift-"+o),o}const In=z.Nb.default(ht.domEventHandlers({keydown(o,e){return bn(oo(e.state),o,e,"editor")}})),Qn=z.sj.define({enables:In}),ro=new WeakMap;function oo(o){let e=o.facet(Qn),t=ro.get(e);return t||ro.set(e,t=lo(e.reduce((i,s)=>i.concat(s),[]))),t}function tl(o,e,t){return bn(oo(o.state),e,o,t)}let $i=null;const il=4e3;function lo(o,e=el){let t=Object.create(null),i=Object.create(null),s=(u,m)=>{let b=i[u];if(b==null)i[u]=m;else if(b!=m)throw new Error("Key binding "+u+" is used both as a regular binding and as a multi-stroke prefix")},a=(u,m,b,C,S)=>{var I,W;let U=t[u]||(t[u]=Object.create(null)),Y=m.split(/ (?!$)/).map(se=>so(se,e));for(let se=1;se<Y.length;se++){let Ce=Y.slice(0,se).join(" ");s(Ce,!0),U[Ce]||(U[Ce]={preventDefault:!0,stopPropagation:!1,run:[Le=>{let De=$i={view:Le,prefix:Ce,scope:u};return setTimeout(()=>{$i==De&&($i=null)},il),!0}]})}let ee=Y.join(" ");s(ee,!1);let re=U[ee]||(U[ee]={preventDefault:!1,stopPropagation:!1,run:((W=(I=U._any)===null||I===void 0?void 0:I.run)===null||W===void 0?void 0:W.slice())||[]});b&&re.run.push(b),C&&(re.preventDefault=!0),S&&(re.stopPropagation=!0)};for(let u of o){let m=u.scope?u.scope.split(" "):["editor"];if(u.any)for(let C of m){let S=t[C]||(t[C]=Object.create(null));S._any||(S._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:I}=u;for(let W in S)S[W].run.push(U=>I(U,ki))}let b=u[e]||u.key;if(b)for(let C of m)a(C,b,u.run,u.preventDefault,u.stopPropagation),u.shift&&a(C,"Shift-"+b,u.shift,u.preventDefault,u.stopPropagation)}return t}let ki=null;function bn(o,e,t,i){ki=e;let s=it(e),a=(0,z.vS)(s,0),u=(0,z.Fh)(a)==s.length&&s!=" ",m="",b=!1,C=!1,S=!1;$i&&$i.view==t&&$i.scope==i&&(m=$i.prefix+" ",ms.indexOf(e.keyCode)<0&&(C=!0,$i=null));let I=new Set,W=re=>{if(re){for(let se of re.run)if(!I.has(se)&&(I.add(se),se(t)))return re.stopPropagation&&(S=!0),!0;re.preventDefault&&(re.stopPropagation&&(S=!0),C=!0)}return!1},U=o[i],Y,ee;return U&&(W(U[m+Ms(s,e,!u)])?b=!0:u&&(e.altKey||e.metaKey||e.ctrlKey)&&!(L.windows&&e.ctrlKey&&e.altKey)&&(Y=ae[e.keyCode])&&Y!=s?(W(U[m+Ms(Y,e,!0)])||e.shiftKey&&(ee=R[e.keyCode])!=s&&ee!=Y&&W(U[m+Ms(ee,e,!1)]))&&(b=!0):u&&e.shiftKey&&W(U[m+Ms(s,e,!0)])&&(b=!0),!b&&W(U._any)&&(b=!0)),C&&(b=!0),b&&S&&e.stopPropagation(),ki=null,b}class es{constructor(e,t,i,s,a){this.className=e,this.left=t,this.top=i,this.width=s,this.height=a}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,i){if(i.empty){let s=e.coordsAtPos(i.head,i.assoc||1);if(!s)return[];let a=Os(e);return[new es(t,s.left-a.left,s.top-a.top,null,s.bottom-s.top)]}else return li(e,t,i)}}function Os(o){let e=o.scrollDOM.getBoundingClientRect();return{left:(o.textDirection==yt.LTR?e.left:e.right-o.scrollDOM.clientWidth*o.scaleX)-o.scrollDOM.scrollLeft*o.scaleX,top:e.top-o.scrollDOM.scrollTop*o.scaleY}}function Ds(o,e,t,i){let s=o.coordsAtPos(e,t*2);if(!s)return i;let a=o.dom.getBoundingClientRect(),u=(s.top+s.bottom)/2,m=o.posAtCoords({x:a.left+1,y:u}),b=o.posAtCoords({x:a.right-1,y:u});return m==null||b==null?i:{from:Math.max(i.from,Math.min(m,b)),to:Math.min(i.to,Math.max(m,b))}}function li(o,e,t){if(t.to<=o.viewport.from||t.from>=o.viewport.to)return[];let i=Math.max(t.from,o.viewport.from),s=Math.min(t.to,o.viewport.to),a=o.textDirection==yt.LTR,u=o.contentDOM,m=u.getBoundingClientRect(),b=Os(o),C=u.querySelector(".cm-line"),S=C&&window.getComputedStyle(C),I=m.left+(S?parseInt(S.paddingLeft)+Math.min(0,parseInt(S.textIndent)):0),W=m.right-(S?parseInt(S.paddingRight):0),U=Mr(o,i,1),Y=Mr(o,s,-1),ee=U.type==tt.Text?U:null,re=Y.type==tt.Text?Y:null;if(ee&&(o.lineWrapping||U.widgetLineBreaks)&&(ee=Ds(o,i,1,ee)),re&&(o.lineWrapping||Y.widgetLineBreaks)&&(re=Ds(o,s,-1,re)),ee&&re&&ee.from==re.from&&ee.to==re.to)return Ce(Le(t.from,t.to,ee));{let He=ee?Le(t.from,null,ee):De(U,!1),We=re?Le(null,t.to,re):De(Y,!0),Ht=[];return(ee||U).to<(re||Y).from-(ee&&re?1:0)||U.widgetLineBreaks>1&&He.bottom+o.defaultLineHeight/2<We.top?Ht.push(se(I,He.bottom,W,We.top)):He.bottom<We.top&&o.elementAtHeight((He.bottom+We.top)/2).type==tt.Text&&(He.bottom=We.top=(He.bottom+We.top)/2),Ce(He).concat(Ht).concat(Ce(We))}function se(He,We,Ht,fi){return new es(e,He-b.left,We-b.top,Ht-He,fi-We)}function Ce({top:He,bottom:We,horizontal:Ht}){let fi=[];for(let rn=0;rn<Ht.length;rn+=2)fi.push(se(Ht[rn],He,Ht[rn+1],We));return fi}function Le(He,We,Ht){let fi=1e9,rn=-1e9,Es=[];function kr(Mn,on,On,Dn,r){let n=o.coordsAtPos(Mn,Mn==Ht.to?-2:2),l=o.coordsAtPos(On,On==Ht.from?2:-2);!n||!l||(fi=Math.min(n.top,l.top,fi),rn=Math.max(n.bottom,l.bottom,rn),r==yt.LTR?Es.push(a&&on?I:n.left,a&&Dn?W:l.right):Es.push(!a&&Dn?I:l.left,!a&&on?W:n.right))}let Rs=He??Ht.from,Is=We??Ht.to;for(let Mn of o.visibleRanges)if(Mn.to>Rs&&Mn.from<Is)for(let on=Math.max(Mn.from,Rs),On=Math.min(Mn.to,Is);;){let Dn=o.state.doc.lineAt(on);for(let r of o.bidiSpans(Dn)){let n=r.from+Dn.from,l=r.to+Dn.from;if(n>=On)break;l>on&&kr(Math.max(n,on),He==null&&n<=Rs,Math.min(l,On),We==null&&l>=Is,r.dir)}if(on=Dn.to+1,on>=On)break}return Es.length==0&&kr(Rs,He==null,Is,We==null,o.textDirection),{top:fi,bottom:rn,horizontal:Es}}function De(He,We){let Ht=m.top+(We?He.top:He.bottom);return{top:Ht,bottom:Ht,horizontal:[]}}}function er(o,e){return o.constructor==e.constructor&&o.eq(e)}class nl{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(xn)!=e.state.facet(xn)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,i=e.facet(xn);for(;t<i.length&&i[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,i)=>!er(t,this.drawn[i]))){let t=this.dom.firstChild,i=0;for(let s of e)s.update&&t&&s.constructor&&this.drawn[i].constructor&&s.update(t,this.drawn[i])?(t=t.nextSibling,i++):this.dom.insertBefore(s.draw(),t);for(;t;){let s=t.nextSibling;t.remove(),t=s}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const xn=z.sj.define();function ao(o){return[Xt.define(e=>new nl(e,o)),xn.of(o)]}const wn=z.sj.define({combine(o){return(0,z.QR)(o,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function sl(o={}){return[wn.of(o),rl,ol,ll,le.of(!0)]}function Fl(o){return o.facet(wn)}function ho(o){return o.startState.facet(wn)!=o.state.facet(wn)}const rl=ao({above:!0,markers(o){let{state:e}=o,t=e.facet(wn),i=[];for(let s of e.selection.ranges){let a=s==e.selection.main;if(s.empty||t.drawRangeCursor){let u=a?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",m=s.empty?s:z.OF.cursor(s.head,s.head>s.anchor?-1:1);for(let b of es.forRange(o,u,m))i.push(b)}}return i},update(o,e){o.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=ho(o);return t&&co(o.state,e),o.docChanged||o.selectionSet||t},mount(o,e){co(e.state,o)},class:"cm-cursorLayer"});function co(o,e){e.style.animationDuration=o.facet(wn).cursorBlinkRate+"ms"}const ol=ao({above:!1,markers(o){return o.state.selection.ranges.map(e=>e.empty?[]:es.forRange(o,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(o,e){return o.docChanged||o.selectionSet||o.viewportChanged||ho(o)},class:"cm-selectionLayer"}),ll=z.Nb.highest(ht.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),tr=z.Pe.define({map(o,e){return o==null?null:e.mapPos(o)}}),ts=z.sU.define({create(){return null},update(o,e){return o!=null&&(o=e.changes.mapPos(o)),e.effects.reduce((t,i)=>i.is(tr)?i.value:t,o)}}),ir=Xt.fromClass(class{constructor(o){this.view=o,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(o){var e;let t=o.state.field(ts);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(o.startState.field(ts)!=t||o.docChanged||o.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:o}=this,e=o.state.field(ts),t=e!=null&&o.coordsAtPos(e);if(!t)return null;let i=o.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+o.scrollDOM.scrollLeft*o.scaleX,top:t.top-i.top+o.scrollDOM.scrollTop*o.scaleY,height:t.bottom-t.top}}drawCursor(o){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;o?(this.cursor.style.left=o.left/e+"px",this.cursor.style.top=o.top/t+"px",this.cursor.style.height=o.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(o){this.view.state.field(ts)!=o&&this.view.dispatch({effects:tr.of(o)})}},{eventObservers:{dragover(o){this.setDropPos(this.view.posAtCoords({x:o.clientX,y:o.clientY}))},dragleave(o){(o.target==this.view.contentDOM||!this.view.contentDOM.contains(o.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function nr(){return[ts,ir]}function fo(o,e,t,i,s){e.lastIndex=0;for(let a=o.iterRange(t,i),u=t,m;!a.next().done;u+=a.value.length)if(!a.lineBreak)for(;m=e.exec(a.value);)s(u+m.index,m)}function al(o,e){let t=o.visibleRanges;if(t.length==1&&t[0].from==o.viewport.from&&t[0].to==o.viewport.to)return t;let i=[];for(let{from:s,to:a}of t)s=Math.max(o.state.doc.lineAt(s).from,s-e),a=Math.min(o.state.doc.lineAt(a).to,a+e),i.length&&i[i.length-1].to>=s?i[i.length-1].to=a:i.push({from:s,to:a});return i}class nn{constructor(e){const{regexp:t,decoration:i,decorate:s,boundary:a,maxLength:u=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,s)this.addMatch=(m,b,C,S)=>s(S,C,C+m[0].length,m,b);else if(typeof i=="function")this.addMatch=(m,b,C,S)=>{let I=i(m,b,C);I&&S(C,C+m[0].length,I)};else if(i)this.addMatch=(m,b,C,S)=>S(C,C+m[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=a,this.maxLength=u}createDeco(e){let t=new z.vB,i=t.add.bind(t);for(let{from:s,to:a}of al(e,this.maxLength))fo(e.state.doc,this.regexp,s,a,(u,m)=>this.addMatch(m,e,u,i));return t.finish()}updateDeco(e,t){let i=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((a,u,m,b)=>{b>=e.view.viewport.from&&m<=e.view.viewport.to&&(i=Math.min(m,i),s=Math.max(b,s))}),e.viewportMoved||s-i>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,t.map(e.changes),i,s):t}updateRange(e,t,i,s){for(let a of e.visibleRanges){let u=Math.max(a.from,i),m=Math.min(a.to,s);if(m>=u){let b=e.state.doc.lineAt(u),C=b.to<m?e.state.doc.lineAt(m):b,S=Math.max(a.from,b.from),I=Math.min(a.to,C.to);if(this.boundary){for(;u>b.from;u--)if(this.boundary.test(b.text[u-1-b.from])){S=u;break}for(;m<C.to;m++)if(this.boundary.test(C.text[m-C.from])){I=m;break}}let W=[],U,Y=(ee,re,se)=>W.push(se.range(ee,re));if(b==C)for(this.regexp.lastIndex=S-b.from;(U=this.regexp.exec(b.text))&&U.index<I-b.from;)this.addMatch(U,e,U.index+b.from,Y);else fo(e.state.doc,this.regexp,S,I,(ee,re)=>this.addMatch(re,e,ee,Y));t=t.update({filterFrom:S,filterTo:I,filter:(ee,re)=>ee<S||re>I,add:W})}}return t}}const vn=/x/.unicode!=null?"gu":"g",hl=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,vn),kn={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let is=null;function cl(){var o;if(is==null&&typeof document<"u"&&document.body){let e=document.body.style;is=((o=e.tabSize)!==null&&o!==void 0?o:e.MozTabSize)!=null}return is||!1}const ns=z.sj.define({combine(o){let e=(0,z.QR)(o,{render:null,specialChars:hl,addSpecialChars:null});return(e.replaceTabs=!cl())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,vn)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,vn)),e}});function fl(o={}){return[ns.of(o),ul()]}let uo=null;function ul(){return uo||(uo=Xt.fromClass(class{constructor(o){this.view=o,this.decorations=ue.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(o.state.facet(ns)),this.decorations=this.decorator.createDeco(o)}makeDecorator(o){return new nn({regexp:o.specialChars,decoration:(e,t,i)=>{let{doc:s}=t.state,a=(0,z.vS)(e[0],0);if(a==9){let u=s.lineAt(i),m=t.state.tabSize,b=(0,z.y$)(u.text,m,i-u.from);return ue.replace({widget:new po((m-b%m)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[a]||(this.decorationCache[a]=ue.replace({widget:new dl(o,a)}))},boundary:o.replaceTabs?void 0:/[^]/})}update(o){let e=o.state.facet(ns);o.startState.facet(ns)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(o.view)):this.decorations=this.decorator.updateDeco(o,this.decorations)}},{decorations:o=>o.decorations}))}const Hl="\u2022";function Wl(o){return o>=32?Hl:o==10?"\u2424":String.fromCharCode(9216+o)}class dl extends st{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=Wl(this.code),i=e.state.phrase("Control character")+" "+(kn[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,i,t);if(s)return s;let a=document.createElement("span");return a.textContent=t,a.title=i,a.setAttribute("aria-label",i),a.className="cm-specialChar",a}ignoreEvent(){return!1}}class po extends st{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const mo=null;function Gl(){return[mo,Zi.of(o=>{var e;return((e=o.plugin(mo))===null||e===void 0?void 0:e.attrs)||null})]}function pl(){return go}const ml=ue.line({class:"cm-activeLine"}),go=Xt.fromClass(class{constructor(o){this.decorations=this.getDeco(o)}update(o){(o.docChanged||o.selectionSet)&&(this.decorations=this.getDeco(o.view))}getDeco(o){let e=-1,t=[];for(let i of o.state.selection.ranges){let s=o.lineBlockAt(i.head);s.from>e&&(t.push(ml.range(s.from)),e=s.from)}return ue.set(t)}},{decorations:o=>o.decorations});class yo extends st{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?Ee(e.firstChild):[];if(!t.length)return null;let i=window.getComputedStyle(e.parentNode),s=ut(t[0],i.direction!="rtl"),a=parseInt(i.lineHeight);return s.bottom-s.top>a*1.5?{left:s.left,right:s.right,top:s.top,bottom:s.top+a}:s}ignoreEvent(){return!1}}function gl(o){let e=Xt.fromClass(class{constructor(t){this.view=t,this.placeholder=o?ue.set([ue.widget({widget:new yo(o),side:1}).range(0)]):ue.none}get decorations(){return this.view.state.doc.length?ue.none:this.placeholder}},{decorations:t=>t.decorations});return typeof o=="string"?[e,ht.contentAttributes.of({"aria-placeholder":o})]:e}const Ts=2e3;function bo(o,e,t){let i=Math.min(e.line,t.line),s=Math.max(e.line,t.line),a=[];if(e.off>Ts||t.off>Ts||e.col<0||t.col<0){let u=Math.min(e.off,t.off),m=Math.max(e.off,t.off);for(let b=i;b<=s;b++){let C=o.doc.line(b);C.length<=m&&a.push(z.OF.range(C.from+u,C.to+m))}}else{let u=Math.min(e.col,t.col),m=Math.max(e.col,t.col);for(let b=i;b<=s;b++){let C=o.doc.line(b),S=(0,z.kn)(C.text,u,o.tabSize,!0);if(S<0)a.push(z.OF.cursor(C.to));else{let I=(0,z.kn)(C.text,m,o.tabSize);a.push(z.OF.range(C.from+S,C.from+I))}}}return a}function zl(o,e){let t=o.coordsAtPos(o.viewport.from);return t?Math.round(Math.abs((t.left-e)/o.defaultCharacterWidth)):-1}function Nn(o,e){let t=o.posAtCoords({x:e.clientX,y:e.clientY},!1),i=o.state.doc.lineAt(t),s=t-i.from,a=s>Ts?-1:s==i.length?zl(o,e.clientX):(0,z.y$)(i.text,o.state.tabSize,t-i.from);return{line:i.number,col:a,off:s}}function Sn(o,e){let t=Nn(o,e),i=o.state.selection;return t?{update(s){if(s.docChanged){let a=s.changes.mapPos(s.startState.doc.line(t.line).from),u=s.state.doc.lineAt(a);t={line:u.number,col:t.col,off:Math.min(t.off,u.length)},i=i.map(s.changes)}},get(s,a,u){let m=Nn(o,s);if(!m)return i;let b=bo(o.state,t,m);return b.length?u?z.OF.create(b.concat(i.ranges)):z.OF.create(b):i}}:null}function sr(o){let e=o?.eventFilter||(t=>t.altKey&&t.button==0);return ht.mouseSelectionStyle.of((t,i)=>e(i)?Sn(t,i):null)}const xo={Alt:[18,o=>!!o.altKey],Control:[17,o=>!!o.ctrlKey],Shift:[16,o=>!!o.shiftKey],Meta:[91,o=>!!o.metaKey]},yl={style:"cursor: crosshair"};function rr(o={}){let[e,t]=xo[o.key||"Alt"],i=Xt.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventObservers:{keydown(s){this.set(s.keyCode==e||t(s))},keyup(s){(s.keyCode==e||!t(s))&&this.set(!1)},mousemove(s){this.set(t(s))}}});return[i,ht.contentAttributes.of(s=>{var a;return!((a=s.plugin(i))===null||a===void 0)&&a.isDown?yl:null})]}const Fn="-10000px";class or{constructor(e,t,i,s){this.facet=t,this.createTooltipView=i,this.removeTooltipView=s,this.input=e.state.facet(t),this.tooltips=this.input.filter(u=>u);let a=null;this.tooltipViews=this.tooltips.map(u=>a=i(u,a))}update(e,t){var i;let s=e.state.facet(this.facet),a=s.filter(b=>b);if(s===this.input){for(let b of this.tooltipViews)b.update&&b.update(e);return!1}let u=[],m=t?[]:null;for(let b=0;b<a.length;b++){let C=a[b],S=-1;if(C){for(let I=0;I<this.tooltips.length;I++){let W=this.tooltips[I];W&&W.create==C.create&&(S=I)}if(S<0)u[b]=this.createTooltipView(C,b?u[b-1]:null),m&&(m[b]=!!C.above);else{let I=u[b]=this.tooltipViews[S];m&&(m[b]=t[S]),I.update&&I.update(e)}}}for(let b of this.tooltipViews)u.indexOf(b)<0&&(this.removeTooltipView(b),(i=b.destroy)===null||i===void 0||i.call(b));return t&&(m.forEach((b,C)=>t[C]=b),t.length=m.length),this.input=s,this.tooltips=a,this.tooltipViews=u,!0}}function Vl(o={}){return lr.of(o)}function bl(o){let e=o.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const lr=z.sj.define({combine:o=>{var e,t,i;return{position:L.ios?"absolute":((e=o.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=o.find(s=>s.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=o.find(s=>s.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||bl}}}),wo=new WeakMap,Ps=Xt.fromClass(class{constructor(o){this.view=o,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=o.state.facet(lr);this.position=e.position,this.parent=e.parent,this.classes=o.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new or(o,hr,(t,i)=>this.createTooltip(t,i),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),o.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let o of this.manager.tooltipViews)this.intersectionObserver.observe(o.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(o){o.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(o,this.above);e&&this.observeIntersection();let t=e||o.geometryChanged,i=o.state.facet(lr);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(o,e){let t=o.create(this.view),i=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),o.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",t.dom.appendChild(s)}return t.dom.style.position=this.position,t.dom.style.top=Fn,t.dom.style.left="0px",this.container.insertBefore(t.dom,i),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var o,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(o=i.destroy)===null||o===void 0||o.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let o=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:a}=this.manager.tooltipViews[0];if(L.gecko)t=a.offsetParent!=this.container.ownerDocument.body;else if(a.style.top==Fn&&a.style.left=="0px"){let u=a.getBoundingClientRect();t=Math.abs(u.top+1e4)>1||Math.abs(u.left)>1}}if(t||this.position=="absolute")if(this.parent){let a=this.parent.getBoundingClientRect();a.width&&a.height&&(o=a.width/this.parent.offsetWidth,e=a.height/this.parent.offsetHeight)}else({scaleX:o,scaleY:e}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),s=Ni(this.view);return{visible:{left:i.left+s.left,top:i.top+s.top,right:i.right-s.right,bottom:i.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((a,u)=>{let m=this.manager.tooltipViews[u];return m.getCoords?m.getCoords(a.pos):this.view.coordsAtPos(a.pos)}),size:this.manager.tooltipViews.map(({dom:a})=>a.getBoundingClientRect()),space:this.view.state.facet(lr).tooltipSpace(this.view),scaleX:o,scaleY:e,makeAbsolute:t}}writeMeasure(o){var e;if(o.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let m of this.manager.tooltipViews)m.dom.style.position="absolute"}let{visible:t,space:i,scaleX:s,scaleY:a}=o,u=[];for(let m=0;m<this.manager.tooltips.length;m++){let b=this.manager.tooltips[m],C=this.manager.tooltipViews[m],{dom:S}=C,I=o.pos[m],W=o.size[m];if(!I||b.clip!==!1&&(I.bottom<=Math.max(t.top,i.top)||I.top>=Math.min(t.bottom,i.bottom)||I.right<Math.max(t.left,i.left)-.1||I.left>Math.min(t.right,i.right)+.1)){S.style.top=Fn;continue}let U=b.arrow?C.dom.querySelector(".cm-tooltip-arrow"):null,Y=U?7:0,ee=W.right-W.left,re=(e=wo.get(C))!==null&&e!==void 0?e:W.bottom-W.top,se=C.offset||xl,Ce=this.view.textDirection==yt.LTR,Le=W.width>i.right-i.left?Ce?i.left:i.right-W.width:Ce?Math.max(i.left,Math.min(I.left-(U?14:0)+se.x,i.right-ee)):Math.min(Math.max(i.left,I.left-ee+(U?14:0)-se.x),i.right-ee),De=this.above[m];!b.strictSide&&(De?I.top-re-Y-se.y<i.top:I.bottom+re+Y+se.y>i.bottom)&&De==i.bottom-I.bottom>I.top-i.top&&(De=this.above[m]=!De);let He=(De?I.top-i.top:i.bottom-I.bottom)-Y;if(He<re&&C.resize!==!1){if(He<this.view.defaultLineHeight){S.style.top=Fn;continue}wo.set(C,re),S.style.height=(re=He)/a+"px"}else S.style.height&&(S.style.height="");let We=De?I.top-re-Y-se.y:I.bottom+Y+se.y,Ht=Le+ee;if(C.overlap!==!0)for(let fi of u)fi.left<Ht&&fi.right>Le&&fi.top<We+re&&fi.bottom>We&&(We=De?fi.top-re-2-Y:fi.bottom+Y+2);if(this.position=="absolute"?(S.style.top=(We-o.parent.top)/a+"px",ar(S,(Le-o.parent.left)/s)):(S.style.top=We/a+"px",ar(S,Le/s)),U){let fi=I.left+(Ce?se.x:-se.x)-(Le+14-7);U.style.left=fi/s+"px"}C.overlap!==!0&&u.push({left:Le,top:We,right:Ht,bottom:We+re}),S.classList.toggle("cm-tooltip-above",De),S.classList.toggle("cm-tooltip-below",!De),C.positioned&&C.positioned(o.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let o of this.manager.tooltipViews)o.dom.style.top=Fn}},{eventObservers:{scroll(){this.maybeMeasure()}}});function ar(o,e){let t=parseInt(o.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(o.style.left=e+"px")}const Ls=ht.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),xl={x:0,y:0},hr=z.sj.define({enables:[Ps,Ls]}),ss=z.sj.define({combine:o=>o.reduce((e,t)=>e.concat(t),[])});class Bs{static create(e){return new Bs(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new or(e,ss,(t,i)=>this.createHostedView(t,i),t=>t.dom.remove())}createHostedView(e,t){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let i of this.manager.tooltipViews){let s=i[e];if(s!==void 0){if(t===void 0)t=s;else if(t!==s)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const vo=hr.compute([ss],o=>{let e=o.facet(ss);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var i;return(i=t.end)!==null&&i!==void 0?i:t.pos})),create:Bs.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class wl{constructor(e,t,i,s,a){this.view=e,this.source=t,this.field=i,this.setHover=s,this.hoverTime=a,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,i=e.docView.nearest(t.target);if(!i)return;let s,a=1;if(i instanceof be)s=i.posAtStart;else{if(s=e.posAtCoords(t),s==null)return;let m=e.coordsAtPos(s);if(!m||t.y<m.top||t.y>m.bottom||t.x<m.left-e.defaultCharacterWidth||t.x>m.right+e.defaultCharacterWidth)return;let b=e.bidiSpans(e.state.doc.lineAt(s)).find(S=>S.from<=s&&S.to>=s),C=b&&b.dir==yt.RTL?-1:1;a=t.x<m.left?-C:C}let u=this.source(e,s,a);if(u?.then){let m=this.pending={pos:s};u.then(b=>{this.pending==m&&(this.pending=null,b&&!(Array.isArray(b)&&!b.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(b)?b:[b])}))},b=>Et(e.state,b,"hover tooltip"))}else u&&!(Array.isArray(u)&&!u.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(u)?u:[u])})}get tooltip(){let e=this.view.plugin(Ps),t=e?e.manager.tooltips.findIndex(i=>i.create==Bs.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:s,tooltip:a}=this;if(s.length&&a&&!vl(a.dom,e)||this.pending){let{pos:u}=s[0]||this.pending,m=(i=(t=s[0])===null||t===void 0?void 0:t.end)!==null&&i!==void 0?i:u;(u==m?this.view.posAtCoords(this.lastMove)!=u:!ko(this.view,u,m,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=i=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const rs=4;function vl(o,e){let{left:t,right:i,top:s,bottom:a}=o.getBoundingClientRect(),u;if(u=o.querySelector(".cm-tooltip-arrow")){let m=u.getBoundingClientRect();s=Math.min(m.top,s),a=Math.max(m.bottom,a)}return e.clientX>=t-rs&&e.clientX<=i+rs&&e.clientY>=s-rs&&e.clientY<=a+rs}function ko(o,e,t,i,s,a){let u=o.scrollDOM.getBoundingClientRect(),m=o.documentTop+o.documentPadding.top+o.contentHeight;if(u.left>i||u.right<i||u.top>s||Math.min(u.bottom,m)<s)return!1;let b=o.posAtCoords({x:i,y:s},!1);return b>=e&&b<=t}function kl(o,e={}){let t=z.Pe.define(),i=z.sU.define({create(){return[]},update(s,a){if(s.length&&(e.hideOnChange&&(a.docChanged||a.selection)?s=[]:e.hideOn&&(s=s.filter(u=>!e.hideOn(a,u))),a.docChanged)){let u=[];for(let m of s){let b=a.changes.mapPos(m.pos,-1,z.iR.TrackDel);if(b!=null){let C=Object.assign(Object.create(null),m);C.pos=b,C.end!=null&&(C.end=a.changes.mapPos(C.end)),u.push(C)}}s=u}for(let u of a.effects)u.is(t)&&(s=u.value),u.is(jl)&&(s=[]);return s},provide:s=>ss.from(s)});return{active:i,extension:[i,Xt.define(s=>new wl(s,o,i,t,e.hoverTime||300)),vo]}}function _l(o,e){let t=o.plugin(Ps);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}function Sl(o){return o.facet(ss).some(e=>e)}const jl=z.Pe.define(),Yl=null;function Jl(o){let e=o.plugin(Ps);e&&e.maybeMeasure()}const So=z.sj.define({combine(o){let e,t;for(let i of o)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Cl(o){return o?[So.of(o)]:[]}function sn(o,e){let t=o.plugin(Cn),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const Cn=Xt.fromClass(class{constructor(o){this.input=o.state.facet(fr),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(o));let e=o.state.facet(So);this.top=new os(o,!0,e.topContainer),this.bottom=new os(o,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(o){let e=o.state.facet(So);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new os(o.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new os(o.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=o.state.facet(fr);if(t!=this.input){let i=t.filter(b=>b),s=[],a=[],u=[],m=[];for(let b of i){let C=this.specs.indexOf(b),S;C<0?(S=b(o.view),m.push(S)):(S=this.panels[C],S.update&&S.update(o)),s.push(S),(S.top?a:u).push(S)}this.specs=i,this.panels=s,this.top.sync(a),this.bottom.sync(u);for(let b of m)b.dom.classList.add("cm-panel"),b.mount&&b.mount()}else for(let i of this.panels)i.update&&i.update(o)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:o=>ht.scrollMargins.of(e=>{let t=e.plugin(o);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class os{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=cr(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=cr(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function cr(o){let e=o.nextSibling;return o.remove(),e}const fr=z.sj.define({enables:Cn});function ur(o,e){let t,i=new Promise(u=>t=u),s=u=>Ml(u,e,t);o.state.field(ls,!1)?o.dispatch({effects:ci.of(s)}):o.dispatch({effects:StateEffect.appendConfig.of(ls.init(()=>[s]))});let a=Al.of(s);return{close:a,result:i.then(u=>((o.win.queueMicrotask||(b=>o.win.setTimeout(b,10)))(()=>{o.state.field(ls).indexOf(s)>-1&&o.dispatch({effects:a})}),u))}}function Co(o,e){let t=o.state.field(ls,!1)||[];for(let i of t){let s=sn(o,i);if(s&&s.dom.classList.contains(e))return s}return null}const ls=z.sU.define({create(){return[]},update(o,e){for(let t of e.effects)t.is(ci)?o=[t.value].concat(o):t.is(Al)&&(o=o.filter(i=>i!=t.value));return o},provide:o=>fr.computeN([o],e=>e.field(o))}),ci=z.Pe.define(),Al=z.Pe.define();function Ml(o,e,t){let i=e.content?e.content(o,()=>u(null)):null;if(!i){if(i=elt("form"),e.input){let m=elt("input",e.input);/^(text|password|number|email|tel|url)$/.test(m.type)&&m.classList.add("cm-textfield"),m.name||(m.name="input"),i.appendChild(elt("label",(e.label||"")+": ",m))}else i.appendChild(document.createTextNode(e.label||""));i.appendChild(document.createTextNode(" ")),i.appendChild(elt("button",{class:"cm-button",type:"submit"},e.submitLabel||"OK"))}let s=i.nodeName=="FORM"?[i]:i.querySelectorAll("form");for(let m=0;m<s.length;m++){let b=s[m];b.addEventListener("keydown",C=>{C.keyCode==27?(C.preventDefault(),u(null)):C.keyCode==13&&(C.preventDefault(),u(b))}),b.addEventListener("submit",C=>{C.preventDefault(),u(b)})}let a=elt("div",i,elt("button",{onclick:()=>u(null),"aria-label":o.state.phrase("close"),class:"cm-dialog-close",type:"button"},["\xD7"]));e.class&&(a.className=e.class),a.classList.add("cm-dialog");function u(m){a.contains(a.ownerDocument.activeElement)&&o.focus(),t(m)}return{dom:a,top:e.top,mount:()=>{if(e.focus){let m;typeof e.focus=="string"?m=i.querySelector(e.focus):m=i.querySelector("input")||i.querySelector("button"),m&&"select"in m?m.select():m&&"focus"in m&&m.focus()}}}}class qi extends z.FB{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}qi.prototype.elementClass="",qi.prototype.toDOM=void 0,qi.prototype.mapMode=z.iR.TrackBefore,qi.prototype.startSide=qi.prototype.endSide=-1,qi.prototype.point=!0;const as=z.sj.define(),Ol=z.sj.define(),Ao={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>z.om.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},hs=z.sj.define();function Kl(o){return[pr(),hs.of({...Ao,...o})]}const dr=z.sj.define({combine:o=>o.some(e=>e)});function pr(o){let e=[$l];return o&&o.fixed===!1&&e.push(dr.of(!0)),e}const $l=Xt.fromClass(class{constructor(o){this.view=o,this.prevViewport=o.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=o.state.facet(hs).map(e=>new mr(o,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!o.state.facet(dr),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),o.scrollDOM.insertBefore(this.dom,o.contentDOM)}update(o){if(this.updateGutters(o)){let e=this.prevViewport,t=o.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}o.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(dr)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=o.view.viewport}syncGutters(o){let e=this.dom.nextSibling;o&&this.dom.remove();let t=z.om.iter(this.view.state.facet(as),this.view.viewport.from),i=[],s=this.gutters.map(a=>new ql(a,this.view.viewport,-this.view.documentPadding.top));for(let a of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(a.type)){let u=!0;for(let m of a.type)if(m.type==tt.Text&&u){Mo(t,i,m.from);for(let b of s)b.line(this.view,m,i);u=!1}else if(m.widget)for(let b of s)b.widget(this.view,m)}else if(a.type==tt.Text){Mo(t,i,a.from);for(let u of s)u.line(this.view,a,i)}else if(a.widget)for(let u of s)u.widget(this.view,a);for(let a of s)a.finish();o&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(o){let e=o.startState.facet(hs),t=o.state.facet(hs),i=o.docChanged||o.heightChanged||o.viewportChanged||!z.om.eq(o.startState.facet(as),o.state.facet(as),o.view.viewport.from,o.view.viewport.to);if(e==t)for(let s of this.gutters)s.update(o)&&(i=!0);else{i=!0;let s=[];for(let a of t){let u=e.indexOf(a);u<0?s.push(new mr(this.view,a)):(this.gutters[u].update(o),s.push(this.gutters[u]))}for(let a of this.gutters)a.dom.remove(),s.indexOf(a)<0&&a.destroy();for(let a of s)this.dom.appendChild(a.dom);this.gutters=s}return i}destroy(){for(let o of this.gutters)o.destroy();this.dom.remove()}},{provide:o=>ht.scrollMargins.of(e=>{let t=e.plugin(o);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==yt.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function An(o){return Array.isArray(o)?o:[o]}function Mo(o,e,t){for(;o.value&&o.from<=t;)o.from==t&&e.push(o.value),o.next()}class ql{constructor(e,t,i){this.gutter=e,this.height=i,this.i=0,this.cursor=z.om.iter(e.markers,t.from)}addElement(e,t,i){let{gutter:s}=this,a=(t.top-this.height)/e.scaleY,u=t.height/e.scaleY;if(this.i==s.elements.length){let m=new gr(e,u,a,i);s.elements.push(m),s.dom.appendChild(m.dom)}else s.elements[this.i].update(e,u,a,i);this.height=t.bottom,this.i++}line(e,t,i){let s=[];Mo(this.cursor,s,t.from),i.length&&(s=s.concat(i));let a=this.gutter.config.lineMarker(e,t,s);a&&s.unshift(a);let u=this.gutter;s.length==0&&!u.config.renderEmptyElements||this.addElement(e,t,s)}widget(e,t){let i=this.gutter.config.widgetMarker(e,t.widget,t),s=i?[i]:null;for(let a of e.state.facet(Ol)){let u=a(e,t.widget,t);u&&(s||(s=[])).push(u)}s&&this.addElement(e,t,s)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class mr{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,s=>{let a=s.target,u;if(a!=this.dom&&this.dom.contains(a)){for(;a.parentNode!=this.dom;)a=a.parentNode;let b=a.getBoundingClientRect();u=(b.top+b.bottom)/2}else u=s.clientY;let m=e.lineBlockAtHeight(u-e.documentTop);t.domEventHandlers[i](e,m,s)&&s.preventDefault()});this.markers=An(t.markers(e)),t.initialSpacer&&(this.spacer=new gr(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=An(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let i=e.view.viewport;return!z.om.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class gr{constructor(e,t,i,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,s)}update(e,t,i,s){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),Dl(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,t){let i="cm-gutterElement",s=this.dom.firstChild;for(let a=0,u=0;;){let m=u,b=a<t.length?t[a++]:null,C=!1;if(b){let S=b.elementClass;S&&(i+=" "+S);for(let I=u;I<this.markers.length;I++)if(this.markers[I].compare(b)){m=I,C=!0;break}}else m=this.markers.length;for(;u<m;){let S=this.markers[u++];if(S.toDOM){S.destroy(s);let I=s.nextSibling;s.remove(),s=I}}if(!b)break;b.toDOM&&(C?s=s.nextSibling:this.dom.insertBefore(b.toDOM(e),s)),C&&u++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function Dl(o,e){if(o.length!=e.length)return!1;for(let t=0;t<o.length;t++)if(!o[t].compare(e[t]))return!1;return!0}const Oo=z.sj.define(),cs=z.sj.define(),Ui=z.sj.define({combine(o){return(0,z.QR)(o,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let s in t){let a=i[s],u=t[s];i[s]=a?(m,b,C)=>a(m,b,C)||u(m,b,C):u}return i}})}});class Hn extends qi{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function yr(o,e){return o.state.facet(Ui).formatNumber(e,o.state)}const Tl=hs.compute([Ui],o=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(Oo)},lineMarker(e,t,i){return i.some(s=>s.toDOM)?null:new Hn(yr(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,i)=>{for(let s of e.state.facet(cs)){let a=s(e,t,i);if(a)return a}return null},lineMarkerChange:e=>e.startState.facet(Ui)!=e.state.facet(Ui),initialSpacer(e){return new Hn(yr(e,br(e.state.doc.lines)))},updateSpacer(e,t){let i=yr(t.view,br(t.view.state.doc.lines));return i==e.number?e:new Hn(i)},domEventHandlers:o.facet(Ui).domEventHandlers}));function Do(o={}){return[Ui.of(o),pr(),Tl]}function br(o){let e=9;for(;e<o;)e=e*10+9;return e}const Pl=new class extends qi{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Ll=as.compute(["selection"],o=>{let e=[],t=-1;for(let i of o.selection.ranges){let s=o.doc.lineAt(i.head).from;s>t&&(t=s,e.push(Pl.range(s)))}return z.om.of(e)});function Bl(){return Ll}function To(o){return Xt.define(e=>({decorations:o.createDeco(e),update(t){this.decorations=o.updateDeco(t,this.decorations)}}),{decorations:e=>e.decorations})}const xr=ue.mark({class:"cm-highlightTab"}),wr=ue.mark({class:"cm-highlightSpace"}),Po=To(new nn({regexp:/\t| /g,decoration:o=>o[0]=="	"?xr:wr,boundary:/\S/}));function Ul(){return Po}const Lo=To(new nn({regexp:/\s+$/g,decoration:ue.mark({class:"cm-trailingSpace"})}));function vr(){return Lo}const Xl={HeightMap:Zt,HeightOracle:Jo,MeasuredHeights:xs,QueryType:Dt,ChangedRange:A,computeOrder:Ei,moveVisually:_i,clearHeightChangeFlag:Kr,getHeightChangeFlag:()=>mi}},98104:(hn,ni,Qe)=>{Qe.d(ni,{G:()=>J});const z="\u037C",Be=typeof Symbol>"u"?"__"+z:Symbol.for(z),ae=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),R=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class J{constructor(it,$e){this.rules=[];let{finish:we}=$e||{};function Pe(Se){return/^@/.test(Se)?[Se]:Se.split(/,\s*/)}function Ee(Se,Ne,qe,he){let je=[],ut=/^@(\w+)\b/.exec(Se[0]),Ot=ut&&ut[1]=="keyframes";if(ut&&Ne==null)return qe.push(Se[0]+";");for(let Rt in Ne){let at=Ne[Rt];if(/&/.test(Rt))Ee(Rt.split(/,\s*/).map(jt=>Se.map(Kt=>jt.replace(/&/,Kt))).reduce((jt,Kt)=>jt.concat(Kt)),at,qe);else if(at&&typeof at=="object"){if(!ut)throw new RangeError("The value of a property ("+Rt+") should be a primitive value.");Ee(Pe(Rt),at,je,Ot)}else at!=null&&je.push(Rt.replace(/_.*/,"").replace(/[A-Z]/g,jt=>"-"+jt.toLowerCase())+": "+at+";")}(je.length||Ot)&&qe.push((we&&!ut&&!he?Se.map(we):Se).join(", ")+" {"+je.join(" ")+"}")}for(let Se in it)Ee(Pe(Se),it[Se],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let it=R[Be]||1;return R[Be]=it+1,z+it.toString(36)}static mount(it,$e,we){let Pe=it[ae],Ee=we&&we.nonce;Pe?Ee&&Pe.setNonce(Ee):Pe=new ze(it,Ee),Pe.mount(Array.isArray($e)?$e:[$e],it)}}let Ae=new Map;class ze{constructor(it,$e){let we=it.ownerDocument||it,Pe=we.defaultView;if(!it.head&&it.adoptedStyleSheets&&Pe.CSSStyleSheet){let Ee=Ae.get(we);if(Ee)return it[ae]=Ee;this.sheet=new Pe.CSSStyleSheet,Ae.set(we,this)}else this.styleTag=we.createElement("style"),$e&&this.styleTag.setAttribute("nonce",$e);this.modules=[],it[ae]=this}mount(it,$e){let we=this.sheet,Pe=0,Ee=0;for(let Se=0;Se<it.length;Se++){let Ne=it[Se],qe=this.modules.indexOf(Ne);if(qe<Ee&&qe>-1&&(this.modules.splice(qe,1),Ee--,qe=-1),qe==-1){if(this.modules.splice(Ee++,0,Ne),we)for(let he=0;he<Ne.rules.length;he++)we.insertRule(Ne.rules[he],Pe++)}else{for(;Ee<qe;)Pe+=this.modules[Ee++].rules.length;Pe+=Ne.rules.length,Ee++}}if(we)$e.adoptedStyleSheets.indexOf(this.sheet)<0&&($e.adoptedStyleSheets=[this.sheet,...$e.adoptedStyleSheets]);else{let Se="";for(let qe=0;qe<this.modules.length;qe++)Se+=this.modules[qe].getRules()+`
`;this.styleTag.textContent=Se;let Ne=$e.head||$e;this.styleTag.parentNode!=Ne&&Ne.insertBefore(this.styleTag,Ne.firstChild)}}setNonce(it){this.styleTag&&this.styleTag.getAttribute("nonce")!=it&&this.styleTag.setAttribute("nonce",it)}}}}]);})();

//# sourceMappingURL=7868.b477eb13.chunk.js.map