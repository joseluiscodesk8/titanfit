"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9219],{29219:(Bt,T,n)=>{n.r(T),n.d(T,{ArgoCDDetailsCard:()=>bt});var e=n(14041),I=n(58007),M=n(8109),z=n(71677),L=n(77125),E=n(64947),P=n(88951),h=n(52950),b=n(53538),H=n(41078),x=n(65229),W=n(48475),O=n(18139),B=n(54195),Y=n(80663),Z=n(36978),G=n(77714),X=n(16400),J=n(32293),K=n(58837),N=n(42899),S=n(72501),Q=n(29365),k=n(73845),w=n(95479),q=n.n(w),y=n(99703),g=n(7031),_=n(61009),tt=n(13677),F=n(54801),et=n(9719);const at=t=>(0,y.A)({root:{fontWeight:t.typography.fontWeightBold,whiteSpace:"nowrap",paddingRight:t.spacing(4),border:"0",verticalAlign:"top"}}),nt={root:{border:"0",verticalAlign:"top"}},st=t=>(0,y.A)({root:{margin:t.spacing(0,0,-1,0)}}),lt=t=>(0,y.A)({root:{padding:t.spacing(0,0,1,0)},random:{}}),rt=(0,g.A)(at,{name:"BackstageMetadataTableTitleCell"})(F.A),ot=(0,g.A)(nt,{name:"BackstageMetadataTableCell"})(F.A),ct=({dense:t,children:a})=>e.createElement(_.A,{size:t?"small":"medium"},e.createElement(tt.A,null,a)),it=({title:t,children:a,...s})=>e.createElement(et.A,null,t&&e.createElement(rt,null,t),e.createElement(ot,{colSpan:t?1:2,...s},a)),D=(0,g.A)(st,{name:"BackstageMetadataTableList"})(({classes:t,children:a})=>e.createElement(I.A,{disablePadding:!0,className:t.root},a)),R=(0,g.A)(lt,{name:"BackstageMetadataTableListItem"})(({classes:t,children:a})=>e.createElement(M.A,{className:t.root},a));var mt=n(49375),dt=n(9911);const j=(0,y.A)({root:{margin:"0 0",listStyleType:"none"}}),gt=t=>(0,y.A)({root:{...j.root,paddingLeft:t.spacing(1)}}),U=(0,g.A)(j,{name:"BackstageStructuredMetadataTableList"})(({classes:t,children:a})=>e.createElement(D,{classes:t},a)),V=(0,g.A)(gt,{name:"BackstageStructuredMetadataTableNestedList"})(({classes:t,children:a})=>e.createElement(D,{classes:t},a));function ut(t,a,s){const r=t.map((c,i)=>e.createElement(R,{key:i},C(c,a,s)));return s?e.createElement(V,null,r):e.createElement(U,null,r)}function pt(t,a,s){const r=Object.keys(t).map(c=>{const i=C(t[c],a,!0);return e.createElement(R,{key:c},e.createElement(S.A,{variant:"body2",component:"span"},`${a.titleFormat(c)}: `),i)});return s?e.createElement(V,null,r):e.createElement(U,null,r)}function C(t,a,s){if(e.isValidElement(t))return e.createElement(e.Fragment,null,t);if(t!==null&&typeof t=="object"){if(a.nestedValuesAsYaml)return e.createElement(mt.z,{language:"yaml",text:dt.Ay.dump(t),customStyle:{background:"transparent",lineHeight:"1.4",padding:"0",margin:0}});if(!Array.isArray(t))return pt(t,a,s)}return Array.isArray(t)?ut(t,a,s):typeof t=="boolean"?e.createElement(e.Fragment,null,t?"\u2705":"\u274C"):e.createElement(S.A,{variant:"body2",component:"span"},t)}const ft=({value:t,options:a})=>e.createElement(e.Fragment,null,C(t,a,!1)),yt=({title:t,value:a,options:s})=>e.createElement(it,{title:s.titleFormat(t)},e.createElement(ft,{value:a,options:s}));function At(t,a){return Object.keys(t).map(s=>e.createElement(yt,{key:s,title:s,value:t[s],options:a}))}function Et(t){const{metadata:a,dense:s=!0,options:r}=t,c=At(a,{titleFormat:q(),nestedValuesAsYaml:r?.nestedValuesAsYaml??!1,...r});return e.createElement(ct,{dense:s},c)}var ht=n(39330),St=n(32881);const Ct=(0,K.A)({paper:{padding:"2em"},header:{display:"flex",flexDirection:"row",paddingBottom:"2em"},button:{textTransform:"none",justifyContent:"flex-start",fontWeight:"bold"},icon:{fontSize:20},content:{height:"80%"}}),vt=(t,a)=>{const s=Ct(),[r,c]=e.useState(!1),p=(0,O.gf)(B.U).getOptionalBoolean("argocd.namespacedApps")??!1,m=l=>o=>{o.type==="keydown"&&(o.key==="Tab"||o.key==="Shift")||c(l)},A={"Argo CD Instance":t.metadata?.instance?.name??"",repoUrl:t.spec?.source?.repoURL,repoPath:t.spec?.source?.path,destinationServer:t.spec?.destination?.server,destinationNamespace:t.spec?.destination?.namespace,syncStatus:t.status?.sync?.status,images:t.status?.summary?.images,...a&&{link:e.createElement(E.A,{variant:"outlined",color:"primary",size:"small",title:"Open Argo CD Dashboard",endIcon:e.createElement(ht.A,null),target:"_blank",href:`${a}/applications/${p?`${t.metadata.namespace}/${t.metadata.name}`:t.metadata.name}`},"Open Argo CD Dashboard")}},f=()=>e.createElement(e.Fragment,null,e.createElement("div",{className:s.header},e.createElement(N.A,{container:!0,direction:"column",justifyContent:"flex-start",alignItems:"flex-start"},e.createElement(N.A,{item:!0},e.createElement(S.A,{variant:"h5"},"Argo Name: ",t.metadata.name))),e.createElement(Q.A,{key:"dismiss",title:"Close the drawer",onClick:()=>c(!1),color:"inherit"},e.createElement(St.A,null))),e.createElement("div",{className:s.content},e.createElement(Et,{metadata:A})));return e.createElement(e.Fragment,null,e.createElement(E.A,{title:t.metadata.name,className:s.button,onClick:m(!0)},t.metadata.name),e.createElement(k.Ay,{anchor:"right",classes:{paper:s.paper},open:r,onClose:m(!1)},f()))},u="ArgoCD overview",Tt=({conditions:t})=>{const[a,s]=(0,e.useState)([]);return(0,e.useEffect)(()=>{s(t?.map(r=>({key:`${r.lastTransitionTime}-${r.type}`,...r}))||[])},[t]),e.createElement(e.Fragment,null,a?e.createElement(I.A,{dense:!0},a.map(r=>e.createElement(M.A,{style:{padding:0},key:r.key},r.message))):null)},It=t=>h.c9.fromISO(t).toRelative(),Mt=t=>t.finishedAt?It(t.finishedAt):t.phase,$=({value:t,conditions:a})=>{const s={Pending:"#dcbc21",Synced:"green",Healthy:"green",Inactive:"black",Failed:"red"};return a!==void 0?e.createElement(z.Ay,{title:e.createElement(Tt,{conditions:a}),placement:"bottom-start"},e.createElement(L.A,{display:"flex",alignItems:"center"},e.createElement(E.A,{style:{paddingLeft:"0px"}},e.createElement("span",{style:{display:"block",width:"8px",height:"8px",borderRadius:"50%",backgroundColor:s[t]||"#dcbc21",marginRight:"5px"}}),t))):e.createElement(L.A,{display:"flex",alignItems:"center"},e.createElement("span",{style:{display:"block",width:"8px",height:"8px",borderRadius:"50%",backgroundColor:s[t]||"#dcbc21",marginRight:"5px"}}),t)},v=({data:t,extraColumns:a,title:s,subtitle:r,retry:c})=>{const i=(0,O.gf)(B.U),p=i.getOptionalString("argocd.baseUrl"),m=!!i.getOptionalConfigArray("argocd.appLocatorMethods")?.length,A=l=>{if(m&&!p){const o=i.getConfigArray("argocd.appLocatorMethods").find(d=>d.getOptionalString("type")==="config")?.getOptionalConfigArray("instances")?.find(d=>d.getOptionalString("name")===l.metadata?.instance?.name);return o?.getOptionalString("frontendUrl")??o?.getOptionalString("url")}return p},f=[{title:"Name",highlight:!0,field:"name",render:l=>vt(l,A(l)),customSort:(l,o)=>l.metadata.name.localeCompare(o.metadata.name)},{title:"Sync Status",field:"syncStatus",render:l=>e.createElement($,{value:l.status.sync.status,conditions:l.status.conditions}),customSort:(l,o)=>l.status.sync.status.localeCompare(o.status.sync.status)},{title:"Health Status",field:"healthStatus",render:l=>e.createElement($,{value:l.status.health.status,conditions:void 0}),customSort:(l,o)=>l.status.health.status.localeCompare(o.status.health.status)},{title:"Last Synced",defaultSort:"desc",field:"lastSynced",render:l=>l.status.operationState?Mt(l.status.operationState):"",customSort:(l,o)=>h.c9.fromISO(l.status.operationState?.finishedAt||"3000-01-01T00:00:00.000Z").toMillis()-h.c9.fromISO(o.status.operationState?.finishedAt||"3000-01-01T00:00:00.000Z").toMillis()}];return m&&f.splice(1,0,{title:"Instance",field:"instance",render:l=>l.metadata?.instance?.name,customSort:(l,o)=>l.metadata?.instance?.name.localeCompare(o.metadata?.instance?.name)}),e.createElement(H.X,{title:s??u,subtitle:r,options:{paging:!0,search:!1,sorting:!0,draggable:!1,padding:"dense"},data:t.items||[],columns:f.concat(a),actions:[{icon:()=>e.createElement(G.A,null),tooltip:"Refresh",isFreeAction:!0,onClick:()=>c()}]})},Lt=({entity:t,extraColumns:a,title:s,subtitle:r})=>{const{url:c,appName:i,appSelector:p,appNamespace:m,projectName:A}=(0,b.nD)({entity:t}),{loading:f,value:l,error:o,retry:d}=(0,Z.T)({url:c,appName:i,appSelector:p,appNamespace:m,projectName:A});if(f)return e.createElement(x.n,{title:s??u,subheader:r},e.createElement(P.A,null));if(o)return e.createElement(x.n,{title:s??u,subheader:r},"Error occurred while fetching data. ",o.name,": ",o.message);if(l){if(l.items!==void 0)return e.createElement(v,{data:l,retry:d,extraColumns:a,title:s??u,subtitle:r??""});if(Array.isArray(l)){const Ot={items:l};return e.createElement(v,{data:Ot,retry:d,extraColumns:a,title:s??u,subtitle:r??""})}const xt={items:[l]};return e.createElement(v,{data:xt,retry:d,extraColumns:a,title:s??u,subtitle:r??""})}return null},bt=t=>{const{entity:a}=(0,X.tN)();return(0,Y.a)(a)?e.createElement(W.t,null,e.createElement(Lt,{entity:a,extraColumns:t.extraColumns||[],title:t.title,subtitle:t.subtitle})):e.createElement(J.o,{annotation:b.TV})}}}]);})();

//# sourceMappingURL=9219.c8ec22b3.chunk.js.map