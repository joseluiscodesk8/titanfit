"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2288],{46996:(Xr,jr,k)=>{var Ct=k(9002);const H=(0,Ct.M)({logLevelEnvVarName:"AZURE_LOG_LEVEL",namespace:"azure"}),Yr=H.logger;function Jr(t){H.setLogLevel(t)}function Gr(){return H.getLogLevel()}function V(t){return H.createClientLogger(t)}var At=k(39907);const P=V("identity");function vt(t){return t.reduce((e,n)=>(At.env[n]?e.assigned.push(n):e.missing.push(n),e),{missing:[],assigned:[]})}function Zr(t,e){const{assigned:n}=vt(e);P.info(`${t} => Found the following environment variables: ${n.join(", ")}`)}function bt(t){return`SUCCESS. Scopes: ${Array.isArray(t)?t.join(", "):t}.`}function W(t,e){let n="ERROR.";return t?.length&&(n+=` Scopes: ${Array.isArray(t)?t.join(", "):t}.`),`${n} Error message: ${typeof e=="string"?e:e.message}.`}function Ae(t,e,n=P){const r=e?`${e.fullTitle} ${t}`:t;function i(c){n.info(`${r} =>`,c)}function o(c){n.warning(`${r} =>`,c)}function a(c){n.verbose(`${r} =>`,c)}function s(c){n.error(`${r} =>`,c)}return{title:t,fullTitle:r,info:i,warning:o,verbose:a,error:s}}function E(t,e=P){const n=Ae(t,void 0,e);return Object.assign(Object.assign({},n),{parent:e,getToken:Ae("=> getToken()",n,e)})}function Tt(t){return t&&typeof t.error=="string"&&typeof t.error_description=="string"}const Et="CredentialUnavailableError";class St extends Error{constructor(e,n){super(e,n),this.name=Et}}const ve="AuthenticationError";class Pt extends Error{constructor(e,n,r){let i={error:"unknown",errorDescription:"An unknown error occurred and no additional details are available."};if(Tt(n))i=be(n);else if(typeof n=="string")try{const o=JSON.parse(n);i=be(o)}catch{e===400?i={error:"invalid_request",errorDescription:`The service indicated that the request was invalid.

${n}`}:i={error:"unknown_error",errorDescription:`An unknown error has occurred. Response body:

${n}`}}else i={error:"unknown_error",errorDescription:"An unknown error occurred and no additional details are available."};super(`${i.error} Status code: ${e}
More details:
${i.errorDescription},`,r),this.statusCode=e,this.errorResponse=i,this.name=ve}}const xt="AggregateAuthenticationError";class _t extends Error{constructor(e,n){const r=e.join(`
`);super(`${n}
${r}`),this.errors=e,this.name=xt}}function be(t){return{error:t.error,errorDescription:t.error_description,correlationId:t.correlation_id,errorCodes:t.error_codes,timestamp:t.timestamp,traceId:t.trace_id}}class Qr extends Error{constructor(e){super(e.message,e.cause?{cause:e.cause}:void 0),this.scopes=e.scopes,this.getTokenOptions=e.getTokenOptions,this.name="AuthenticationRequiredError"}}const Te="4.10.0",ei="04b07795-8ddb-461a-bbee-02f9e1bf7b46",ti="common";var fe;(function(t){t.AzureChina="https://login.chinacloudapi.cn",t.AzureGermany="https://login.microsoftonline.de",t.AzureGovernment="https://login.microsoftonline.us",t.AzurePublicCloud="https://login.microsoftonline.com"})(fe||(fe={}));const Rt=fe.AzurePublicCloud,ni="login.microsoftonline.com",ri=null,ii="cae",oi="nocae",ai="msal.cache",L={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function It(t={}){let e=new U(t.parentContext);return t.span&&(e=e.setValue(L.span,t.span)),t.namespace&&(e=e.setValue(L.namespace,t.namespace)),e}class U{constructor(e){this._contextMap=e instanceof U?new Map(e._contextMap):new Map}setValue(e,n){const r=new U(this);return r._contextMap.set(e,n),r}getValue(e){return this._contextMap.get(e)}deleteValue(e){const n=new U(this);return n._contextMap.delete(e),n}}const he={instrumenterImplementation:void 0};function kt(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{},addEvent:()=>{}}}function Ot(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(t,e)=>({span:kt(),tracingContext:It({parentContext:e.tracingContext})}),withContext(t,e,...n){return e(...n)}}}function si(t){state.instrumenterImplementation=t}function F(){return he.instrumenterImplementation||(he.instrumenterImplementation=Ot()),he.instrumenterImplementation}function Ee(t){const{namespace:e,packageName:n,packageVersion:r}=t;function i(l,u,f){var d;const h=F().startSpan(l,Object.assign(Object.assign({},f),{packageName:n,packageVersion:r,tracingContext:(d=u?.tracingOptions)===null||d===void 0?void 0:d.tracingContext}));let g=h.tracingContext;const p=h.span;g.getValue(L.namespace)||(g=g.setValue(L.namespace,e)),p.setAttribute("az.namespace",g.getValue(L.namespace));const w=Object.assign({},u,{tracingOptions:Object.assign(Object.assign({},u?.tracingOptions),{tracingContext:g})});return{span:p,updatedOptions:w}}async function o(l,u,f,d){const{span:h,updatedOptions:g}=i(l,u,d);try{const p=await a(g.tracingOptions.tracingContext,()=>Promise.resolve(f(g,h)));return h.setStatus({status:"success"}),p}catch(p){throw h.setStatus({status:"error",error:p}),p}finally{h.end()}}function a(l,u,...f){return F().withContext(l,u,...f)}function s(l){return F().parseTraceparentHeader(l)}function c(l){return F().createRequestHeaders(l)}return{startSpan:i,withSpan:o,withContext:a,parseTraceparentHeader:s,createRequestHeaders:c}}const Se=Ee({namespace:"Microsoft.AAD",packageName:"@azure/identity",packageVersion:Te}),me=E("ChainedTokenCredential");class $t{constructor(...e){this._sources=[],this._sources=e}async getToken(e,n={}){const{token:r}=await this.getTokenInternal(e,n);return r}async getTokenInternal(e,n={}){let r=null,i;const o=[];return Se.withSpan("ChainedTokenCredential.getToken",n,async a=>{for(let s=0;s<this._sources.length&&r===null;s++)try{r=await this._sources[s].getToken(e,a),i=this._sources[s]}catch(c){if(c.name==="CredentialUnavailableError"||c.name==="AuthenticationRequiredError")o.push(c);else throw me.getToken.info(W(e,c)),c}if(!r&&o.length>0){const s=new _t(o,"ChainedTokenCredential authentication failed.");throw me.getToken.info(W(e,s)),s}if(me.getToken.info(`Result for ${i.constructor.name}: ${bt(e)}`),r===null)throw new St("Failed to retrieve a valid token");return{token:r,successfulCredential:i}})}}const K=new Error("DefaultAzureCredential is not supported in the browser. Use InteractiveBrowserCredential instead."),Pe=E("DefaultAzureCredential");class li extends $t{constructor(e){throw super(),Pe.info(W("",K)),K}getToken(){throw Pe.getToken.info(W("",K)),K}}var x=k(47481);class Nt extends Error{constructor(e){super(e),this.name="AbortError"}}function Dt(t,e){const{cleanupBeforeAbort:n,abortSignal:r,abortErrorMsg:i}=e??{};return new Promise((o,a)=>{function s(){a(new Nt(i??"The operation was aborted."))}function c(){r?.removeEventListener("abort",l)}function l(){n?.(),c(),s()}if(r?.aborted)return s();try{t(u=>{c(),o(u)},u=>{c(),a(u)})}catch(u){a(u)}r?.addEventListener("abort",l)})}const Mt="The delay was aborted.";function zt(t,e){let n;const{abortSignal:r,abortErrorMsg:i}=e??{};return Dt(o=>{n=setTimeout(o,t)},{cleanupBeforeAbort:()=>clearTimeout(n),abortSignal:r,abortErrorMsg:i??Mt})}function ci(t,e){const n=e.retryDelayInMs*Math.pow(2,t),r=Math.min(e.maxRetryDelayInMs,n);return{retryAfterInMs:r/2+getRandomIntegerInclusive(0,r/2)}}function X(t){if((0,x.bJ)(t))return t.message;{let e;try{typeof t=="object"&&t?e=JSON.stringify(t):e=String(t)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}function ui(t,e){return tspRuntime.calculateRetryDelay(t,e)}function di(t,e){return tspRuntime.computeSha256Hash(t,e)}function fi(t,e,n){return tspRuntime.computeSha256Hmac(t,e,n)}function hi(t,e){return tspRuntime.getRandomIntegerInclusive(t,e)}function Lt(t){return x.bJ(t)}function mi(t){return tspRuntime.isObject(t)}function gi(){return tspRuntime.randomUUID()}const pi=x.Bd,yi=x.Qg,wi=x.N6,Ut=x.qx,xe=x.qx,Ci=x.tX,Ai=x.lV,vi=x.p7;function bi(t,e){return tspRuntime.uint8ArrayToString(t,e)}function Ti(t,e){return tspRuntime.stringToUint8Array(t,e)}var qt=k(39907);const q=E("IdentityUtils"),_e="1.0";function Ei(t,e,n){const r=i=>(q.getToken.info(i),new AuthenticationRequiredError({scopes:Array.isArray(t)?t:[t],getTokenOptions:n,message:i}));if(!e)throw r("No response");if(!e.expiresOn)throw r('Response had no "expiresOn" property.');if(!e.accessToken)throw r('Response had no "accessToken" property.')}function Si(t){let e=t?.authorityHost;return!e&&isNodeLike&&(e=qt.env.AZURE_AUTHORITY_HOST),e??DefaultAuthorityHost}function Pi(t,e){return e||(e=DefaultAuthorityHost),new RegExp(`${t}/?$`).test(e)?e:e.endsWith("/")?e+t:`${e}/${t}`}function xi(t,e,n){return t==="adfs"&&e||n?[e]:[]}const _i=(t,e=isNode?"Node":"Browser")=>(n,r,i)=>{if(!i)switch(n){case msalCommon.LogLevel.Error:t.info(`MSAL ${e} V2 error: ${r}`);return;case msalCommon.LogLevel.Info:t.info(`MSAL ${e} V2 info message: ${r}`);return;case msalCommon.LogLevel.Verbose:t.info(`MSAL ${e} V2 verbose message: ${r}`);return;case msalCommon.LogLevel.Warning:t.info(`MSAL ${e} V2 warning: ${r}`);return}};function Ri(t){switch(t){case"error":return msalCommon.LogLevel.Error;case"info":return msalCommon.LogLevel.Info;case"verbose":return msalCommon.LogLevel.Verbose;case"warning":return msalCommon.LogLevel.Warning;default:return msalCommon.LogLevel.Info}}function Ii(){return coreRandomUUID()}function ki(t,e,n){if(e.name==="AuthError"||e.name==="ClientAuthError"||e.name==="BrowserAuthError"){const r=e;switch(r.errorCode){case"endpoints_resolution_error":return q.info(formatError(t,e.message)),new CredentialUnavailableError(e.message);case"device_code_polling_cancelled":return new AbortError("The authentication has been aborted by the caller.");case"consent_required":case"interaction_required":case"login_required":q.info(formatError(t,`Authentication returned errorCode ${r.errorCode}`));break;default:q.info(formatError(t,`Failed to acquire token: ${e.message}`));break}}return e.name==="ClientConfigurationError"||e.name==="BrowserConfigurationAuthError"||e.name==="AbortError"||e.name==="AuthenticationError"?e:e.name==="NativeAuthError"?(q.info(formatError(t,`Error from the native broker: ${e.message} with status code: ${e.statusCode}`)),e):new AuthenticationRequiredError({scopes:t,getTokenOptions:n,message:e.message})}function Oi(t){return{localAccountId:t.homeAccountId,environment:t.authority,username:t.username,homeAccountId:t.homeAccountId,tenantId:t.tenantId}}function $i(t,e){var n;return{authority:(n=e.environment)!==null&&n!==void 0?n:DefaultAuthority,homeAccountId:e.homeAccountId,tenantId:e.tenantId||DefaultTenantId,username:e.username,clientId:t,version:_e}}function Ni(t){return JSON.stringify(t)}function Di(t){const e=JSON.parse(t);if(e.version&&e.version!==_e)throw Error("Unsupported AuthenticationRecord version");return e}var $=k(79995);function Bt(){return(0,$.O8)()}const N=V("core-rest-pipeline");var R=k(17822);const Mi=null;function Ht(t={}){return(0,R.rO)(Object.assign({logger:N.info},t))}const zi=null;function Vt(t={}){return(0,R.xF)(t)}function Wt(){return"x-ms-useragent"}function Ft(t){const e=[{name:"Firefox",regex:/Firefox\/([\d.]+)/},{name:"Safari",regex:/Version\/([\d.]+).*Safari/}];for(const n of e){const r=t.match(n.regex);if(r)return{brand:n.name,version:r[1]}}}function Kt(t){const e=["Google Chrome","Microsoft Edge","Opera","Brave","Chromium"];for(const n of e){const r=t.find(i=>i.brand===n);if(r)return r}}async function Xt(t){const e=globalThis.navigator;let n="unknown";if(e?.userAgentData){const r=await e.userAgentData.getHighEntropyValues(["architecture","platformVersion"]);n=`${r.architecture}-${r.platform}-${r.platformVersion}`;const i=Kt(e.userAgentData.brands);i&&t.set(i.brand,i.version)}else if(e?.platform){n=e.platform;const r=Ft(e.userAgent);r&&t.set(r.brand,r.version)}else typeof globalThis.EdgeRuntime=="string"&&t.set("EdgeRuntime",globalThis.EdgeRuntime);t.set("OS",n)}const Re="1.21.0",Li=3;function jt(t){const e=[];for(const[n,r]of t){const i=r?`${n}/${r}`:n;e.push(i)}return e.join(" ")}function Yt(){return Wt()}async function Ie(t){const e=new Map;e.set("core-rest-pipeline",Re),await Xt(e);const n=jt(e);return t?`${t} ${n}`:n}const ke=Yt(),Jt="userAgentPolicy";function Gt(t={}){const e=Ie(t.userAgentPrefix);return{name:Jt,async sendRequest(n,r){return n.headers.has(ke)||n.headers.set(ke,await e),r(n)}}}function Zt(t){return!!(t&&typeof t.pipe=="function")}const Oe={arrayBuffer:()=>{throw new Error("Not implemented")},bytes:()=>{throw new Error("Not implemented")},slice:()=>{throw new Error("Not implemented")},text:()=>{throw new Error("Not implemented")}},j=Symbol("rawContent");function $e(t){return typeof t[j]=="function"}function Qt(t){return $e(t)?t[j]():t}function Ui(t,e,n={}){var r,i,o,a;return Object.assign(Object.assign({},Oe),{type:(r=n.type)!==null&&r!==void 0?r:"",lastModified:(i=n.lastModified)!==null&&i!==void 0?i:new Date().getTime(),webkitRelativePath:(o=n.webkitRelativePath)!==null&&o!==void 0?o:"",size:(a=n.size)!==null&&a!==void 0?a:-1,name:e,stream:()=>{const s=t();if(Zt(s))throw new Error("Not supported: a Node stream was provided as input to createFileFromStream.");return s},[j]:t})}function qi(t,e,n={}){var r,i,o;return isNodeLike?Object.assign(Object.assign({},Oe),{type:(r=n.type)!==null&&r!==void 0?r:"",lastModified:(i=n.lastModified)!==null&&i!==void 0?i:new Date().getTime(),webkitRelativePath:(o=n.webkitRelativePath)!==null&&o!==void 0?o:"",size:t.byteLength,name:e,arrayBuffer:async()=>t.buffer,stream:()=>new Blob([t]).stream(),[j]:()=>t}):new File([t],e,n)}const Ne=R.uD;function en(){const t=(0,R.JA)();return{name:Ne,sendRequest:async(e,n)=>{if(e.multipartBody)for(const r of e.multipartBody.parts)$e(r.body)&&(r.body=Qt(r.body));return t.sendRequest(e,n)}}}const Bi=null;function tn(){return(0,R.rQ)()}const Hi=null;function nn(t={}){return(0,R.ur)(t)}const Vi=null;function rn(){return(0,R.jh)()}const Wi=null;function Fi(t){return tspGetDefaultProxySettings(t)}function on(t,e){return(0,R.Ll)(t,e)}const an="setClientRequestIdPolicy";function sn(t="x-ms-client-request-id"){return{name:an,async sendRequest(e,n){return e.headers.has(t)||e.headers.set(t,e.requestId),n(e)}}}const Ki=null;function ln(t){return(0,R.ew)(t)}const Xi=null;function cn(t){return(0,R.iY)(t)}const Y=$.pj;function De(t){return(0,$.T0)(t)}const un="tracingPolicy";function dn(t={}){const e=Ie(t.userAgentPrefix),n=new x.If({additionalAllowedQueryParameters:t.additionalAllowedQueryParameters}),r=fn();return{name:un,async sendRequest(i,o){var a;if(!r)return o(i);const s=await e,c={"http.url":n.sanitizeUrl(i.url),"http.method":i.method,"http.user_agent":s,requestId:i.requestId};s&&(c["http.user_agent"]=s);const{span:l,tracingContext:u}=(a=hn(r,i,c))!==null&&a!==void 0?a:{};if(!l||!u)return o(i);try{const f=await r.withContext(u,o,i);return gn(l,f),f}catch(f){throw mn(l,f),f}}}}function fn(){try{return Ee({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:Re})}catch(t){N.warning(`Error when creating the TracingClient: ${X(t)}`);return}}function hn(t,e,n){try{const{span:r,updatedOptions:i}=t.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:n});if(!r.isRecording()){r.end();return}const o=t.createRequestHeaders(i.tracingOptions.tracingContext);for(const[a,s]of Object.entries(o))e.headers.set(a,s);return{span:r,tracingContext:i.tracingOptions.tracingContext}}catch(r){N.warning(`Skipping creating a tracing span due to an error: ${X(r)}`);return}}function mn(t,e){try{t.setStatus({status:"error",error:Lt(e)?e:void 0}),De(e)&&e.statusCode&&t.setAttribute("http.status_code",e.statusCode),t.end()}catch(n){N.warning(`Skipping tracing span processing due to an error: ${X(n)}`)}}function gn(t,e){try{t.setAttribute("http.status_code",e.status);const n=e.headers.get("x-ms-request-id");n&&t.setAttribute("serviceRequestId",n),e.status>=400&&t.setStatus({status:"error"}),t.end()}catch(n){N.warning(`Skipping tracing span processing due to an error: ${X(n)}`)}}function Me(t){if(t instanceof AbortSignal)return{abortSignal:t};if(t.aborted)return{abortSignal:AbortSignal.abort(t.reason)};const e=new AbortController;let n=!0;function r(){n&&(t.removeEventListener("abort",i),n=!1)}function i(){e.abort(t.reason),r()}return t.addEventListener("abort",i),{abortSignal:e.signal,cleanup:r}}const pn="wrapAbortSignalLikePolicy";function yn(){return{name:pn,sendRequest:async(t,e)=>{if(!t.abortSignal)return e(t);const{abortSignal:n,cleanup:r}=Me(t.abortSignal);t.abortSignal=n;try{return await e(t)}finally{r?.()}}}}function wn(t){var e;const n=Bt();return xe&&(t.agent&&n.addPolicy(ln(t.agent)),t.tlsOptions&&n.addPolicy(cn(t.tlsOptions)),n.addPolicy(on(t.proxyOptions)),n.addPolicy(tn())),n.addPolicy(yn()),n.addPolicy(rn(),{beforePolicies:[Ne]}),n.addPolicy(Gt(t.userAgentOptions)),n.addPolicy(sn((e=t.telemetryOptions)===null||e===void 0?void 0:e.clientRequestIdHeaderName)),n.addPolicy(en(),{afterPhase:"Deserialize"}),n.addPolicy(nn(t.retryOptions),{phase:"Retry"}),n.addPolicy(dn(Object.assign(Object.assign({},t.userAgentOptions),t.loggingOptions)),{afterPhase:"Retry"}),xe&&n.addPolicy(Vt(t.redirectOptions),{afterPhase:"Retry"}),n.addPolicy(Ht(t.loggingOptions),{afterPhase:"Sign"}),n}function Cn(){const t=(0,$.fl)();return{async sendRequest(e){const{abortSignal:n,cleanup:r}=e.abortSignal?Me(e.abortSignal):{};try{return e.abortSignal=n,await t.sendRequest(e)}finally{r?.()}}}}function ge(t){return(0,$.Nc)(t)}function J(t){return(0,$.G6)(t)}const ji=null;function Yi(t={}){return tspExponentialRetryPolicy(t)}const Ji=null;function Gi(t={}){return tspSystemErrorRetryPolicy(t)}const Zi=null;function Qi(t={}){return tspThrottlingRetryPolicy(t)}const An=V("core-rest-pipeline retryPolicy");function eo(t,e={maxRetries:DEFAULT_RETRY_POLICY_COUNT}){return tspRetryPolicy(t,Object.assign({logger:An},e))}const vn={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2};async function bn(t,e,n){async function r(){if(Date.now()<n)try{return await t()}catch{return null}else{const o=await t();if(o===null)throw new Error("Failed to refresh access token.");return o}}let i=await r();for(;i===null;)await zt(e),i=await r();return i}function Tn(t,e){let n=null,r=null,i;const o=Object.assign(Object.assign({},vn),e),a={get isRefreshing(){return n!==null},get shouldRefresh(){var c;return a.isRefreshing?!1:r?.refreshAfterTimestamp&&r.refreshAfterTimestamp<Date.now()?!0:((c=r?.expiresOnTimestamp)!==null&&c!==void 0?c:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return r===null||r.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function s(c,l){var u;return a.isRefreshing||(n=bn(()=>t.getToken(c,l),o.retryIntervalInMs,(u=r?.expiresOnTimestamp)!==null&&u!==void 0?u:Date.now()).then(d=>(n=null,r=d,i=l.tenantId,r)).catch(d=>{throw n=null,r=null,i=void 0,d})),n}return async(c,l)=>{const u=!!l.claims,f=i!==l.tenantId;return u&&(r=null),f||u||a.mustRefresh?s(c,l):(a.shouldRefresh&&s(c,l),r)}}const En="bearerTokenAuthenticationPolicy";async function G(t,e){try{return[await e(t),void 0]}catch(n){if(De(n)&&n.response)return[n.response,n];throw n}}async function Sn(t){const{scopes:e,getAccessToken:n,request:r}=t,i={abortSignal:r.abortSignal,tracingOptions:r.tracingOptions,enableCae:!0},o=await n(e,i);o&&t.request.headers.set("Authorization",`Bearer ${o.token}`)}function ze(t){return t.status===401&&t.headers.has("WWW-Authenticate")}async function Le(t,e){var n;const{scopes:r}=t,i=await t.getAccessToken(r,{enableCae:!0,claims:e});return i?(t.request.headers.set("Authorization",`${(n=i.tokenType)!==null&&n!==void 0?n:"Bearer"} ${i.token}`),!0):!1}function Pn(t){var e,n,r;const{credential:i,scopes:o,challengeCallbacks:a}=t,s=t.logger||N,c={authorizeRequest:(n=(e=a?.authorizeRequest)===null||e===void 0?void 0:e.bind(a))!==null&&n!==void 0?n:Sn,authorizeRequestOnChallenge:(r=a?.authorizeRequestOnChallenge)===null||r===void 0?void 0:r.bind(a)},l=i?Tn(i):()=>Promise.resolve(null);return{name:En,async sendRequest(u,f){if(!u.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await c.authorizeRequest({scopes:Array.isArray(o)?o:[o],request:u,getAccessToken:l,logger:s});let d,h,g;if([d,h]=await G(u,f),ze(d)){let p=Ue(d.headers.get("WWW-Authenticate"));if(p){let w;try{w=atob(p)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${p}`),d}g=await Le({scopes:Array.isArray(o)?o:[o],response:d,request:u,getAccessToken:l,logger:s},w),g&&([d,h]=await G(u,f))}else if(c.authorizeRequestOnChallenge&&(g=await c.authorizeRequestOnChallenge({scopes:Array.isArray(o)?o:[o],request:u,response:d,getAccessToken:l,logger:s}),g&&([d,h]=await G(u,f)),ze(d)&&(p=Ue(d.headers.get("WWW-Authenticate")),p))){let w;try{w=atob(p)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${p}`),d}g=await Le({scopes:Array.isArray(o)?o:[o],response:d,request:u,getAccessToken:l,logger:s},w),g&&([d,h]=await G(u,f))}}if(h)throw h;return d}}}function xn(t){const e=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,n=/(\w+)="([^"]*)"/g,r=[];let i;for(;(i=e.exec(t))!==null;){const o=i[1],a=i[2],s={};let c;for(;(c=n.exec(a))!==null;)s[c[1]]=c[2];r.push({scheme:o,params:s})}return r}function Ue(t){var e;return t?(e=xn(t).find(r=>r.scheme==="Bearer"&&r.params.claims&&r.params.error==="insufficient_claims"))===null||e===void 0?void 0:e.params.claims:void 0}const qe="auxiliaryAuthenticationHeaderPolicy",Be="x-ms-authorization-auxiliary";async function _n(t){var e,n;const{scopes:r,getAccessToken:i,request:o}=t,a={abortSignal:o.abortSignal,tracingOptions:o.tracingOptions};return(n=(e=await i(r,a))===null||e===void 0?void 0:e.token)!==null&&n!==void 0?n:""}function to(t){const{credentials:e,scopes:n}=t,r=t.logger||coreLogger,i=new WeakMap;return{name:qe,async sendRequest(o,a){if(!o.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication for auxiliary header is not permitted for non-TLS protected (non-https) URLs.");if(!e||e.length===0)return r.info(`${qe} header will not be set due to empty credentials.`),a(o);const s=[];for(const l of e){let u=i.get(l);u||(u=createTokenCycler(l),i.set(l,u)),s.push(_n({scopes:Array.isArray(n)?n:[n],request:o,getAccessToken:u,logger:r}))}const c=(await Promise.all(s)).filter(l=>!!l);return c.length===0?(r.warning(`None of the auxiliary tokens are valid. ${Be} header will not be set.`),a(o)):(o.headers.set(Be,c.map(l=>`Bearer ${l}`).join(", ")),a(o))}}}function Rn(t,e){if(!e.match(/^[0-9a-zA-Z-.]+$/)){const n=new Error("Invalid tenant id provided. You can locate your tenant id by following the instructions listed here: https://learn.microsoft.com/partner-center/find-ids-and-domain-names.");throw t.info(formatError("",n)),n}}function no(t,e,n){return e?(Rn(t,e),e):(n||(n=DeveloperSignOnClientId),n!==DeveloperSignOnClientId?"common":"organizations")}function ro(t){return!t||t.length===0?[]:t.includes("*")?ALL_TENANTS:t}class In{constructor(e={},n=!1){this.modelMappers=e,this.isXML=n}validateConstraints(e,n,r){const i=(o,a)=>{throw new Error(`"${r}" with value "${n}" should satisfy the constraint "${o}": ${a}.`)};if(e.constraints&&n!==void 0&&n!==null){const{ExclusiveMaximum:o,ExclusiveMinimum:a,InclusiveMaximum:s,InclusiveMinimum:c,MaxItems:l,MaxLength:u,MinItems:f,MinLength:d,MultipleOf:h,Pattern:g,UniqueItems:p}=e.constraints;if(o!==void 0&&n>=o&&i("ExclusiveMaximum",o),a!==void 0&&n<=a&&i("ExclusiveMinimum",a),s!==void 0&&n>s&&i("InclusiveMaximum",s),c!==void 0&&n<c&&i("InclusiveMinimum",c),l!==void 0&&n.length>l&&i("MaxItems",l),u!==void 0&&n.length>u&&i("MaxLength",u),f!==void 0&&n.length<f&&i("MinItems",f),d!==void 0&&n.length<d&&i("MinLength",d),h!==void 0&&n%h!==0&&i("MultipleOf",h),g){const w=typeof g=="string"?new RegExp(g):g;(typeof n!="string"||n.match(w)===null)&&i("Pattern",g)}p&&n.some((w,A,S)=>S.indexOf(w)!==A)&&i("UniqueItems",p)}}serialize(e,n,r,i={xml:{}}){var o,a,s;const c={xml:{rootName:(o=i.xml.rootName)!==null&&o!==void 0?o:"",includeRoot:(a=i.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=i.xml.xmlCharKey)!==null&&s!==void 0?s:XML_CHARKEY}};let l={};const u=e.type.name;r||(r=e.serializedName),u.match(/^Sequence$/i)!==null&&(l=[]),e.isConstant&&(n=e.defaultValue);const{required:f,nullable:d}=e;if(f&&d&&n===void 0)throw new Error(`${r} cannot be undefined.`);if(f&&!d&&n==null)throw new Error(`${r} cannot be null or undefined.`);if(!f&&d===!1&&n===null)throw new Error(`${r} cannot be null.`);return n==null||u.match(/^any$/i)!==null?l=n:u.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)!==null?l=Mn(u,r,n):u.match(/^Enum$/i)!==null?l=zn(r,e.type.allowedValues,n):u.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)!==null?l=qn(u,n,r):u.match(/^ByteArray$/i)!==null?l=Ln(r,n):u.match(/^Base64Url$/i)!==null?l=Un(r,n):u.match(/^Sequence$/i)!==null?l=Bn(this,e,n,r,!!this.isXML,c):u.match(/^Dictionary$/i)!==null?l=Hn(this,e,n,r,!!this.isXML,c):u.match(/^Composite$/i)!==null&&(l=Wn(this,e,n,r,!!this.isXML,c)),l}deserialize(e,n,r,i={xml:{}}){var o,a,s,c;const l={xml:{rootName:(o=i.xml.rootName)!==null&&o!==void 0?o:"",includeRoot:(a=i.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=i.xml.xmlCharKey)!==null&&s!==void 0?s:XML_CHARKEY},ignoreUnknownProperties:(c=i.ignoreUnknownProperties)!==null&&c!==void 0?c:!1};if(n==null)return this.isXML&&e.type.name==="Sequence"&&!e.xmlIsWrapped&&(n=[]),e.defaultValue!==void 0&&(n=e.defaultValue),n;let u;const f=e.type.name;if(r||(r=e.serializedName),f.match(/^Composite$/i)!==null)u=Kn(this,e,n,r,l);else{if(this.isXML){const d=l.xml.xmlCharKey;n[XML_ATTRKEY]!==void 0&&n[d]!==void 0&&(n=n[d])}f.match(/^Number$/i)!==null?(u=parseFloat(n),isNaN(u)&&(u=n)):f.match(/^Boolean$/i)!==null?n==="true"?u=!0:n==="false"?u=!1:u=n:f.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)!==null?u=n:f.match(/^(Date|DateTime|DateTimeRfc1123)$/i)!==null?u=new Date(n):f.match(/^UnixTime$/i)!==null?u=Dn(n):f.match(/^ByteArray$/i)!==null?u=base64.decodeString(n):f.match(/^Base64Url$/i)!==null?u=$n(n):f.match(/^Sequence$/i)!==null?u=jn(this,e,n,r,l):f.match(/^Dictionary$/i)!==null&&(u=Xn(this,e,n,r,l))}return e.isConstant&&(u=e.defaultValue),u}}function io(t={},e=!1){return new In(t,e)}function kn(t,e){let n=t.length;for(;n-1>=0&&t[n-1]===e;)--n;return t.substr(0,n)}function On(t){if(!t)return;if(!(t instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");const e=base64.encodeByteArray(t);return kn(e,"=").replace(/\+/g,"-").replace(/\//g,"_")}function $n(t){if(t){if(t&&typeof t.valueOf()!="string")throw new Error("Please provide an input of type string for converting to Uint8Array");return t=t.replace(/-/g,"+").replace(/_/g,"/"),base64.decodeString(t)}}function pe(t){const e=[];let n="";if(t){const r=t.split(".");for(const i of r)i.charAt(i.length-1)==="\\"?n+=i.substr(0,i.length-1)+".":(n+=i,e.push(n),n="")}return e}function Nn(t){if(t)return typeof t.valueOf()=="string"&&(t=new Date(t)),Math.floor(t.getTime()/1e3)}function Dn(t){if(t)return new Date(t*1e3)}function Mn(t,e,n){if(n!=null){if(t.match(/^Number$/i)!==null){if(typeof n!="number")throw new Error(`${e} with value ${n} must be of type number.`)}else if(t.match(/^String$/i)!==null){if(typeof n.valueOf()!="string")throw new Error(`${e} with value "${n}" must be of type string.`)}else if(t.match(/^Uuid$/i)!==null){if(!(typeof n.valueOf()=="string"&&isValidUuid(n)))throw new Error(`${e} with value "${n}" must be of type string and a valid uuid.`)}else if(t.match(/^Boolean$/i)!==null){if(typeof n!="boolean")throw new Error(`${e} with value ${n} must be of type boolean.`)}else if(t.match(/^Stream$/i)!==null){const r=typeof n;if(r!=="string"&&typeof n.pipe!="function"&&typeof n.tee!="function"&&!(n instanceof ArrayBuffer)&&!ArrayBuffer.isView(n)&&!((typeof Blob=="function"||typeof Blob=="object")&&n instanceof Blob)&&r!=="function")throw new Error(`${e} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}}return n}function zn(t,e,n){if(!e)throw new Error(`Please provide a set of allowedValues to validate ${t} as an Enum Type.`);if(!e.some(i=>typeof i.valueOf()=="string"?i.toLowerCase()===n.toLowerCase():i===n))throw new Error(`${n} is not a valid value for ${t}. The valid values are: ${JSON.stringify(e)}.`);return n}function Ln(t,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${t} must be of type Uint8Array.`);e=base64.encodeByteArray(e)}return e}function Un(t,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${t} must be of type Uint8Array.`);e=On(e)}return e}function qn(t,e,n){if(e!=null){if(t.match(/^Date$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString().substring(0,10):new Date(e).toISOString().substring(0,10)}else if(t.match(/^DateTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString():new Date(e).toISOString()}else if(t.match(/^DateTimeRfc1123$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123 format.`);e=e instanceof Date?e.toUTCString():new Date(e).toUTCString()}else if(t.match(/^UnixTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);e=Nn(e)}else if(t.match(/^TimeSpan$/i)!==null&&!isDuration(e))throw new Error(`${n} must be a string in ISO 8601 format. Instead was "${e}".`)}return e}function Bn(t,e,n,r,i,o){var a;if(!Array.isArray(n))throw new Error(`${r} must be of type Array.`);let s=e.type.element;if(!s||typeof s!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}.`);s.type.name==="Composite"&&s.type.className&&(s=(a=t.modelMappers[s.type.className])!==null&&a!==void 0?a:s);const c=[];for(let l=0;l<n.length;l++){const u=t.serialize(s,n[l],r,o);if(i&&s.xmlNamespace){const f=s.xmlNamespacePrefix?`xmlns:${s.xmlNamespacePrefix}`:"xmlns";s.type.name==="Composite"?(c[l]=Object.assign({},u),c[l][XML_ATTRKEY]={[f]:s.xmlNamespace}):(c[l]={},c[l][o.xml.xmlCharKey]=u,c[l][XML_ATTRKEY]={[f]:s.xmlNamespace})}else c[l]=u}return c}function Hn(t,e,n,r,i,o){if(typeof n!="object")throw new Error(`${r} must be of type object.`);const a=e.type.value;if(!a||typeof a!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}.`);const s={};for(const c of Object.keys(n)){const l=t.serialize(a,n[c],r,o);s[c]=We(a,l,i,o)}if(i&&e.xmlNamespace){const c=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",l=s;return l[XML_ATTRKEY]={[c]:e.xmlNamespace},l}return s}function Vn(t,e,n){const r=e.type.additionalProperties;if(!r&&e.type.className){const i=He(t,e,n);return i?.type.additionalProperties}return r}function He(t,e,n){const r=e.type.className;if(!r)throw new Error(`Class name for model "${n}" is not provided in the mapper "${JSON.stringify(e,void 0,2)}".`);return t.modelMappers[r]}function Ve(t,e,n){let r=e.type.modelProperties;if(!r){const i=He(t,e,n);if(!i)throw new Error(`mapper() cannot be null or undefined for model "${e.type.className}".`);if(r=i?.type.modelProperties,!r)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(i)}" of type "${e.type.className}" for object "${n}".`)}return r}function Wn(t,e,n,r,i,o){if(Z(t,e)&&(e=Fe(t,e,n,"clientName")),n!=null){const a={},s=Ve(t,e,r);for(const l of Object.keys(s)){const u=s[l];if(u.readOnly)continue;let f,d=a;if(t.isXML)u.xmlIsWrapped?f=u.xmlName:f=u.xmlElementName||u.xmlName;else{const h=pe(u.serializedName);f=h.pop();for(const g of h){const p=d[g];p==null&&(n[l]!==void 0&&n[l]!==null||u.defaultValue!==void 0)&&(d[g]={}),d=d[g]}}if(d!=null){if(i&&e.xmlNamespace){const A=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns";d[XML_ATTRKEY]=Object.assign(Object.assign({},d[XML_ATTRKEY]),{[A]:e.xmlNamespace})}const h=u.serializedName!==""?r+"."+u.serializedName:r;let g=n[l];const p=Z(t,e);p&&p.clientName===l&&g==null&&(g=e.serializedName);const w=t.serialize(u,g,h,o);if(w!==void 0&&f!==void 0&&f!==null){const A=We(u,w,i,o);i&&u.xmlIsAttribute?(d[XML_ATTRKEY]=d[XML_ATTRKEY]||{},d[XML_ATTRKEY][f]=w):i&&u.xmlIsWrapped?d[f]={[u.xmlElementName]:A}:d[f]=A}}}const c=Vn(t,e,r);if(c){const l=Object.keys(s);for(const u in n)l.every(d=>d!==u)&&(a[u]=t.serialize(c,n[u],r+'["'+u+'"]',o))}return a}return n}function We(t,e,n,r){if(!n||!t.xmlNamespace)return e;const o={[t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns"]:t.xmlNamespace};if(["Composite"].includes(t.type.name)){if(e[XML_ATTRKEY])return e;{const s=Object.assign({},e);return s[XML_ATTRKEY]=o,s}}const a={};return a[r.xml.xmlCharKey]=e,a[XML_ATTRKEY]=o,a}function Fn(t,e){return[XML_ATTRKEY,e.xml.xmlCharKey].includes(t)}function Kn(t,e,n,r,i){var o,a;const s=(o=i.xml.xmlCharKey)!==null&&o!==void 0?o:XML_CHARKEY;Z(t,e)&&(e=Fe(t,e,n,"serializedName"));const c=Ve(t,e,r);let l={};const u=[];for(const d of Object.keys(c)){const h=c[d],g=pe(c[d].serializedName);u.push(g[0]);const{serializedName:p,xmlName:w,xmlElementName:A}=h;let S=r;p!==""&&p!==void 0&&(S=r+"."+p);const _=h.headerCollectionPrefix;if(_){const C={};for(const v of Object.keys(n))v.startsWith(_)&&(C[v.substring(_.length)]=t.deserialize(h.type.value,n[v],S,i)),u.push(v);l[d]=C}else if(t.isXML)if(h.xmlIsAttribute&&n[XML_ATTRKEY])l[d]=t.deserialize(h,n[XML_ATTRKEY][w],S,i);else if(h.xmlIsMsText)n[s]!==void 0?l[d]=n[s]:typeof n=="string"&&(l[d]=n);else{const C=A||w||p;if(h.xmlIsWrapped){const v=n[w],y=(a=v?.[A])!==null&&a!==void 0?a:[];l[d]=t.deserialize(h,y,S,i),u.push(w)}else{const v=n[C];l[d]=t.deserialize(h,v,S,i),u.push(C)}}else{let C,v=n,y=0;for(const b of g){if(!v)break;y++,v=v[b]}v===null&&y<g.length&&(v=void 0),C=v;const m=e.type.polymorphicDiscriminator;m&&d===m.clientName&&C==null&&(C=e.serializedName);let T;if(Array.isArray(n[d])&&c[d].serializedName===""){C=n[d];const b=t.deserialize(h,C,S,i);for(const[I,Ce]of Object.entries(l))Object.prototype.hasOwnProperty.call(b,I)||(b[I]=Ce);l=b}else(C!==void 0||h.defaultValue!==void 0)&&(T=t.deserialize(h,C,S,i),l[d]=T)}}const f=e.type.additionalProperties;if(f){const d=h=>{for(const g in c)if(pe(c[g].serializedName)[0]===h)return!1;return!0};for(const h in n)d(h)&&(l[h]=t.deserialize(f,n[h],r+'["'+h+'"]',i))}else if(n&&!i.ignoreUnknownProperties)for(const d of Object.keys(n))l[d]===void 0&&!u.includes(d)&&!Fn(d,i)&&(l[d]=n[d]);return l}function Xn(t,e,n,r,i){const o=e.type.value;if(!o||typeof o!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}`);if(n){const a={};for(const s of Object.keys(n))a[s]=t.deserialize(o,n[s],r,i);return a}return n}function jn(t,e,n,r,i){var o;let a=e.type.element;if(!a||typeof a!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}`);if(n){Array.isArray(n)||(n=[n]),a.type.name==="Composite"&&a.type.className&&(a=(o=t.modelMappers[a.type.className])!==null&&o!==void 0?o:a);const s=[];for(let c=0;c<n.length;c++)s[c]=t.deserialize(a,n[c],`${r}[${c}]`,i);return s}return n}function Yn(t,e,n){const r=[n];for(;r.length;){const i=r.shift(),o=e===i?e:i+"."+e;if(Object.prototype.hasOwnProperty.call(t,o))return t[o];for(const[a,s]of Object.entries(t))a.startsWith(i+".")&&s.type.uberParent===i&&s.type.className&&r.push(s.type.className)}}function Fe(t,e,n,r){var i;const o=Z(t,e);if(o){let a=o[r];if(a){r==="serializedName"&&(a=a.replace(/\\/gi,""));const s=n[a],c=(i=e.type.uberParent)!==null&&i!==void 0?i:e.type.className;if(typeof s=="string"&&c){const l=Yn(t.modelMappers.discriminators,s,c);l&&(e=l)}}}return e}function Z(t,e){return e.type.polymorphicDiscriminator||Ke(t,e.type.uberParent)||Ke(t,e.type.className)}function Ke(t,e){return e&&t.modelMappers[e]&&t.modelMappers[e].type.polymorphicDiscriminator}const D={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"},Xe="$",je="_",Ye={operationRequestMap:new WeakMap};function M(t,e,n){let r=e.parameterPath;const i=e.mapper;let o;if(typeof r=="string"&&(r=[r]),Array.isArray(r)){if(r.length>0)if(i.isConstant)o=i.defaultValue;else{let a=Je(t,r);!a.propertyFound&&n&&(a=Je(n,r));let s=!1;a.propertyFound||(s=i.required||r[0]==="options"&&r.length===2),o=s?i.defaultValue:a.propertyValue}}else{i.required&&(o={});for(const a in r){const s=i.type.modelProperties[a],c=r[a],l=M(t,{parameterPath:c,mapper:s},n);l!==void 0&&(o||(o={}),o[a]=l)}}return o}function Je(t,e){const n={propertyFound:!1};let r=0;for(;r<e.length;++r){const i=e[r];if(t&&i in t)t=t[i];else break}return r===e.length&&(n.propertyValue=t,n.propertyFound=!0),n}const Ge=Symbol.for("@azure/core-client original request");function Jn(t){return Ge in t}function z(t){if(Jn(t))return z(t[Ge]);let e=Ye.operationRequestMap.get(t);return e||(e={},Ye.operationRequestMap.set(t,e)),e}const Gn=["application/json","text/json"],Zn=["application/xml","application/atom+xml"],Qn="deserializationPolicy";function er(t={}){var e,n,r,i,o,a,s;const c=(n=(e=t.expectedContentTypes)===null||e===void 0?void 0:e.json)!==null&&n!==void 0?n:Gn,l=(i=(r=t.expectedContentTypes)===null||r===void 0?void 0:r.xml)!==null&&i!==void 0?i:Zn,u=t.parseXML,f=t.serializerOptions,d={xml:{rootName:(o=f?.xml.rootName)!==null&&o!==void 0?o:"",includeRoot:(a=f?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=f?.xml.xmlCharKey)!==null&&s!==void 0?s:je}};return{name:Qn,async sendRequest(h,g){const p=await g(h);return rr(c,l,p,d,u)}}}function tr(t){let e;const n=t.request,r=z(n),i=r?.operationSpec;return i&&(r?.operationResponseGetter?e=r?.operationResponseGetter(i,t):e=i.responses[t.status]),e}function nr(t){const e=t.request,n=z(e),r=n?.shouldDeserialize;let i;return r===void 0?i=!0:typeof r=="boolean"?i=r:i=r(t),i}async function rr(t,e,n,r,i){const o=await ar(t,e,n,r,i);if(!nr(o))return o;const a=z(o.request),s=a?.operationSpec;if(!s||!s.responses)return o;const c=tr(o),{error:l,shouldReturnResponse:u}=or(o,s,c,r);if(l)throw l;if(u)return o;if(c){if(c.bodyMapper){let f=o.parsedBody;s.isXML&&c.bodyMapper.type.name===D.Sequence&&(f=typeof f=="object"?f[c.bodyMapper.xmlElementName]:[]);try{o.parsedBody=s.serializer.deserialize(c.bodyMapper,f,"operationRes.parsedBody",r)}catch(d){throw new Y(`Error ${d} occurred in deserializing the responseBody - ${o.bodyAsText}`,{statusCode:o.status,request:o.request,response:o})}}else s.httpMethod==="HEAD"&&(o.parsedBody=n.status>=200&&n.status<300);c.headersMapper&&(o.parsedHeaders=s.serializer.deserialize(c.headersMapper,o.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return o}function ir(t){const e=Object.keys(t.responses);return e.length===0||e.length===1&&e[0]==="default"}function or(t,e,n,r){var i,o,a,s,c;const l=200<=t.status&&t.status<300;if(ir(e)?l:!!n)if(n){if(!n.isError)return{error:null,shouldReturnResponse:!1}}else return{error:null,shouldReturnResponse:!1};const f=n??e.responses.default,d=!((i=t.request.streamResponseStatusCodes)===null||i===void 0)&&i.has(t.status)?`Unexpected status code: ${t.status}`:t.bodyAsText,h=new Y(d,{statusCode:t.status,request:t.request,response:t});if(!f&&!(!((a=(o=t.parsedBody)===null||o===void 0?void 0:o.error)===null||a===void 0)&&a.code&&(!((c=(s=t.parsedBody)===null||s===void 0?void 0:s.error)===null||c===void 0)&&c.message)))throw h;const g=f?.bodyMapper,p=f?.headersMapper;try{if(t.parsedBody){const w=t.parsedBody;let A;if(g){let _=w;if(e.isXML&&g.type.name===D.Sequence){_=[];const C=g.xmlElementName;typeof w=="object"&&C&&(_=w[C])}A=e.serializer.deserialize(g,_,"error.response.parsedBody",r)}const S=w.error||A||w;h.code=S.code,S.message&&(h.message=S.message),g&&(h.response.parsedBody=A)}t.headers&&p&&(h.response.parsedHeaders=e.serializer.deserialize(p,t.headers.toJSON(),"operationRes.parsedHeaders"))}catch(w){h.message=`Error "${w.message}" occurred in deserializing the responseBody - "${t.bodyAsText}" for the default response.`}return{error:h,shouldReturnResponse:!1}}async function ar(t,e,n,r,i){var o;if(!(!((o=n.request.streamResponseStatusCodes)===null||o===void 0)&&o.has(n.status))&&n.bodyAsText){const a=n.bodyAsText,s=n.headers.get("Content-Type")||"",c=s?s.split(";").map(l=>l.toLowerCase()):[];try{if(c.length===0||c.some(l=>t.indexOf(l)!==-1))return n.parsedBody=JSON.parse(a),n;if(c.some(l=>e.indexOf(l)!==-1)){if(!i)throw new Error("Parsing XML not supported.");const l=await i(a,r.xml);return n.parsedBody=l,n}}catch(l){const u=`Error "${l}" occurred while parsing the response body - ${n.bodyAsText}.`,f=l.code||Y.PARSE_ERROR;throw new Y(u,{code:f,statusCode:n.status,request:n.request,response:n})}}return n}function sr(t){const e=new Set;for(const n in t.responses){const r=t.responses[n];r.bodyMapper&&r.bodyMapper.type.name===D.Stream&&e.add(Number(n))}return e}function O(t){const{parameterPath:e,mapper:n}=t;let r;return typeof e=="string"?r=e:Array.isArray(e)?r=e.join("."):r=n.serializedName,r}const lr="serializationPolicy";function cr(t={}){const e=t.stringifyXML;return{name:lr,async sendRequest(n,r){const i=z(n),o=i?.operationSpec,a=i?.operationArguments;return o&&a&&(ur(n,a,o),dr(n,a,o,e)),r(n)}}}function ur(t,e,n){var r,i;if(n.headerParameters)for(const a of n.headerParameters){let s=M(e,a);if(s!=null||a.mapper.required){s=n.serializer.serialize(a.mapper,s,O(a));const c=a.mapper.headerCollectionPrefix;if(c)for(const l of Object.keys(s))t.headers.set(c+l,s[l]);else t.headers.set(a.mapper.serializedName||O(a),s)}}const o=(i=(r=e.options)===null||r===void 0?void 0:r.requestOptions)===null||i===void 0?void 0:i.customHeaders;if(o)for(const a of Object.keys(o))t.headers.set(a,o[a])}function dr(t,e,n,r=function(){throw new Error("XML serialization unsupported!")}){var i,o,a,s,c;const l=(i=e.options)===null||i===void 0?void 0:i.serializerOptions,u={xml:{rootName:(o=l?.xml.rootName)!==null&&o!==void 0?o:"",includeRoot:(a=l?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=l?.xml.xmlCharKey)!==null&&s!==void 0?s:je}},f=u.xml.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){t.body=M(e,n.requestBody);const d=n.requestBody.mapper,{required:h,serializedName:g,xmlName:p,xmlElementName:w,xmlNamespace:A,xmlNamespacePrefix:S,nullable:_}=d,C=d.type.name;try{if(t.body!==void 0&&t.body!==null||_&&t.body===null||h){const v=O(n.requestBody);t.body=n.serializer.serialize(d,t.body,v,u);const y=C===D.Stream;if(n.isXML){const m=S?`xmlns:${S}`:"xmlns",T=fr(A,m,C,t.body,u);C===D.Sequence?t.body=r(hr(T,w||p||g,m,A),{rootName:p||g,xmlCharKey:f}):y||(t.body=r(T,{rootName:p||g,xmlCharKey:f}))}else{if(C===D.String&&(!((c=n.contentType)===null||c===void 0)&&c.match("text/plain")||n.mediaType==="text"))return;y||(t.body=JSON.stringify(t.body))}}}catch(v){throw new Error(`Error "${v.message}" occurred in serializing the payload - ${JSON.stringify(g,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(const d of n.formDataParameters){const h=M(e,d);if(h!=null){const g=d.mapper.serializedName||O(d);t.formData[g]=n.serializer.serialize(d.mapper,h,O(d),u)}}}}function fr(t,e,n,r,i){if(t&&!["Composite","Sequence","Dictionary"].includes(n)){const o={};return o[i.xml.xmlCharKey]=r,o[Xe]={[e]:t},o}return r}function hr(t,e,n,r){if(Array.isArray(t)||(t=[t]),!n||!r)return{[e]:t};const i={[e]:t};return i[Xe]={[n]:r},i}function mr(t={}){const e=wn(t??{});return t.credentialOptions&&e.addPolicy(Pn({credential:t.credentialOptions.credential,scopes:t.credentialOptions.credentialScopes})),e.addPolicy(cr(t.serializationOptions),{phase:"Serialize"}),e.addPolicy(er(t.deserializationOptions),{phase:"Deserialize"}),e}function gr(t,e){return e!=="Composite"&&e!=="Dictionary"&&(typeof t=="string"||typeof t=="number"||typeof t=="boolean"||e?.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i)!==null||t===void 0||t===null)}const pr=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function oo(t){return pr.test(t)}const yr=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function ao(t){return yr.test(t)}function wr(t){const e=Object.assign(Object.assign({},t.headers),t.body);return t.hasNullableType&&Object.getOwnPropertyNames(e).length===0?t.shouldWrapBody?{body:null}:null:t.shouldWrapBody?Object.assign(Object.assign({},t.headers),{body:t.body}):e}function Ze(t,e){var n,r;const i=t.parsedHeaders;if(t.request.method==="HEAD")return Object.assign(Object.assign({},i),{body:t.parsedBody});const o=e&&e.bodyMapper,a=!!o?.nullable,s=o?.type.name;if(s==="Stream")return Object.assign(Object.assign({},i),{blobBody:t.blobBody,readableStreamBody:t.readableStreamBody});const c=s==="Composite"&&o.type.modelProperties||{},l=Object.keys(c).some(u=>c[u].serializedName==="");if(s==="Sequence"||l){const u=(n=t.parsedBody)!==null&&n!==void 0?n:[];for(const f of Object.keys(c))c[f].serializedName&&(u[f]=(r=t.parsedBody)===null||r===void 0?void 0:r[f]);if(i)for(const f of Object.keys(i))u[f]=i[f];return a&&!t.parsedBody&&!i&&Object.getOwnPropertyNames(c).length===0?null:u}return wr({body:t.parsedBody,headers:i,hasNullableType:a,shouldWrapBody:gr(t.parsedBody,s)})}let ye;function Cr(){return ye||(ye=Cn()),ye}const Ar={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function vr(t,e,n,r){const i=br(e,n,r);let o=!1,a=Qe(t,i);if(e.path){let l=Qe(e.path,i);e.path==="/{nextLink}"&&l.startsWith("/")&&(l=l.substring(1)),Tr(l)?(a=l,o=!0):a=Er(a,l)}const{queryParams:s,sequenceParams:c}=Sr(e,n,r);return a=xr(a,s,c,o),a}function Qe(t,e){let n=t;for(const[r,i]of e)n=n.split(r).join(i);return n}function br(t,e,n){var r;const i=new Map;if(!((r=t.urlParameters)===null||r===void 0)&&r.length)for(const o of t.urlParameters){let a=M(e,o,n);const s=O(o);a=t.serializer.serialize(o.mapper,a,s),o.skipEncoding||(a=encodeURIComponent(a)),i.set(`{${o.mapper.serializedName||s}}`,a)}return i}function Tr(t){return t.includes("://")}function Er(t,e){if(!e)return t;const n=new URL(t);let r=n.pathname;r.endsWith("/")||(r=`${r}/`),e.startsWith("/")&&(e=e.substring(1));const i=e.indexOf("?");if(i!==-1){const o=e.substring(0,i),a=e.substring(i+1);r=r+o,a&&(n.search=n.search?`${n.search}&${a}`:a)}else r=r+e;return n.pathname=r,n.toString()}function Sr(t,e,n){var r;const i=new Map,o=new Set;if(!((r=t.queryParameters)===null||r===void 0)&&r.length)for(const a of t.queryParameters){a.mapper.type.name==="Sequence"&&a.mapper.serializedName&&o.add(a.mapper.serializedName);let s=M(e,a,n);if(s!=null||a.mapper.required){s=t.serializer.serialize(a.mapper,s,O(a));const c=a.collectionFormat?Ar[a.collectionFormat]:"";if(Array.isArray(s)&&(s=s.map(l=>l??"")),a.collectionFormat==="Multi"&&s.length===0)continue;Array.isArray(s)&&(a.collectionFormat==="SSV"||a.collectionFormat==="TSV")&&(s=s.join(c)),a.skipEncoding||(Array.isArray(s)?s=s.map(l=>encodeURIComponent(l)):s=encodeURIComponent(s)),Array.isArray(s)&&(a.collectionFormat==="CSV"||a.collectionFormat==="Pipes")&&(s=s.join(c)),i.set(a.mapper.serializedName||O(a),s)}}return{queryParams:i,sequenceParams:o}}function Pr(t){const e=new Map;if(!t||t[0]!=="?")return e;t=t.slice(1);const n=t.split("&");for(const r of n){const[i,o]=r.split("=",2),a=e.get(i);a?Array.isArray(a)?a.push(o):e.set(i,[a,o]):e.set(i,o)}return e}function xr(t,e,n,r=!1){if(e.size===0)return t;const i=new URL(t),o=Pr(i.search);for(const[s,c]of e){const l=o.get(s);if(Array.isArray(l))if(Array.isArray(c)){l.push(...c);const u=new Set(l);o.set(s,Array.from(u))}else l.push(c);else l?(Array.isArray(c)?c.unshift(l):n.has(s)&&o.set(s,[l,c]),r||o.set(s,c)):o.set(s,c)}const a=[];for(const[s,c]of o)if(typeof c=="string")a.push(`${s}=${c}`);else if(Array.isArray(c))for(const l of c)a.push(`${s}=${l}`);else a.push(`${s}=${c}`);return i.search=a.length?`?${a.join("&")}`:"",i.toString()}const _r=V("core-client");class Rr{constructor(e={}){var n,r;if(this._requestContentType=e.requestContentType,this._endpoint=(n=e.endpoint)!==null&&n!==void 0?n:e.baseUri,e.baseUri&&_r.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||Cr(),this.pipeline=e.pipeline||Ir(e),!((r=e.additionalPolicies)===null||r===void 0)&&r.length)for(const{policy:i,position:o}of e.additionalPolicies){const a=o==="perRetry"?"Sign":void 0;this.pipeline.addPolicy(i,{afterPhase:a})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,n){const r=n.baseUrl||this._endpoint;if(!r)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const i=vr(r,n,e,this),o=J({url:i});o.method=n.httpMethod;const a=z(o);a.operationSpec=n,a.operationArguments=e;const s=n.contentType||this._requestContentType;s&&n.requestBody&&o.headers.set("Content-Type",s);const c=e.options;if(c){const l=c.requestOptions;l&&(l.timeout&&(o.timeout=l.timeout),l.onUploadProgress&&(o.onUploadProgress=l.onUploadProgress),l.onDownloadProgress&&(o.onDownloadProgress=l.onDownloadProgress),l.shouldDeserialize!==void 0&&(a.shouldDeserialize=l.shouldDeserialize),l.allowInsecureConnection&&(o.allowInsecureConnection=!0)),c.abortSignal&&(o.abortSignal=c.abortSignal),c.tracingOptions&&(o.tracingOptions=c.tracingOptions)}this._allowInsecureConnection&&(o.allowInsecureConnection=!0),o.streamResponseStatusCodes===void 0&&(o.streamResponseStatusCodes=sr(n));try{const l=await this.sendRequest(o),u=Ze(l,n.responses[l.status]);return c?.onResponse&&c.onResponse(l,u),u}catch(l){if(typeof l=="object"&&l?.response){const u=l.response,f=Ze(u,n.responses[l.statusCode]||n.responses.default);l.details=f,c?.onResponse&&c.onResponse(u,f,l)}throw l}}}function Ir(t){const e=kr(t),n=t.credential&&e?{credentialScopes:e,credential:t.credential}:void 0;return mr(Object.assign(Object.assign({},t),{credentialOptions:n}))}function kr(t){if(t.credentialScopes)return t.credentialScopes;if(t.endpoint)return`${t.endpoint}/.default`;if(t.baseUri)return`${t.baseUri}/.default`;if(t.credential&&!t.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}function Or(t){return`, ${t.trim()}`.split(", Bearer ").filter(n=>n).map(n=>`${n.trim()}, `.split('", ').filter(o=>o).map(o=>(([a,s])=>({[a]:s}))(o.trim().split('="'))).reduce((o,a)=>Object.assign(Object.assign({},o),a),{}))}async function so(t){var e;const{scopes:n,response:r}=t,i=t.logger||coreClientLogger,o=r.headers.get("WWW-Authenticate");if(!o)return i.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;const s=(Or(o)||[]).find(l=>l.claims);if(!s)return i.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;const c=await t.getAccessToken(s.scope?[s.scope]:n,{claims:decodeStringToString(s.claims)});return c?(t.request.headers.set("Authorization",`${(e=c.tokenType)!==null&&e!==void 0?e:"Bearer"} ${c.token}`),!0):!1}const et={DefaultScope:"/.default",HeaderConstants:{AUTHORIZATION:"authorization"}};function $r(t){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/.test(t)}const lo=async t=>{var e;const n=Lr(t.request),r=Mr(t.response);if(r){const i=zr(r),o=Dr(t,i),a=Nr(i);if(!a)return!1;const s=await t.getAccessToken(o,Object.assign(Object.assign({},n),{tenantId:a}));return s?(t.request.headers.set(et.HeaderConstants.AUTHORIZATION,`${(e=s.tokenType)!==null&&e!==void 0?e:"Bearer"} ${s.token}`),!0):!1}return!1};function Nr(t){const r=new URL(t.authorization_uri).pathname.split("/")[1];if(r&&$r(r))return r}function Dr(t,e){if(!e.resource_id)return t.scopes;const n=new URL(e.resource_id);n.pathname=et.DefaultScope;let r=n.toString();return r==="https://disk.azure.com/.default"&&(r="https://disk.azure.com//.default"),[r]}function Mr(t){const e=t.headers.get("WWW-Authenticate");if(t.status===401&&e)return e}function zr(t){return`${t.slice(7).trim()} `.split(" ").filter(i=>i).map(i=>(([o,a])=>({[o]:a}))(i.trim().split("="))).reduce((i,o)=>Object.assign(Object.assign({},i),o),{})}function Lr(t){return{abortSignal:t.abortSignal,requestOptions:{timeout:t.timeout},tracingOptions:t.tracingOptions}}function Ur(t){return t==="adfs"?"oauth2/token":"oauth2/v2.0/token"}const tt="/.default",co="Specifying a `clientId` or `resourceId` is not supported by the Service Fabric managed identity environment. The managed identity configuration is determined by the Service Fabric cluster resource configuration. See https://aka.ms/servicefabricmi for more information";function uo(t){let e="";if(Array.isArray(t)){if(t.length!==1)return;e=t[0]}else typeof t=="string"&&(e=t);return e.endsWith(tt)?e.substr(0,e.lastIndexOf(tt)):e}function qr(t){if(typeof t.expires_on=="number")return t.expires_on*1e3;if(typeof t.expires_on=="string"){const e=+t.expires_on;if(!isNaN(e))return e*1e3;const n=Date.parse(t.expires_on);if(!isNaN(n))return n}if(typeof t.expires_in=="number")return Date.now()+t.expires_in*1e3;throw new Error(`Failed to parse token expiration from body. expires_in="${t.expires_in}", expires_on="${t.expires_on}"`)}function Br(t){if(t.refresh_on){if(typeof t.refresh_on=="number")return t.refresh_on*1e3;if(typeof t.refresh_on=="string"){const e=+t.refresh_on;if(!isNaN(e))return e*1e3;const n=Date.parse(t.refresh_on);if(!isNaN(n))return n}throw new Error(`Failed to parse refresh_on from body. refresh_on="${t.refresh_on}"`)}else return}var Hr=k(39907),Vr=k(1048).Buffer;const B="noCorrelationId";function Wr(t){let e=t?.authorityHost;return Ut&&(e=e??Hr.env.AZURE_AUTHORITY_HOST),e??Rt}class fo extends Rr{constructor(e){var n,r;const i=`azsdk-js-identity/${Te}`,o=!((n=e?.userAgentOptions)===null||n===void 0)&&n.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${i}`:`${i}`,a=Wr(e);if(!a.startsWith("https:"))throw new Error("The authorityHost address must use the 'https' protocol.");super(Object.assign(Object.assign({requestContentType:"application/json; charset=utf-8",retryOptions:{maxRetries:3}},e),{userAgentOptions:{userAgentPrefix:o},baseUri:a})),this.allowInsecureConnection=!1,this.authorityHost=a,this.abortControllers=new Map,this.allowLoggingAccountIdentifiers=(r=e?.loggingOptions)===null||r===void 0?void 0:r.allowLoggingAccountIdentifiers,this.tokenCredentialOptions=Object.assign({},e),e?.allowInsecureConnection&&(this.allowInsecureConnection=e.allowInsecureConnection)}async sendTokenRequest(e){P.info(`IdentityClient: sending token request to [${e.url}]`);const n=await this.sendRequest(e);if(n.bodyAsText&&(n.status===200||n.status===201)){const r=JSON.parse(n.bodyAsText);if(!r.access_token)return null;this.logIdentifiers(n);const i={accessToken:{token:r.access_token,expiresOnTimestamp:qr(r),refreshAfterTimestamp:Br(r),tokenType:"Bearer"},refreshToken:r.refresh_token};return P.info(`IdentityClient: [${e.url}] token acquired, expires on ${i.accessToken.expiresOnTimestamp}`),i}else{const r=new Pt(n.status,n.bodyAsText);throw P.warning(`IdentityClient: authentication error. HTTP status: ${n.status}, ${r.errorResponse.errorDescription}`),r}}async refreshAccessToken(e,n,r,i,o,a={}){if(i===void 0)return null;P.info(`IdentityClient: refreshing access token with client ID: ${n}, scopes: ${r} started`);const s={grant_type:"refresh_token",client_id:n,refresh_token:i,scope:r};o!==void 0&&(s.client_secret=o);const c=new URLSearchParams(s);return Se.withSpan("IdentityClient.refreshAccessToken",a,async l=>{try{const u=Ur(e),f=J({url:`${this.authorityHost}/${e}/${u}`,method:"POST",body:c.toString(),abortSignal:a.abortSignal,headers:ge({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),tracingOptions:l.tracingOptions}),d=await this.sendTokenRequest(f);return P.info(`IdentityClient: refreshed token for client ID: ${n}`),d}catch(u){if(u.name===ve&&u.errorResponse.error==="interaction_required")return P.info(`IdentityClient: interaction required for client ID: ${n}`),null;throw P.warning(`IdentityClient: failed refreshing token for client ID: ${n}: ${u}`),u}})}generateAbortSignal(e){const n=new AbortController,r=this.abortControllers.get(e)||[];r.push(n),this.abortControllers.set(e,r);const i=n.signal.onabort;return n.signal.onabort=(...o)=>{this.abortControllers.set(e,void 0),i&&i.apply(n.signal,o)},n.signal}abortRequests(e){const n=e||B,r=[...this.abortControllers.get(n)||[],...this.abortControllers.get(B)||[]];if(r.length){for(const i of r)i.abort();this.abortControllers.set(n,void 0)}}getCorrelationId(e){var n;const r=(n=e?.body)===null||n===void 0?void 0:n.split("&").map(i=>i.split("=")).find(([i])=>i==="client-request-id");return r&&r.length&&r[1]||B}async sendGetRequestAsync(e,n){const r=J({url:e,method:"GET",body:n?.body,allowInsecureConnection:this.allowInsecureConnection,headers:ge(n?.headers),abortSignal:this.generateAbortSignal(B)}),i=await this.sendRequest(r);return this.logIdentifiers(i),{body:i.bodyAsText?JSON.parse(i.bodyAsText):void 0,headers:i.headers.toJSON(),status:i.status}}async sendPostRequestAsync(e,n){const r=J({url:e,method:"POST",body:n?.body,headers:ge(n?.headers),allowInsecureConnection:this.allowInsecureConnection,abortSignal:this.generateAbortSignal(this.getCorrelationId(n))}),i=await this.sendRequest(r);return this.logIdentifiers(i),{body:i.bodyAsText?JSON.parse(i.bodyAsText):void 0,headers:i.headers.toJSON(),status:i.status}}getTokenCredentialOptions(){return this.tokenCredentialOptions}logIdentifiers(e){if(!this.allowLoggingAccountIdentifiers||!e.bodyAsText)return;const n="No User Principal Name available";try{const i=(e.parsedBody||JSON.parse(e.bodyAsText)).access_token;if(!i)return;const o=i.split(".")[1],{appid:a,upn:s,tid:c,oid:l}=JSON.parse(Vr.from(o,"base64").toString("utf8"));P.info(`[Authenticated account] Client ID: ${a}. Tenant ID: ${c}. User Principal Name: ${s||n}. Object ID (user): ${l}`)}catch(r){P.warning("allowLoggingAccountIdentifiers was set, but we couldn't log the account information. Error:",r.message)}}}const nt=E("ClientSecretCredential");class ho{constructor(e,n,r,i){this.identityClient=new IdentityClient(i),this.tenantId=e,this.additionallyAllowedTenantIds=resolveAdditionallyAllowedTenantIds(i?.additionallyAllowedTenants),this.clientId=n,this.clientSecret=r}async getToken(e,n={}){return tracingClient.withSpan(`${this.constructor.name}.getToken`,n,async r=>{const i=processMultiTenantRequest(this.tenantId,r,this.additionallyAllowedTenantIds),o=new URLSearchParams({response_type:"token",grant_type:"client_credentials",client_id:this.clientId,client_secret:this.clientSecret,scope:typeof e=="string"?e:e.join(" ")});try{const a=getIdentityTokenEndpointSuffix(i),s=createPipelineRequest({url:`${this.identityClient.authorityHost}/${i}/${a}`,method:"POST",body:o.toString(),headers:createHttpHeaders({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),abortSignal:n&&n.abortSignal,tracingOptions:r?.tracingOptions}),c=await this.identityClient.sendTokenRequest(s);return nt.getToken.info(formatSuccess(e)),c&&c.accessToken||null}catch(a){throw nt.getToken.info(formatError(e,a)),a}})}}const Q=new Error("EnvironmentCredential is not supported in the browser."),rt=E("EnvironmentCredential");class mo{constructor(){throw rt.info(formatError("",Q)),Q}getToken(){throw rt.getToken.info(formatError("",Q)),Q}}const ee=new Error("ClientCertificateCredential is not supported in the browser."),it=E("ClientCertificateCredential");class go{constructor(){throw it.info(formatError("",ee)),ee}getToken(){throw it.getToken.info(formatError("",ee)),ee}}const te=new Error("ClientAssertionCredential is not supported in the browser."),ot=E("ClientAssertionCredential");class po{constructor(){throw ot.info(formatError("",te)),te}getToken(){throw ot.getToken.info(formatError("",te)),te}}const ne=new Error("AzureCliCredential is not supported in the browser."),at=E("AzureCliCredential");class yo{constructor(){throw at.info(formatError("",ne)),ne}getToken(){throw at.getToken.info(formatError("",ne)),ne}}const re=new Error("AzureDeveloperCliCredential is not supported in the browser."),st=E("AzureDeveloperCliCredential");class wo{constructor(){throw st.info(formatError("",re)),re}getToken(){throw st.getToken.info(formatError("",re)),re}}function Co(t){return Array.isArray(t)?t:[t]}function Ao(t,e){if(!t.match(/^[0-9a-zA-Z-_.:/]+$/)){const n=new Error("Invalid scope was specified by the user or calling client");throw e.getToken.info(formatError(t,n)),n}}function vo(t){return t.replace(/\/.default$/,"")}const lt=typeof self<"u"&&self.location!==void 0;function Fr(t){var e;const n=t.tenantId||DefaultTenantId,r=getAuthority(n,t.authorityHost);return{auth:{clientId:t.clientId,authority:r,knownAuthorities:getKnownAuthorities(n,r,t.disableInstanceDiscovery),redirectUri:t.redirectUri||(lt?self.location.origin:void 0)},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0},system:{loggerOptions:{loggerCallback:defaultLoggerCallback(t.logger,"Browser"),logLevel:getMSALLogLevel(getLogLevel()),piiLoggingEnabled:(e=t.loggingOptions)===null||e===void 0?void 0:e.enableUnsafeSupportLogging}}}}const Kr=lt?self.location.hash:void 0;function bo(t){var e;const n=t.loginStyle;if(!t.clientId)throw new CredentialUnavailableError("A client ID is required in browsers");const r=t.clientId,i=t.logger,o=resolveTenantId(i,t.tenantId,t.clientId),a=resolveAdditionallyAllowedTenantIds((e=t?.tokenCredentialOptions)===null||e===void 0?void 0:e.additionallyAllowedTenants),s=t.authorityHost,c=Fr(t),l=t.disableAutomaticAuthentication,u=t.loginHint;let f;t.authenticationRecord&&(f=Object.assign(Object.assign({},t.authenticationRecord),{tenantId:o}));let d;async function h(){return d||(d=await msalBrowser.PublicClientApplication.createPublicClientApplication(c),f&&d.setActiveAccount(publicToMsal(f))),d}async function g(y){try{const m=await h();if(y&&y.account)return i.info("MSAL Browser V2 authentication successful."),m.setActiveAccount(y.account),msalToPublic(r,y.account);const T=m.getActiveAccount();if(T)return msalToPublic(r,T);const b=d.getAllAccounts();if(b.length>1){i.info(`More than one account was found authenticated for this Client ID and Tenant ID.
  However, no "authenticationRecord" has been provided for this credential,
  therefore we're unable to pick between these accounts.
  A new login attempt will be requested, to ensure the correct account is picked.
  To work with multiple accounts for the same Client ID and Tenant ID, please provide an "authenticationRecord" when initializing "InteractiveBrowserCredential".`),await m.logout({onRedirectNavigate:()=>!1});return}if(b.length===1){const I=b[0];return m.setActiveAccount(I),msalToPublic(r,I)}i.info("No accounts were found through MSAL.")}catch(m){i.info(`Failed to acquire token through MSAL. ${m.message}`)}}function p(y,m,T){var b;return m?.account&&(f=msalToPublic(r,m.account)),ensureValidMsalToken(y,m,T),i.getToken.info(formatSuccess(y)),{token:m.accessToken,expiresOnTimestamp:m.expiresOn.getTime(),refreshAfterTimestamp:(b=m.refreshOn)===null||b===void 0?void 0:b.getTime(),tokenType:"Bearer"}}async function w(){const y=await h();return g(await y.handleRedirectPromise(Kr)||void 0)}async function A(){const m=(await h()).getActiveAccount();if(m)return msalToPublic(r,m)}async function S(y=[]){const T={scopes:Array.isArray(y)?y:[y],loginHint:u},b=await h();switch(n){case"redirect":{await d.loginRedirect(T);return}case"popup":return g(await b.loginPopup(T))}}async function _(y,m){const T=await A();if(!T)throw new AuthenticationRequiredError({scopes:y,getTokenOptions:m,message:"Silent authentication failed. We couldn't retrieve an active account from the cache."});const b={authority:m?.authority||c.auth.authority,correlationId:m?.correlationId,claims:m?.claims,account:publicToMsal(T),forceRefresh:!1,scopes:y};try{i.info("Attempting to acquire token silently");const Ce=await(await h()).acquireTokenSilent(b);return p(y,Ce)}catch(I){throw handleMsalError(y,I,t)}}async function C(y,m){const T=await A();if(!T)throw new AuthenticationRequiredError({scopes:y,getTokenOptions:m,message:"Silent authentication failed. We couldn't retrieve an active account from the cache."});const b={authority:m?.authority||c.auth.authority,correlationId:m?.correlationId,claims:m?.claims,account:publicToMsal(T),loginHint:u,scopes:y},I=await h();switch(n){case"redirect":return await I.acquireTokenRedirect(b),{token:"",expiresOnTimestamp:0,tokenType:"Bearer"};case"popup":return p(y,await d.acquireTokenPopup(b))}}async function v(y,m={}){const T=processMultiTenantRequest(o,m,a)||o;m.authority||(m.authority=getAuthority(T,s)),await w(),!await A()&&!l&&await S(y);try{return await _(y,m)}catch(b){if(b.name!=="AuthenticationRequiredError")throw b;if(m?.disableAutomaticAuthentication)throw new AuthenticationRequiredError({scopes:y,getTokenOptions:m,message:"Automatic authentication has been disabled. You may call the authenticate() method."});return i.info(`Silent authentication failed, falling back to interactive method ${n}`),C(y,m)}}return{getActiveAccount:A,getToken:v}}const we=E("InteractiveBrowserCredential");class To{constructor(e){if(!e?.clientId){const a=new Error("The parameter `clientId` cannot be left undefined for the `InteractiveBrowserCredential`");throw we.info(formatError("",a)),a}this.tenantId=e?.tenantId,this.additionallyAllowedTenantIds=resolveAdditionallyAllowedTenantIds(e?.additionallyAllowedTenants);const n=e,r=n.loginStyle||"popup",i=["redirect","popup"];if(i.indexOf(r)===-1){const a=new Error(`Invalid loginStyle: ${n.loginStyle}. Should be any of the following: ${i.join(", ")}.`);throw we.info(formatError("",a)),a}const o=Object.assign(Object.assign({},e),{tokenCredentialOptions:e,logger:we,loginStyle:r,redirectUri:typeof e.redirectUri=="function"?e.redirectUri():e.redirectUri});this.msalClient=createMsalBrowserClient(o),this.disableAutomaticAuthentication=e?.disableAutomaticAuthentication}async getToken(e,n={}){return tracingClient.withSpan(`${this.constructor.name}.getToken`,n,async r=>{const i=processMultiTenantRequest(this.tenantId,r,this.additionallyAllowedTenantIds);r.tenantId=i;const o=ensureScopes(e);return this.msalClient.getToken(o,Object.assign(Object.assign({},r),{disableAutomaticAuthentication:this.disableAutomaticAuthentication}))})}async authenticate(e,n={}){return tracingClient.withSpan(`${this.constructor.name}.authenticate`,n,async r=>{const i=Array.isArray(e)?e:[e];return await this.msalClient.getToken(i,r),this.msalClient.getActiveAccount()})}}const ie=new Error("ManagedIdentityCredential is not supported in the browser."),ct=E("ManagedIdentityCredential");class Eo{constructor(){throw ct.info(formatError("",ie)),ie}async getToken(){throw ct.getToken.info(formatError("",ie)),ie}}const oe=new Error("DeviceCodeCredential is not supported in the browser."),ut=E("DeviceCodeCredential");class So{constructor(){throw ut.info(formatError("",oe)),oe}getToken(){throw ut.getToken.info(formatError("",oe)),oe}}const ae=new Error("AzurePipelinesCredential is not supported in the browser."),dt=E("AzurePipelinesCredential");class Po{constructor(){throw dt.info(formatError("",ae)),ae}getToken(){throw dt.getToken.info(formatError("",ae)),ae}}const se=new Error("AuthorizationCodeCredential is not supported in the browser. InteractiveBrowserCredential is more appropriate for this use case."),ft=E("AuthorizationCodeCredential");class xo{constructor(){throw ft.info(formatError("",se)),se}getToken(){throw ft.getToken.info(formatError("",se)),se}}const le=new Error("AzurePowerShellCredential is not supported in the browser."),ht=E("AzurePowerShellCredential");class _o{constructor(){throw ht.info(formatError("",le)),le}getToken(){throw ht.getToken.info(formatError("",le)),le}}const mt=E("UsernamePasswordCredential");class Ro{constructor(e,n,r,i,o){checkTenantId(mt,e),this.identityClient=new IdentityClient(o),this.tenantId=e,this.additionallyAllowedTenantIds=resolveAdditionallyAllowedTenantIds(o?.additionallyAllowedTenants),this.clientId=n,this.username=r,this.password=i}async getToken(e,n={}){return tracingClient.withSpan("UsernamePasswordCredential.getToken",n,async r=>{const i=processMultiTenantRequest(this.tenantId,r,this.additionallyAllowedTenantIds);r.tenantId=i;const o=getIdentityTokenEndpointSuffix(this.tenantId),a=new URLSearchParams({response_type:"token",grant_type:"password",client_id:this.clientId,username:this.username,password:this.password,scope:typeof e=="string"?e:e.join(" ")}),s=createPipelineRequest({url:`${this.identityClient.authorityHost}/${this.tenantId}/${o}`,method:"POST",body:a.toString(),headers:createHttpHeaders({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),abortSignal:n&&n.abortSignal,tracingOptions:r.tracingOptions}),c=await this.identityClient.sendTokenRequest(s);return mt.getToken.info(formatSuccess(e)),c&&c.accessToken||null})}}const ce=new Error("VisualStudioCodeCredential is not supported in the browser."),gt=E("VisualStudioCodeCredential"),Io={set vsCodeCredentialFinder(t){throw new Error("Attempted to register a VisualStudioCodeCredential provider plugin in the browser. This environment is not supported by VisualStudioCodeCredential.")}};class ko{constructor(){throw gt.info(formatError("",ce)),ce}getToken(){throw gt.getToken.info(formatError("",ce)),ce}}const pt="OnBehalfOfCredential",ue=new Error(`${pt}: Not supported in the browser.`),yt=E(pt);class Oo{constructor(){throw yt.info(formatError("",ue)),ue}getToken(){throw yt.getToken.info(formatError("",ue)),ue}}const de=new Error("WorkloadIdentityCredential is not supported in the browser."),wt=E("WorkloadIdentityCredential");class $o{constructor(){throw wt.info(formatError("",de)),de}getToken(){throw wt.getToken.info(formatError("",de)),de}}function No(t,e,n){const{abortSignal:r,tracingOptions:i}=n||{},o=createEmptyPipeline();o.addPolicy(bearerTokenAuthenticationPolicy({credential:t,scopes:e}));async function a(){var s;const l=(s=(await o.sendRequest({sendRequest:u=>Promise.resolve({request:u,status:200,headers:u.headers})},createPipelineRequest({url:"https://example.com",abortSignal:r,tracingOptions:i}))).headers.get("authorization"))===null||s===void 0?void 0:s.split(" ")[1];if(!l)throw new Error("Failed to get access token");return l}return a}function Do(){return new DefaultAzureCredential}}}]);})();

//# sourceMappingURL=module-azure.d44ddf30.js.map